# Comparing `tmp/bdq-0.0.1.tar.gz` & `tmp/bdq-0.0.2.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "bdq-0.0.1.tar", last modified: Fri Jun 30 11:17:42 2023, max compression
+gzip compressed data, was "bdq-0.0.2.tar", last modified: Fri Jun 30 12:38:57 2023, max compression
```

## Comparing `bdq-0.0.1.tar` & `bdq-0.0.2.tar`

### file list

```diff
@@ -1,12 +1,12 @@
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-30 11:17:42.047721 bdq-0.0.1/
--rw-r--r--   0 runner    (1001) docker     (123)    11357 2023-06-30 11:17:32.000000 bdq-0.0.1/LICENSE
--rw-r--r--   0 runner    (1001) docker     (123)    20782 2023-06-30 11:17:42.047721 bdq-0.0.1/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (123)    20175 2023-06-30 11:17:32.000000 bdq-0.0.1/README.md
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-30 11:17:42.047721 bdq-0.0.1/bdq/
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-30 11:17:42.047721 bdq-0.0.1/bdq/bdq.egg-info/
--rw-r--r--   0 runner    (1001) docker     (123)    20782 2023-06-30 11:17:42.000000 bdq-0.0.1/bdq/bdq.egg-info/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (123)      156 2023-06-30 11:17:42.000000 bdq-0.0.1/bdq/bdq.egg-info/SOURCES.txt
--rw-r--r--   0 runner    (1001) docker     (123)        1 2023-06-30 11:17:42.000000 bdq-0.0.1/bdq/bdq.egg-info/dependency_links.txt
--rw-r--r--   0 runner    (1001) docker     (123)        1 2023-06-30 11:17:42.000000 bdq-0.0.1/bdq/bdq.egg-info/top_level.txt
--rw-r--r--   0 runner    (1001) docker     (123)      724 2023-06-30 11:17:32.000000 bdq-0.0.1/pyproject.toml
--rw-r--r--   0 runner    (1001) docker     (123)       38 2023-06-30 11:17:42.047721 bdq-0.0.1/setup.cfg
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-30 12:38:57.897768 bdq-0.0.2/
+-rw-r--r--   0 runner    (1001) docker     (123)    11357 2023-06-30 12:38:46.000000 bdq-0.0.2/LICENSE
+-rw-r--r--   0 runner    (1001) docker     (123)    21028 2023-06-30 12:38:57.897768 bdq-0.0.2/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)    20421 2023-06-30 12:38:46.000000 bdq-0.0.2/README.md
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-30 12:38:57.893768 bdq-0.0.2/bdq/
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-30 12:38:57.893768 bdq-0.0.2/bdq/bdq.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (123)    21028 2023-06-30 12:38:57.000000 bdq-0.0.2/bdq/bdq.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)      156 2023-06-30 12:38:57.000000 bdq-0.0.2/bdq/bdq.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        1 2023-06-30 12:38:57.000000 bdq-0.0.2/bdq/bdq.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        1 2023-06-30 12:38:57.000000 bdq-0.0.2/bdq/bdq.egg-info/top_level.txt
+-rw-r--r--   0 runner    (1001) docker     (123)      724 2023-06-30 12:38:46.000000 bdq-0.0.2/pyproject.toml
+-rw-r--r--   0 runner    (1001) docker     (123)       38 2023-06-30 12:38:57.897768 bdq-0.0.2/setup.cfg
```

### Comparing `bdq-0.0.1/LICENSE` & `bdq-0.0.2/LICENSE`

 * *Files identical despite different names*

### Comparing `bdq-0.0.1/PKG-INFO` & `bdq-0.0.2/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 00000000: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
 00000010: 3a20 322e 310a 4e61 6d65 3a20 6264 710a  : 2.1.Name: bdq.
-00000020: 5665 7273 696f 6e3a 2030 2e30 2e31 0a53  Version: 0.0.1.S
+00000020: 5665 7273 696f 6e3a 2030 2e30 2e32 0a53  Version: 0.0.2.S
 00000030: 756d 6d61 7279 3a20 4269 6720 4461 7461  ummary: Big Data
 00000040: 2051 7561 6c69 7479 2c20 6120 7365 7420   Quality, a set 
 00000050: 6f66 2074 6f6f 6c73 2f66 756e 6374 696f  of tools/functio
 00000060: 6e20 7468 6174 2068 656c 7020 796f 7520  n that help you 
 00000070: 6576 6572 7920 6461 7920 6173 7365 7274  every day assert
 00000080: 2071 7561 6c69 7479 206f 6620 6461 7461   quality of data
 00000090: 7365 7473 2079 6f75 2068 6176 6520 7072  sets you have pr
@@ -837,463 +837,479 @@
 00003440: 7261 7068 2e6e 6f64 6528 6465 7065 6e64  raph.node(depend
 00003450: 735f 6f6e 3d5b 675d 290a 6465 6620 6928  s_on=[g]).def i(
 00003460: 293a 0a20 2070 7269 6e74 2822 7468 6973  ):.  print("this
 00003470: 2077 696c 6c20 6e65 7665 7220 6578 6563   will never exec
 00003480: 7574 6520 746f 6f22 290a 2020 7265 7475  ute too").  retu
 00003490: 726e 2022 7468 6973 2077 696c 6c20 6e65  rn "this will ne
 000034a0: 7665 7220 6578 6563 7574 6520 746f 6f22  ver execute too"
-000034b0: 0a0a 2365 7865 6375 7465 2044 4147 0a67  ..#execute DAG.g
-000034c0: 7261 7068 2e65 7865 6375 7465 286d 6178  raph.execute(max
-000034d0: 5f77 6f72 6b65 7273 3d31 3029 0a0a 2369  _workers=10)..#i
-000034e0: 7465 7261 7465 206f 7665 7220 7265 7375  terate over resu
-000034f0: 6c74 730a 7072 696e 7428 2249 7465 7261  lts.print("Itera
-00003500: 7465 206f 7665 7220 7265 7375 6c74 732e  te over results.
-00003510: 2e2e 2229 0a66 6f72 206e 6f64 6520 696e  ..").for node in
-00003520: 2067 7261 7068 2e6e 6f64 6573 3a0a 2020   graph.nodes:.  
-00003530: 7072 696e 7428 6e6f 6465 290a 0a3e 3e20  print(node)..>> 
-00003540: 5761 6974 696e 6720 666f 7220 616c 6c20  Waiting for all 
-00003550: 7461 736b 7320 746f 2066 696e 6973 682e  tasks to finish.
-00003560: 2e2e 0a3e 3e20 2020 7374 6172 7469 6e67  ...>>   starting
-00003570: 3a20 4e6f 6465 283c 6675 6e63 7469 6f6e  : Node(<function
-00003580: 2061 2061 7420 3078 3766 3530 6634 6239   a at 0x7f50f4b9
-00003590: 6565 3530 3e3a 207b 2773 7461 7465 273a  ee50>: {'state':
-000035a0: 2027 5255 4e4e 494e 4727 2c20 2772 6573   'RUNNING', 'res
-000035b0: 756c 7427 3a20 4e6f 6e65 2c20 2765 7863  ult': None, 'exc
-000035c0: 6570 7469 6f6e 273a 204e 6f6e 652c 2027  eption': None, '
-000035d0: 636f 6d70 6c65 7465 6427 3a20 4661 6c73  completed': Fals
-000035e0: 657d 2029 0a3e 3e20 2020 7374 6172 7469  e} ).>>   starti
-000035f0: 6e67 3a20 4e6f 6465 283c 6675 6e63 7469  ng: Node(<functi
-00003600: 6f6e 2062 2061 7420 3078 3766 3530 6634  on b at 0x7f50f4
-00003610: 6235 3330 3430 3e3a 207b 2773 7461 7465  b53040>: {'state
-00003620: 273a 2027 5255 4e4e 494e 4727 2c20 2772  ': 'RUNNING', 'r
-00003630: 6573 756c 7427 3a20 4e6f 6e65 2c20 2765  esult': None, 'e
-00003640: 7863 6570 7469 6f6e 273a 204e 6f6e 652c  xception': None,
-00003650: 2027 636f 6d70 6c65 7465 6427 3a20 4661   'completed': Fa
-00003660: 6c73 657d 2029 0a3e 3e20 2020 7374 6172  lse} ).>>   star
-00003670: 7469 6e67 3a20 4e6f 6465 283c 6675 6e63  ting: Node(<func
-00003680: 7469 6f6e 2065 2061 7420 3078 3766 3530  tion e at 0x7f50
-00003690: 6634 6235 3362 3830 3e3a 207b 2773 7461  f4b53b80>: {'sta
-000036a0: 7465 273a 2027 5255 4e4e 494e 4727 2c20  te': 'RUNNING', 
-000036b0: 2772 6573 756c 7427 3a20 4e6f 6e65 2c20  'result': None, 
-000036c0: 2765 7863 6570 7469 6f6e 273a 204e 6f6e  'exception': Non
-000036d0: 652c 2027 636f 6d70 6c65 7465 6427 3a20  e, 'completed': 
-000036e0: 4661 6c73 657d 2029 0a3e 3e20 2020 7374  False} ).>>   st
-000036f0: 6172 7469 6e67 3a20 4e6f 6465 283c 6675  arting: Node(<fu
-00003700: 6e63 7469 6f6e 2067 2061 7420 3078 3766  nction g at 0x7f
-00003710: 3530 6634 6235 3335 6530 3e3a 207b 2773  50f4b535e0>: {'s
-00003720: 7461 7465 273a 2027 5255 4e4e 494e 4727  tate': 'RUNNING'
-00003730: 2c20 2772 6573 756c 7427 3a20 4e6f 6e65  , 'result': None
-00003740: 2c20 2765 7863 6570 7469 6f6e 273a 204e  , 'exception': N
-00003750: 6f6e 652c 2027 636f 6d70 6c65 7465 6427  one, 'completed'
-00003760: 3a20 4661 6c73 657d 2029 0a3e 3e20 2020  : False} ).>>   
-00003770: 6669 6e69 7368 6564 3a20 4e6f 6465 283c  finished: Node(<
-00003780: 6675 6e63 7469 6f6e 2061 2061 7420 3078  function a at 0x
-00003790: 3766 3530 6634 6239 6565 3530 3e3a 207b  7f50f4b9ee50>: {
-000037a0: 2773 7461 7465 273a 2027 5355 4343 4553  'state': 'SUCCES
-000037b0: 5327 2c20 2772 6573 756c 7427 3a20 352c  S', 'result': 5,
-000037c0: 2027 6578 6365 7074 696f 6e27 3a20 4e6f   'exception': No
-000037d0: 6e65 2c20 2763 6f6d 706c 6574 6564 273a  ne, 'completed':
-000037e0: 2054 7275 657d 2029 2028 7374 696c 6c20   True} ) (still 
-000037f0: 7275 6e6e 696e 673a 2033 290a 3e3e 2020  running: 3).>>  
-00003800: 2073 7461 7274 696e 673a 204e 6f64 6528   starting: Node(
-00003810: 3c66 756e 6374 696f 6e20 6320 6174 2030  <function c at 0
-00003820: 7837 6635 3066 3462 3533 3463 303e 3a20  x7f50f4b534c0>: 
-00003830: 7b27 7374 6174 6527 3a20 2752 554e 4e49  {'state': 'RUNNI
-00003840: 4e47 272c 2027 7265 7375 6c74 273a 204e  NG', 'result': N
-00003850: 6f6e 652c 2027 6578 6365 7074 696f 6e27  one, 'exception'
-00003860: 3a20 4e6f 6e65 2c20 2763 6f6d 706c 6574  : None, 'complet
-00003870: 6564 273a 2046 616c 7365 7d20 290a 3e3e  ed': False} ).>>
-00003880: 2020 2066 696e 6973 6865 643a 204e 6f64     finished: Nod
-00003890: 6528 3c66 756e 6374 696f 6e20 6220 6174  e(<function b at
-000038a0: 2030 7837 6635 3066 3462 3533 3034 303e   0x7f50f4b53040>
-000038b0: 3a20 7b27 7374 6174 6527 3a20 2753 5543  : {'state': 'SUC
-000038c0: 4345 5353 272c 2027 7265 7375 6c74 273a  CESS', 'result':
-000038d0: 2027 6265 6565 7027 2c20 2765 7863 6570   'beeep', 'excep
-000038e0: 7469 6f6e 273a 204e 6f6e 652c 2027 636f  tion': None, 'co
-000038f0: 6d70 6c65 7465 6427 3a20 5472 7565 7d20  mpleted': True} 
-00003900: 2920 2873 7469 6c6c 2072 756e 6e69 6e67  ) (still running
-00003910: 3a20 3329 0a3e 3e20 2020 6572 726f 723a  : 3).>>   error:
-00003920: 204e 6f64 6528 3c66 756e 6374 696f 6e20   Node(<function 
-00003930: 6520 6174 2030 7837 6635 3066 3462 3533  e at 0x7f50f4b53
-00003940: 6238 303e 3a20 7b27 7374 6174 6527 3a20  b80>: {'state': 
-00003950: 2745 5252 4f52 272c 2027 7265 7375 6c74  'ERROR', 'result
-00003960: 273a 204e 6f6e 652c 2027 6578 6365 7074  ': None, 'except
-00003970: 696f 6e27 3a20 5661 6c75 6545 7272 6f72  ion': ValueError
-00003980: 2827 6f6d 672c 2063 7261 7368 2120 3527  ('omg, crash! 5'
-00003990: 292c 2027 636f 6d70 6c65 7465 6427 3a20  ), 'completed': 
-000039a0: 5472 7565 7d20 293a 206f 6d67 2c20 6372  True} ): omg, cr
-000039b0: 6173 6821 2035 2028 7374 696c 6c20 7275  ash! 5 (still ru
-000039c0: 6e6e 696e 673a 2032 290a 3e3e 2020 2066  nning: 2).>>   f
-000039d0: 696e 6973 6865 643a 204e 6f64 6528 3c66  inished: Node(<f
-000039e0: 756e 6374 696f 6e20 6720 6174 2030 7837  unction g at 0x7
-000039f0: 6635 3066 3462 3533 3565 303e 3a20 7b27  f50f4b535e0>: {'
-00003a00: 7374 6174 6527 3a20 2753 4b49 5050 4544  state': 'SKIPPED
-00003a10: 272c 2027 7265 7375 6c74 273a 203c 7468  ', 'result': <th
-00003a20: 7265 6164 696e 672e 4576 656e 7420 6f62  reading.Event ob
-00003a30: 6a65 6374 2061 7420 3078 3766 3530 6563  ject at 0x7f50ec
-00003a40: 3136 6339 6430 3e2c 2027 6578 6365 7074  16c9d0>, 'except
-00003a50: 696f 6e27 3a20 4e6f 6e65 2c20 2763 6f6d  ion': None, 'com
-00003a60: 706c 6574 6564 273a 2054 7275 657d 2029  pleted': True} )
-00003a70: 2028 7374 696c 6c20 7275 6e6e 696e 673a   (still running:
-00003a80: 2031 290a 3e3e 2020 2073 7461 7274 696e   1).>>   startin
-00003a90: 673a 204e 6f64 6528 3c66 756e 6374 696f  g: Node(<functio
-00003aa0: 6e20 6420 6174 2030 7837 6635 3066 3462  n d at 0x7f50f4b
-00003ab0: 3533 6136 303e 3a20 7b27 7374 6174 6527  53a60>: {'state'
-00003ac0: 3a20 2752 554e 4e49 4e47 272c 2027 7265  : 'RUNNING', 're
-00003ad0: 7375 6c74 273a 204e 6f6e 652c 2027 6578  sult': None, 'ex
-00003ae0: 6365 7074 696f 6e27 3a20 4e6f 6e65 2c20  ception': None, 
-00003af0: 2763 6f6d 706c 6574 6564 273a 2046 616c  'completed': Fal
-00003b00: 7365 7d20 290a 3e3e 2020 2066 696e 6973  se} ).>>   finis
-00003b10: 6865 643a 204e 6f64 6528 3c66 756e 6374  hed: Node(<funct
-00003b20: 696f 6e20 6320 6174 2030 7837 6635 3066  ion c at 0x7f50f
-00003b30: 3462 3533 3463 303e 3a20 7b27 7374 6174  4b534c0>: {'stat
-00003b40: 6527 3a20 2753 5543 4345 5353 272c 2027  e': 'SUCCESS', '
-00003b50: 7265 7375 6c74 273a 2038 2c20 2765 7863  result': 8, 'exc
-00003b60: 6570 7469 6f6e 273a 204e 6f6e 652c 2027  eption': None, '
-00003b70: 636f 6d70 6c65 7465 6427 3a20 5472 7565  completed': True
-00003b80: 7d20 2920 2873 7469 6c6c 2072 756e 6e69  } ) (still runni
-00003b90: 6e67 3a20 3129 0a3e 3e20 2020 6669 6e69  ng: 1).>>   fini
-00003ba0: 7368 6564 3a20 4e6f 6465 283c 6675 6e63  shed: Node(<func
-00003bb0: 7469 6f6e 2064 2061 7420 3078 3766 3530  tion d at 0x7f50
-00003bc0: 6634 6235 3361 3630 3e3a 207b 2773 7461  f4b53a60>: {'sta
-00003bd0: 7465 273a 2027 5355 4343 4553 5327 2c20  te': 'SUCCESS', 
-00003be0: 2772 6573 756c 7427 3a20 2767 206d 616e  'result': 'g man
-00003bf0: 2073 6179 3a20 6265 6565 7062 6565 6570   say: beeepbeeep
-00003c00: 6265 6565 7027 2c20 2765 7863 6570 7469  beeep', 'excepti
-00003c10: 6f6e 273a 204e 6f6e 652c 2027 636f 6d70  on': None, 'comp
-00003c20: 6c65 7465 6427 3a20 5472 7565 7d20 2920  leted': True} ) 
-00003c30: 2873 7469 6c6c 2072 756e 6e69 6e67 3a20  (still running: 
-00003c40: 3029 0a3e 3e20 416c 6c20 7461 736b 7320  0).>> All tasks 
-00003c50: 6669 6e69 7368 6564 2c20 7368 7574 7469  finished, shutti
-00003c60: 6e67 2064 6f77 6e0a 3e3e 0a3e 3e20 4974  ng down.>>.>> It
-00003c70: 6572 6174 6520 6f76 6572 2072 6573 756c  erate over resul
-00003c80: 7473 2e2e 2e0a 3e3e 204e 6f64 6528 3c66  ts....>> Node(<f
-00003c90: 756e 6374 696f 6e20 6120 6174 2030 7837  unction a at 0x7
-00003ca0: 6635 3066 3462 3965 6535 303e 3a20 7b27  f50f4b9ee50>: {'
-00003cb0: 7374 6174 6527 3a20 2753 5543 4345 5353  state': 'SUCCESS
-00003cc0: 272c 2027 7265 7375 6c74 273a 2035 2c20  ', 'result': 5, 
-00003cd0: 2765 7863 6570 7469 6f6e 273a 204e 6f6e  'exception': Non
-00003ce0: 652c 2027 636f 6d70 6c65 7465 6427 3a20  e, 'completed': 
-00003cf0: 5472 7565 7d20 290a 3e3e 204e 6f64 6528  True} ).>> Node(
-00003d00: 3c66 756e 6374 696f 6e20 6220 6174 2030  <function b at 0
-00003d10: 7837 6635 3066 3462 3533 3034 303e 3a20  x7f50f4b53040>: 
-00003d20: 7b27 7374 6174 6527 3a20 2753 5543 4345  {'state': 'SUCCE
-00003d30: 5353 272c 2027 7265 7375 6c74 273a 2027  SS', 'result': '
-00003d40: 6265 6565 7027 2c20 2765 7863 6570 7469  beeep', 'excepti
-00003d50: 6f6e 273a 204e 6f6e 652c 2027 636f 6d70  on': None, 'comp
-00003d60: 6c65 7465 6427 3a20 5472 7565 7d20 290a  leted': True} ).
-00003d70: 3e3e 204e 6f64 6528 3c66 756e 6374 696f  >> Node(<functio
-00003d80: 6e20 6320 6174 2030 7837 6635 3066 3462  n c at 0x7f50f4b
-00003d90: 3533 3463 303e 3a20 7b27 7374 6174 6527  534c0>: {'state'
-00003da0: 3a20 2753 5543 4345 5353 272c 2027 7265  : 'SUCCESS', 're
-00003db0: 7375 6c74 273a 2038 2c20 2765 7863 6570  sult': 8, 'excep
-00003dc0: 7469 6f6e 273a 204e 6f6e 652c 2027 636f  tion': None, 'co
-00003dd0: 6d70 6c65 7465 6427 3a20 5472 7565 7d20  mpleted': True} 
-00003de0: 290a 3e3e 204e 6f64 6528 3c66 756e 6374  ).>> Node(<funct
-00003df0: 696f 6e20 6420 6174 2030 7837 6635 3066  ion d at 0x7f50f
-00003e00: 3462 3533 6136 303e 3a20 7b27 7374 6174  4b53a60>: {'stat
-00003e10: 6527 3a20 2753 5543 4345 5353 272c 2027  e': 'SUCCESS', '
-00003e20: 7265 7375 6c74 273a 2027 6720 6d61 6e20  result': 'g man 
-00003e30: 7361 793a 2062 6565 6570 6265 6565 7062  say: beeepbeeepb
-00003e40: 6565 6570 272c 2027 6578 6365 7074 696f  eeep', 'exceptio
-00003e50: 6e27 3a20 4e6f 6e65 2c20 2763 6f6d 706c  n': None, 'compl
-00003e60: 6574 6564 273a 2054 7275 657d 2029 0a3e  eted': True} ).>
-00003e70: 3e20 4e6f 6465 283c 6675 6e63 7469 6f6e  > Node(<function
-00003e80: 2065 2061 7420 3078 3766 3530 6634 6235   e at 0x7f50f4b5
-00003e90: 3362 3830 3e3a 207b 2773 7461 7465 273a  3b80>: {'state':
-00003ea0: 2027 4552 524f 5227 2c20 2772 6573 756c   'ERROR', 'resul
-00003eb0: 7427 3a20 4e6f 6e65 2c20 2765 7863 6570  t': None, 'excep
-00003ec0: 7469 6f6e 273a 2056 616c 7565 4572 726f  tion': ValueErro
-00003ed0: 7228 276f 6d67 2c20 6372 6173 6821 2035  r('omg, crash! 5
-00003ee0: 2729 2c20 2763 6f6d 706c 6574 6564 273a  '), 'completed':
-00003ef0: 2054 7275 657d 2029 0a3e 3e20 4e6f 6465   True} ).>> Node
-00003f00: 283c 6675 6e63 7469 6f6e 2066 2061 7420  (<function f at 
-00003f10: 3078 3766 3530 6634 6235 3330 6430 3e3a  0x7f50f4b530d0>:
-00003f20: 207b 2773 7461 7465 273a 2027 534b 4950   {'state': 'SKIP
-00003f30: 5045 4427 2c20 2772 6573 756c 7427 3a20  PED', 'result': 
-00003f40: 4e6f 6e65 2c20 2765 7863 6570 7469 6f6e  None, 'exception
-00003f50: 273a 204e 6f6e 652c 2027 636f 6d70 6c65  ': None, 'comple
-00003f60: 7465 6427 3a20 4661 6c73 657d 2029 0a3e  ted': False} ).>
-00003f70: 3e20 4e6f 6465 283c 6675 6e63 7469 6f6e  > Node(<function
-00003f80: 2067 2061 7420 3078 3766 3530 6634 6235   g at 0x7f50f4b5
-00003f90: 3335 6530 3e3a 207b 2773 7461 7465 273a  35e0>: {'state':
-00003fa0: 2027 534b 4950 5045 4427 2c20 2772 6573   'SKIPPED', 'res
-00003fb0: 756c 7427 3a20 3c74 6872 6561 6469 6e67  ult': <threading
-00003fc0: 2e45 7665 6e74 206f 626a 6563 7420 6174  .Event object at
-00003fd0: 2030 7837 6635 3065 6331 3663 3964 303e   0x7f50ec16c9d0>
-00003fe0: 2c20 2765 7863 6570 7469 6f6e 273a 204e  , 'exception': N
-00003ff0: 6f6e 652c 2027 636f 6d70 6c65 7465 6427  one, 'completed'
-00004000: 3a20 5472 7565 7d20 290a 3e3e 204e 6f64  : True} ).>> Nod
-00004010: 6528 3c66 756e 6374 696f 6e20 6920 6174  e(<function i at
-00004020: 2030 7837 6635 3066 3462 3533 3238 303e   0x7f50f4b53280>
-00004030: 3a20 7b27 7374 6174 6527 3a20 2753 4b49  : {'state': 'SKI
-00004040: 5050 4544 272c 2027 7265 7375 6c74 273a  PPED', 'result':
-00004050: 204e 6f6e 652c 2027 6578 6365 7074 696f   None, 'exceptio
-00004060: 6e27 3a20 4e6f 6e65 2c20 2763 6f6d 706c  n': None, 'compl
-00004070: 6574 6564 273a 2046 616c 7365 7d20 290a  eted': False} ).
-00004080: 6060 600a 0a23 2320 4578 6563 7574 6520  ```..## Execute 
-00004090: 7370 6172 6b20 7069 7065 6c69 6e65 206f  spark pipeline o
-000040a0: 6620 6d75 6c74 6970 6c65 2073 7465 7073  f multiple steps
-000040b0: 0a75 7369 6e67 2044 4147 2063 6f6d 706f  .using DAG compo
-000040c0: 6e65 6e74 2074 6f20 6861 6e64 6c65 2070  nent to handle p
-000040d0: 6172 616c 6c65 6c20 6578 6563 7574 696f  arallel executio
-000040e0: 6e0a 6060 6070 7974 686f 6e0a 696d 706f  n.```python.impo
-000040f0: 7274 2062 6471 0a66 726f 6d20 6264 7120  rt bdq.from bdq 
-00004100: 696d 706f 7274 2073 7061 726b 2c20 7461  import spark, ta
-00004110: 626c 650a 0a70 706e 203d 2062 6471 2e53  ble..ppn = bdq.S
-00004120: 7061 726b 5069 7065 6c69 6e65 2873 7061  parkPipeline(spa
-00004130: 726b 2c20 2272 6574 6169 6c22 290a 0a23  rk, "retail")..#
-00004140: 2072 6574 7572 6e73 2064 6174 6166 7261   returns datafra
-00004150: 6d65 2c20 616e 6420 6372 6561 7465 7320  me, and creates 
-00004160: 7370 6172 6b20 7669 6577 2027 7261 775f  spark view 'raw_
-00004170: 6461 7461 5f73 696e 676c 655f 736f 7572  data_single_sour
-00004180: 6365 270a 4070 706e 2e73 7465 7028 290a  ce'.@ppn.step().
-00004190: 6465 6620 7261 775f 6461 7461 5f73 696e  def raw_data_sin
-000041a0: 676c 655f 736f 7572 6365 2870 293a 0a20  gle_source(p):. 
-000041b0: 2072 6574 7572 6e20 7370 6172 6b2e 7261   return spark.ra
-000041c0: 6e67 6528 312c 2031 3029 0a0a 2320 7265  nge(1, 10)..# re
-000041d0: 7475 726e 7320 6461 7461 6672 616d 652c  turns dataframe,
-000041e0: 2061 6e64 2063 7265 6174 6573 2073 7061   and creates spa
-000041f0: 726b 2076 6965 7720 2772 6177 5f6e 6963  rk view 'raw_nic
-00004200: 655f 6e61 6d65 270a 4070 706e 2e73 7465  e_name'.@ppn.ste
-00004210: 7028 7265 7475 726e 733d 5b22 7261 775f  p(returns=["raw_
-00004220: 6e69 6365 5f6e 616d 6522 5d29 0a64 6566  nice_name"]).def
-00004230: 2072 6177 5f64 6174 615f 7369 6e67 6c65   raw_data_single
-00004240: 5f73 6f75 7263 655f 7769 7468 5f63 7573  _source_with_cus
-00004250: 746f 6d5f 6e61 6d65 2870 293a 0a20 2072  tom_name(p):.  r
-00004260: 6574 7572 6e20 7370 6172 6b2e 7261 6e67  eturn spark.rang
-00004270: 6528 3130 302c 2031 3130 290a 0a23 2072  e(100, 110)..# r
-00004280: 6574 7572 6e73 2074 776f 2064 6174 6166  eturns two dataf
-00004290: 7261 6d65 732c 2061 6e64 2063 7265 6174  rames, and creat
-000042a0: 6573 2074 776f 2073 7061 726b 2076 6965  es two spark vie
-000042b0: 7773 2027 7261 775f 6461 7461 3127 2c20  ws 'raw_data1', 
-000042c0: 2772 6177 5f64 6174 6132 270a 4070 706e  'raw_data2'.@ppn
-000042d0: 2e73 7465 7028 7265 7475 726e 733d 5b22  .step(returns=["
-000042e0: 7261 775f 6461 7461 3122 2c20 2272 6177  raw_data1", "raw
-000042f0: 5f64 6174 6132 225d 290a 6465 6620 7261  _data2"]).def ra
-00004300: 775f 6461 7461 5f6d 756c 7469 5f73 6f75  w_data_multi_sou
-00004310: 7263 6528 7029 3a0a 2020 6466 3120 3d20  rce(p):.  df1 = 
-00004320: 7370 6172 6b2e 7261 6e67 6528 3130 3030  spark.range(1000
-00004330: 2c20 3230 3030 290a 2020 6466 3220 3d20  , 2000).  df2 = 
-00004340: 7370 6172 6b2e 7261 6e67 6528 3230 3030  spark.range(2000
-00004350: 2c20 3330 3030 290a 0a20 2072 6574 7572  , 3000)..  retur
-00004360: 6e20 5b64 6631 2c20 6466 325d 0a0a 2320  n [df1, df2]..# 
-00004370: 7761 6974 7320 666f 7220 7261 7720 6461  waits for raw da
-00004380: 7461 2073 6f75 7263 6573 2074 6f20 6669  ta sources to fi
-00004390: 6e69 7368 2c20 616e 6420 636f 6d62 696e  nish, and combin
-000043a0: 6573 2074 6865 2064 6174 6120 696e 746f  es the data into
-000043b0: 206f 6e65 2075 6e69 6f6e 6564 2076 6965   one unioned vie
-000043c0: 7720 6063 6f6d 6269 6e65 5f64 6174 6160  w `combine_data`
-000043d0: 0a23 206e 6f74 6520 7468 6174 2064 6570  .# note that dep
-000043e0: 656e 6465 6e63 6965 7320 6172 6520 7079  endencies are py
-000043f0: 7468 6f6e 2066 756e 6374 696f 6e73 2c20  thon functions, 
-00004400: 6e6f 7420 6e61 6d65 7320 6f66 2076 6965  not names of vie
-00004410: 7773 2028 544f 444f 3a20 746f 2068 616e  ws (TODO: to han
-00004420: 646c 6520 7669 6577 206e 616d 6573 2061  dle view names a
-00004430: 7320 7765 6c6c 290a 4070 706e 2e73 7465  s well).@ppn.ste
-00004440: 7028 6465 7065 6e64 735f 6f6e 3d5b 7261  p(depends_on=[ra
-00004450: 775f 6461 7461 5f73 696e 676c 655f 736f  w_data_single_so
-00004460: 7572 6365 2c20 7261 775f 6461 7461 5f73  urce, raw_data_s
-00004470: 696e 676c 655f 736f 7572 6365 5f77 6974  ingle_source_wit
-00004480: 685f 6375 7374 6f6d 5f6e 616d 652c 2072  h_custom_name, r
-00004490: 6177 5f64 6174 615f 6d75 6c74 695f 736f  aw_data_multi_so
-000044a0: 7572 6365 5d29 0a64 6566 2063 6f6d 6269  urce]).def combi
-000044b0: 6e65 5f64 6174 6128 7029 3a0a 2020 6466  ne_data(p):.  df
-000044c0: 203d 2074 6162 6c65 2827 7261 775f 6461   = table('raw_da
+000034b0: 0a0a 2320 6966 2079 6f75 2068 6176 6520  ..# if you have 
+000034c0: 6970 7964 6167 7265 6433 2069 6e73 7461  ipydagred3 insta
+000034d0: 6c6c 6564 2c20 796f 7520 6361 6e20 7365  lled, you can se
+000034e0: 6520 696e 2072 6561 6c20 7469 6d65 2073  e in real time s
+000034f0: 7461 7465 2063 6861 6e67 6573 206f 6620  tate changes of 
+00003500: 6561 6368 206f 6620 7468 6520 6e6f 6465  each of the node
+00003510: 730a 6469 7370 6c61 7928 6772 6170 682e  s.display(graph.
+00003520: 7669 7375 616c 697a 6528 2929 0a0a 2365  visualize())..#e
+00003530: 7865 6375 7465 2044 4147 0a67 7261 7068  xecute DAG.graph
+00003540: 2e65 7865 6375 7465 286d 6178 5f77 6f72  .execute(max_wor
+00003550: 6b65 7273 3d31 3029 0a0a 2369 7465 7261  kers=10)..#itera
+00003560: 7465 206f 7665 7220 7265 7375 6c74 730a  te over results.
+00003570: 7072 696e 7428 2249 7465 7261 7465 206f  print("Iterate o
+00003580: 7665 7220 7265 7375 6c74 732e 2e2e 2229  ver results...")
+00003590: 0a66 6f72 206e 6f64 6520 696e 2067 7261  .for node in gra
+000035a0: 7068 2e6e 6f64 6573 3a0a 2020 7072 696e  ph.nodes:.  prin
+000035b0: 7428 6e6f 6465 290a 0a3e 3e20 5761 6974  t(node)..>> Wait
+000035c0: 696e 6720 666f 7220 616c 6c20 7461 736b  ing for all task
+000035d0: 7320 746f 2066 696e 6973 682e 2e2e 0a3e  s to finish....>
+000035e0: 3e20 2020 7374 6172 7469 6e67 3a20 4e6f  >   starting: No
+000035f0: 6465 283c 6675 6e63 7469 6f6e 2061 2061  de(<function a a
+00003600: 7420 3078 3766 3530 6634 6239 6565 3530  t 0x7f50f4b9ee50
+00003610: 3e3a 207b 2773 7461 7465 273a 2027 5255  >: {'state': 'RU
+00003620: 4e4e 494e 4727 2c20 2772 6573 756c 7427  NNING', 'result'
+00003630: 3a20 4e6f 6e65 2c20 2765 7863 6570 7469  : None, 'excepti
+00003640: 6f6e 273a 204e 6f6e 652c 2027 636f 6d70  on': None, 'comp
+00003650: 6c65 7465 6427 3a20 4661 6c73 657d 2029  leted': False} )
+00003660: 0a3e 3e20 2020 7374 6172 7469 6e67 3a20  .>>   starting: 
+00003670: 4e6f 6465 283c 6675 6e63 7469 6f6e 2062  Node(<function b
+00003680: 2061 7420 3078 3766 3530 6634 6235 3330   at 0x7f50f4b530
+00003690: 3430 3e3a 207b 2773 7461 7465 273a 2027  40>: {'state': '
+000036a0: 5255 4e4e 494e 4727 2c20 2772 6573 756c  RUNNING', 'resul
+000036b0: 7427 3a20 4e6f 6e65 2c20 2765 7863 6570  t': None, 'excep
+000036c0: 7469 6f6e 273a 204e 6f6e 652c 2027 636f  tion': None, 'co
+000036d0: 6d70 6c65 7465 6427 3a20 4661 6c73 657d  mpleted': False}
+000036e0: 2029 0a3e 3e20 2020 7374 6172 7469 6e67   ).>>   starting
+000036f0: 3a20 4e6f 6465 283c 6675 6e63 7469 6f6e  : Node(<function
+00003700: 2065 2061 7420 3078 3766 3530 6634 6235   e at 0x7f50f4b5
+00003710: 3362 3830 3e3a 207b 2773 7461 7465 273a  3b80>: {'state':
+00003720: 2027 5255 4e4e 494e 4727 2c20 2772 6573   'RUNNING', 'res
+00003730: 756c 7427 3a20 4e6f 6e65 2c20 2765 7863  ult': None, 'exc
+00003740: 6570 7469 6f6e 273a 204e 6f6e 652c 2027  eption': None, '
+00003750: 636f 6d70 6c65 7465 6427 3a20 4661 6c73  completed': Fals
+00003760: 657d 2029 0a3e 3e20 2020 7374 6172 7469  e} ).>>   starti
+00003770: 6e67 3a20 4e6f 6465 283c 6675 6e63 7469  ng: Node(<functi
+00003780: 6f6e 2067 2061 7420 3078 3766 3530 6634  on g at 0x7f50f4
+00003790: 6235 3335 6530 3e3a 207b 2773 7461 7465  b535e0>: {'state
+000037a0: 273a 2027 5255 4e4e 494e 4727 2c20 2772  ': 'RUNNING', 'r
+000037b0: 6573 756c 7427 3a20 4e6f 6e65 2c20 2765  esult': None, 'e
+000037c0: 7863 6570 7469 6f6e 273a 204e 6f6e 652c  xception': None,
+000037d0: 2027 636f 6d70 6c65 7465 6427 3a20 4661   'completed': Fa
+000037e0: 6c73 657d 2029 0a3e 3e20 2020 6669 6e69  lse} ).>>   fini
+000037f0: 7368 6564 3a20 4e6f 6465 283c 6675 6e63  shed: Node(<func
+00003800: 7469 6f6e 2061 2061 7420 3078 3766 3530  tion a at 0x7f50
+00003810: 6634 6239 6565 3530 3e3a 207b 2773 7461  f4b9ee50>: {'sta
+00003820: 7465 273a 2027 5355 4343 4553 5327 2c20  te': 'SUCCESS', 
+00003830: 2772 6573 756c 7427 3a20 352c 2027 6578  'result': 5, 'ex
+00003840: 6365 7074 696f 6e27 3a20 4e6f 6e65 2c20  ception': None, 
+00003850: 2763 6f6d 706c 6574 6564 273a 2054 7275  'completed': Tru
+00003860: 657d 2029 2028 7374 696c 6c20 7275 6e6e  e} ) (still runn
+00003870: 696e 673a 2033 290a 3e3e 2020 2073 7461  ing: 3).>>   sta
+00003880: 7274 696e 673a 204e 6f64 6528 3c66 756e  rting: Node(<fun
+00003890: 6374 696f 6e20 6320 6174 2030 7837 6635  ction c at 0x7f5
+000038a0: 3066 3462 3533 3463 303e 3a20 7b27 7374  0f4b534c0>: {'st
+000038b0: 6174 6527 3a20 2752 554e 4e49 4e47 272c  ate': 'RUNNING',
+000038c0: 2027 7265 7375 6c74 273a 204e 6f6e 652c   'result': None,
+000038d0: 2027 6578 6365 7074 696f 6e27 3a20 4e6f   'exception': No
+000038e0: 6e65 2c20 2763 6f6d 706c 6574 6564 273a  ne, 'completed':
+000038f0: 2046 616c 7365 7d20 290a 3e3e 2020 2066   False} ).>>   f
+00003900: 696e 6973 6865 643a 204e 6f64 6528 3c66  inished: Node(<f
+00003910: 756e 6374 696f 6e20 6220 6174 2030 7837  unction b at 0x7
+00003920: 6635 3066 3462 3533 3034 303e 3a20 7b27  f50f4b53040>: {'
+00003930: 7374 6174 6527 3a20 2753 5543 4345 5353  state': 'SUCCESS
+00003940: 272c 2027 7265 7375 6c74 273a 2027 6265  ', 'result': 'be
+00003950: 6565 7027 2c20 2765 7863 6570 7469 6f6e  eep', 'exception
+00003960: 273a 204e 6f6e 652c 2027 636f 6d70 6c65  ': None, 'comple
+00003970: 7465 6427 3a20 5472 7565 7d20 2920 2873  ted': True} ) (s
+00003980: 7469 6c6c 2072 756e 6e69 6e67 3a20 3329  till running: 3)
+00003990: 0a3e 3e20 2020 6572 726f 723a 204e 6f64  .>>   error: Nod
+000039a0: 6528 3c66 756e 6374 696f 6e20 6520 6174  e(<function e at
+000039b0: 2030 7837 6635 3066 3462 3533 6238 303e   0x7f50f4b53b80>
+000039c0: 3a20 7b27 7374 6174 6527 3a20 2745 5252  : {'state': 'ERR
+000039d0: 4f52 272c 2027 7265 7375 6c74 273a 204e  OR', 'result': N
+000039e0: 6f6e 652c 2027 6578 6365 7074 696f 6e27  one, 'exception'
+000039f0: 3a20 5661 6c75 6545 7272 6f72 2827 6f6d  : ValueError('om
+00003a00: 672c 2063 7261 7368 2120 3527 292c 2027  g, crash! 5'), '
+00003a10: 636f 6d70 6c65 7465 6427 3a20 5472 7565  completed': True
+00003a20: 7d20 293a 206f 6d67 2c20 6372 6173 6821  } ): omg, crash!
+00003a30: 2035 2028 7374 696c 6c20 7275 6e6e 696e   5 (still runnin
+00003a40: 673a 2032 290a 3e3e 2020 2066 696e 6973  g: 2).>>   finis
+00003a50: 6865 643a 204e 6f64 6528 3c66 756e 6374  hed: Node(<funct
+00003a60: 696f 6e20 6720 6174 2030 7837 6635 3066  ion g at 0x7f50f
+00003a70: 3462 3533 3565 303e 3a20 7b27 7374 6174  4b535e0>: {'stat
+00003a80: 6527 3a20 2753 4b49 5050 4544 272c 2027  e': 'SKIPPED', '
+00003a90: 7265 7375 6c74 273a 203c 7468 7265 6164  result': <thread
+00003aa0: 696e 672e 4576 656e 7420 6f62 6a65 6374  ing.Event object
+00003ab0: 2061 7420 3078 3766 3530 6563 3136 6339   at 0x7f50ec16c9
+00003ac0: 6430 3e2c 2027 6578 6365 7074 696f 6e27  d0>, 'exception'
+00003ad0: 3a20 4e6f 6e65 2c20 2763 6f6d 706c 6574  : None, 'complet
+00003ae0: 6564 273a 2054 7275 657d 2029 2028 7374  ed': True} ) (st
+00003af0: 696c 6c20 7275 6e6e 696e 673a 2031 290a  ill running: 1).
+00003b00: 3e3e 2020 2073 7461 7274 696e 673a 204e  >>   starting: N
+00003b10: 6f64 6528 3c66 756e 6374 696f 6e20 6420  ode(<function d 
+00003b20: 6174 2030 7837 6635 3066 3462 3533 6136  at 0x7f50f4b53a6
+00003b30: 303e 3a20 7b27 7374 6174 6527 3a20 2752  0>: {'state': 'R
+00003b40: 554e 4e49 4e47 272c 2027 7265 7375 6c74  UNNING', 'result
+00003b50: 273a 204e 6f6e 652c 2027 6578 6365 7074  ': None, 'except
+00003b60: 696f 6e27 3a20 4e6f 6e65 2c20 2763 6f6d  ion': None, 'com
+00003b70: 706c 6574 6564 273a 2046 616c 7365 7d20  pleted': False} 
+00003b80: 290a 3e3e 2020 2066 696e 6973 6865 643a  ).>>   finished:
+00003b90: 204e 6f64 6528 3c66 756e 6374 696f 6e20   Node(<function 
+00003ba0: 6320 6174 2030 7837 6635 3066 3462 3533  c at 0x7f50f4b53
+00003bb0: 3463 303e 3a20 7b27 7374 6174 6527 3a20  4c0>: {'state': 
+00003bc0: 2753 5543 4345 5353 272c 2027 7265 7375  'SUCCESS', 'resu
+00003bd0: 6c74 273a 2038 2c20 2765 7863 6570 7469  lt': 8, 'excepti
+00003be0: 6f6e 273a 204e 6f6e 652c 2027 636f 6d70  on': None, 'comp
+00003bf0: 6c65 7465 6427 3a20 5472 7565 7d20 2920  leted': True} ) 
+00003c00: 2873 7469 6c6c 2072 756e 6e69 6e67 3a20  (still running: 
+00003c10: 3129 0a3e 3e20 2020 6669 6e69 7368 6564  1).>>   finished
+00003c20: 3a20 4e6f 6465 283c 6675 6e63 7469 6f6e  : Node(<function
+00003c30: 2064 2061 7420 3078 3766 3530 6634 6235   d at 0x7f50f4b5
+00003c40: 3361 3630 3e3a 207b 2773 7461 7465 273a  3a60>: {'state':
+00003c50: 2027 5355 4343 4553 5327 2c20 2772 6573   'SUCCESS', 'res
+00003c60: 756c 7427 3a20 2767 206d 616e 2073 6179  ult': 'g man say
+00003c70: 3a20 6265 6565 7062 6565 6570 6265 6565  : beeepbeeepbeee
+00003c80: 7027 2c20 2765 7863 6570 7469 6f6e 273a  p', 'exception':
+00003c90: 204e 6f6e 652c 2027 636f 6d70 6c65 7465   None, 'complete
+00003ca0: 6427 3a20 5472 7565 7d20 2920 2873 7469  d': True} ) (sti
+00003cb0: 6c6c 2072 756e 6e69 6e67 3a20 3029 0a3e  ll running: 0).>
+00003cc0: 3e20 416c 6c20 7461 736b 7320 6669 6e69  > All tasks fini
+00003cd0: 7368 6564 2c20 7368 7574 7469 6e67 2064  shed, shutting d
+00003ce0: 6f77 6e0a 3e3e 0a3e 3e20 4974 6572 6174  own.>>.>> Iterat
+00003cf0: 6520 6f76 6572 2072 6573 756c 7473 2e2e  e over results..
+00003d00: 2e0a 3e3e 204e 6f64 6528 3c66 756e 6374  ..>> Node(<funct
+00003d10: 696f 6e20 6120 6174 2030 7837 6635 3066  ion a at 0x7f50f
+00003d20: 3462 3965 6535 303e 3a20 7b27 7374 6174  4b9ee50>: {'stat
+00003d30: 6527 3a20 2753 5543 4345 5353 272c 2027  e': 'SUCCESS', '
+00003d40: 7265 7375 6c74 273a 2035 2c20 2765 7863  result': 5, 'exc
+00003d50: 6570 7469 6f6e 273a 204e 6f6e 652c 2027  eption': None, '
+00003d60: 636f 6d70 6c65 7465 6427 3a20 5472 7565  completed': True
+00003d70: 7d20 290a 3e3e 204e 6f64 6528 3c66 756e  } ).>> Node(<fun
+00003d80: 6374 696f 6e20 6220 6174 2030 7837 6635  ction b at 0x7f5
+00003d90: 3066 3462 3533 3034 303e 3a20 7b27 7374  0f4b53040>: {'st
+00003da0: 6174 6527 3a20 2753 5543 4345 5353 272c  ate': 'SUCCESS',
+00003db0: 2027 7265 7375 6c74 273a 2027 6265 6565   'result': 'beee
+00003dc0: 7027 2c20 2765 7863 6570 7469 6f6e 273a  p', 'exception':
+00003dd0: 204e 6f6e 652c 2027 636f 6d70 6c65 7465   None, 'complete
+00003de0: 6427 3a20 5472 7565 7d20 290a 3e3e 204e  d': True} ).>> N
+00003df0: 6f64 6528 3c66 756e 6374 696f 6e20 6320  ode(<function c 
+00003e00: 6174 2030 7837 6635 3066 3462 3533 3463  at 0x7f50f4b534c
+00003e10: 303e 3a20 7b27 7374 6174 6527 3a20 2753  0>: {'state': 'S
+00003e20: 5543 4345 5353 272c 2027 7265 7375 6c74  UCCESS', 'result
+00003e30: 273a 2038 2c20 2765 7863 6570 7469 6f6e  ': 8, 'exception
+00003e40: 273a 204e 6f6e 652c 2027 636f 6d70 6c65  ': None, 'comple
+00003e50: 7465 6427 3a20 5472 7565 7d20 290a 3e3e  ted': True} ).>>
+00003e60: 204e 6f64 6528 3c66 756e 6374 696f 6e20   Node(<function 
+00003e70: 6420 6174 2030 7837 6635 3066 3462 3533  d at 0x7f50f4b53
+00003e80: 6136 303e 3a20 7b27 7374 6174 6527 3a20  a60>: {'state': 
+00003e90: 2753 5543 4345 5353 272c 2027 7265 7375  'SUCCESS', 'resu
+00003ea0: 6c74 273a 2027 6720 6d61 6e20 7361 793a  lt': 'g man say:
+00003eb0: 2062 6565 6570 6265 6565 7062 6565 6570   beeepbeeepbeeep
+00003ec0: 272c 2027 6578 6365 7074 696f 6e27 3a20  ', 'exception': 
+00003ed0: 4e6f 6e65 2c20 2763 6f6d 706c 6574 6564  None, 'completed
+00003ee0: 273a 2054 7275 657d 2029 0a3e 3e20 4e6f  ': True} ).>> No
+00003ef0: 6465 283c 6675 6e63 7469 6f6e 2065 2061  de(<function e a
+00003f00: 7420 3078 3766 3530 6634 6235 3362 3830  t 0x7f50f4b53b80
+00003f10: 3e3a 207b 2773 7461 7465 273a 2027 4552  >: {'state': 'ER
+00003f20: 524f 5227 2c20 2772 6573 756c 7427 3a20  ROR', 'result': 
+00003f30: 4e6f 6e65 2c20 2765 7863 6570 7469 6f6e  None, 'exception
+00003f40: 273a 2056 616c 7565 4572 726f 7228 276f  ': ValueError('o
+00003f50: 6d67 2c20 6372 6173 6821 2035 2729 2c20  mg, crash! 5'), 
+00003f60: 2763 6f6d 706c 6574 6564 273a 2054 7275  'completed': Tru
+00003f70: 657d 2029 0a3e 3e20 4e6f 6465 283c 6675  e} ).>> Node(<fu
+00003f80: 6e63 7469 6f6e 2066 2061 7420 3078 3766  nction f at 0x7f
+00003f90: 3530 6634 6235 3330 6430 3e3a 207b 2773  50f4b530d0>: {'s
+00003fa0: 7461 7465 273a 2027 534b 4950 5045 4427  tate': 'SKIPPED'
+00003fb0: 2c20 2772 6573 756c 7427 3a20 4e6f 6e65  , 'result': None
+00003fc0: 2c20 2765 7863 6570 7469 6f6e 273a 204e  , 'exception': N
+00003fd0: 6f6e 652c 2027 636f 6d70 6c65 7465 6427  one, 'completed'
+00003fe0: 3a20 4661 6c73 657d 2029 0a3e 3e20 4e6f  : False} ).>> No
+00003ff0: 6465 283c 6675 6e63 7469 6f6e 2067 2061  de(<function g a
+00004000: 7420 3078 3766 3530 6634 6235 3335 6530  t 0x7f50f4b535e0
+00004010: 3e3a 207b 2773 7461 7465 273a 2027 534b  >: {'state': 'SK
+00004020: 4950 5045 4427 2c20 2772 6573 756c 7427  IPPED', 'result'
+00004030: 3a20 3c74 6872 6561 6469 6e67 2e45 7665  : <threading.Eve
+00004040: 6e74 206f 626a 6563 7420 6174 2030 7837  nt object at 0x7
+00004050: 6635 3065 6331 3663 3964 303e 2c20 2765  f50ec16c9d0>, 'e
+00004060: 7863 6570 7469 6f6e 273a 204e 6f6e 652c  xception': None,
+00004070: 2027 636f 6d70 6c65 7465 6427 3a20 5472   'completed': Tr
+00004080: 7565 7d20 290a 3e3e 204e 6f64 6528 3c66  ue} ).>> Node(<f
+00004090: 756e 6374 696f 6e20 6920 6174 2030 7837  unction i at 0x7
+000040a0: 6635 3066 3462 3533 3238 303e 3a20 7b27  f50f4b53280>: {'
+000040b0: 7374 6174 6527 3a20 2753 4b49 5050 4544  state': 'SKIPPED
+000040c0: 272c 2027 7265 7375 6c74 273a 204e 6f6e  ', 'result': Non
+000040d0: 652c 2027 6578 6365 7074 696f 6e27 3a20  e, 'exception': 
+000040e0: 4e6f 6e65 2c20 2763 6f6d 706c 6574 6564  None, 'completed
+000040f0: 273a 2046 616c 7365 7d20 290a 6060 600a  ': False} ).```.
+00004100: 0a23 2320 4578 6563 7574 6520 7370 6172  .## Execute spar
+00004110: 6b20 7069 7065 6c69 6e65 206f 6620 6d75  k pipeline of mu
+00004120: 6c74 6970 6c65 2073 7465 7073 0a75 7369  ltiple steps.usi
+00004130: 6e67 2044 4147 2063 6f6d 706f 6e65 6e74  ng DAG component
+00004140: 2074 6f20 6861 6e64 6c65 2070 6172 616c   to handle paral
+00004150: 6c65 6c20 6578 6563 7574 696f 6e0a 6060  lel execution.``
+00004160: 6070 7974 686f 6e0a 696d 706f 7274 2062  `python.import b
+00004170: 6471 0a66 726f 6d20 6264 7120 696d 706f  dq.from bdq impo
+00004180: 7274 2073 7061 726b 2c20 7461 626c 650a  rt spark, table.
+00004190: 0a70 706e 203d 2062 6471 2e53 7061 726b  .ppn = bdq.Spark
+000041a0: 5069 7065 6c69 6e65 2873 7061 726b 2c20  Pipeline(spark, 
+000041b0: 2272 6574 6169 6c22 290a 0a23 2072 6574  "retail")..# ret
+000041c0: 7572 6e73 2064 6174 6166 7261 6d65 2c20  urns dataframe, 
+000041d0: 616e 6420 6372 6561 7465 7320 7370 6172  and creates spar
+000041e0: 6b20 7669 6577 2027 7261 775f 6461 7461  k view 'raw_data
+000041f0: 5f73 696e 676c 655f 736f 7572 6365 270a  _single_source'.
+00004200: 4070 706e 2e73 7465 7028 290a 6465 6620  @ppn.step().def 
+00004210: 7261 775f 6461 7461 5f73 696e 676c 655f  raw_data_single_
+00004220: 736f 7572 6365 2870 293a 0a20 2072 6574  source(p):.  ret
+00004230: 7572 6e20 7370 6172 6b2e 7261 6e67 6528  urn spark.range(
+00004240: 312c 2031 3029 0a0a 2320 7265 7475 726e  1, 10)..# return
+00004250: 7320 6461 7461 6672 616d 652c 2061 6e64  s dataframe, and
+00004260: 2063 7265 6174 6573 2073 7061 726b 2076   creates spark v
+00004270: 6965 7720 2772 6177 5f6e 6963 655f 6e61  iew 'raw_nice_na
+00004280: 6d65 270a 4070 706e 2e73 7465 7028 7265  me'.@ppn.step(re
+00004290: 7475 726e 733d 5b22 7261 775f 6e69 6365  turns=["raw_nice
+000042a0: 5f6e 616d 6522 5d29 0a64 6566 2072 6177  _name"]).def raw
+000042b0: 5f64 6174 615f 7369 6e67 6c65 5f73 6f75  _data_single_sou
+000042c0: 7263 655f 7769 7468 5f63 7573 746f 6d5f  rce_with_custom_
+000042d0: 6e61 6d65 2870 293a 0a20 2072 6574 7572  name(p):.  retur
+000042e0: 6e20 7370 6172 6b2e 7261 6e67 6528 3130  n spark.range(10
+000042f0: 302c 2031 3130 290a 0a23 2072 6574 7572  0, 110)..# retur
+00004300: 6e73 2074 776f 2064 6174 6166 7261 6d65  ns two dataframe
+00004310: 732c 2061 6e64 2063 7265 6174 6573 2074  s, and creates t
+00004320: 776f 2073 7061 726b 2076 6965 7773 2027  wo spark views '
+00004330: 7261 775f 6461 7461 3127 2c20 2772 6177  raw_data1', 'raw
+00004340: 5f64 6174 6132 270a 4070 706e 2e73 7465  _data2'.@ppn.ste
+00004350: 7028 7265 7475 726e 733d 5b22 7261 775f  p(returns=["raw_
+00004360: 6461 7461 3122 2c20 2272 6177 5f64 6174  data1", "raw_dat
+00004370: 6132 225d 290a 6465 6620 7261 775f 6461  a2"]).def raw_da
+00004380: 7461 5f6d 756c 7469 5f73 6f75 7263 6528  ta_multi_source(
+00004390: 7029 3a0a 2020 6466 3120 3d20 7370 6172  p):.  df1 = spar
+000043a0: 6b2e 7261 6e67 6528 3130 3030 2c20 3230  k.range(1000, 20
+000043b0: 3030 290a 2020 6466 3220 3d20 7370 6172  00).  df2 = spar
+000043c0: 6b2e 7261 6e67 6528 3230 3030 2c20 3330  k.range(2000, 30
+000043d0: 3030 290a 0a20 2072 6574 7572 6e20 5b64  00)..  return [d
+000043e0: 6631 2c20 6466 325d 0a0a 2320 7761 6974  f1, df2]..# wait
+000043f0: 7320 666f 7220 7261 7720 6461 7461 2073  s for raw data s
+00004400: 6f75 7263 6573 2074 6f20 6669 6e69 7368  ources to finish
+00004410: 2c20 616e 6420 636f 6d62 696e 6573 2074  , and combines t
+00004420: 6865 2064 6174 6120 696e 746f 206f 6e65  he data into one
+00004430: 2075 6e69 6f6e 6564 2076 6965 7720 6063   unioned view `c
+00004440: 6f6d 6269 6e65 5f64 6174 6160 0a23 206e  ombine_data`.# n
+00004450: 6f74 6520 7468 6174 2064 6570 656e 6465  ote that depende
+00004460: 6e63 6965 7320 6172 6520 7079 7468 6f6e  ncies are python
+00004470: 2066 756e 6374 696f 6e73 2c20 6e6f 7420   functions, not 
+00004480: 6e61 6d65 7320 6f66 2076 6965 7773 2028  names of views (
+00004490: 544f 444f 3a20 746f 2068 616e 646c 6520  TODO: to handle 
+000044a0: 7669 6577 206e 616d 6573 2061 7320 7765  view names as we
+000044b0: 6c6c 290a 4070 706e 2e73 7465 7028 6465  ll).@ppn.step(de
+000044c0: 7065 6e64 735f 6f6e 3d5b 7261 775f 6461  pends_on=[raw_da
 000044d0: 7461 5f73 696e 676c 655f 736f 7572 6365  ta_single_source
-000044e0: 2729 205c 0a20 2020 202e 756e 696f 6e28  ') \.    .union(
-000044f0: 7461 626c 6528 2772 6177 5f6e 6963 655f  table('raw_nice_
-00004500: 6e61 6d65 2729 2920 5c0a 2020 2020 2e75  name')) \.    .u
-00004510: 6e69 6f6e 2874 6162 6c65 2827 7261 775f  nion(table('raw_
-00004520: 6461 7461 3127 2929 205c 0a20 2020 202e  data1')) \.    .
-00004530: 756e 696f 6e28 7461 626c 6528 2772 6177  union(table('raw
-00004540: 5f64 6174 6132 2729 290a 0a20 2072 6574  _data2'))..  ret
-00004550: 7572 6e20 6466 0a0a 2320 7370 6c69 7473  urn df..# splits
-00004560: 2074 6865 2063 6f6d 6269 6e65 645f 6461   the combined_da
-00004570: 7461 2069 6e74 6f20 276f 6464 2720 616e  ta into 'odd' an
-00004580: 6420 2765 7665 6e27 2076 6965 7773 0a40  d 'even' views.@
-00004590: 7070 6e2e 7374 6570 2864 6570 656e 6473  ppn.step(depends
-000045a0: 5f6f 6e3d 5b63 6f6d 6269 6e65 5f64 6174  _on=[combine_dat
-000045b0: 615d 2c20 7265 7475 726e 733d 5b27 6f64  a], returns=['od
-000045c0: 6427 2c20 2765 7665 6e27 5d29 0a64 6566  d', 'even']).def
-000045d0: 2073 706c 6974 5f64 6174 6128 7029 3a0a   split_data(p):.
-000045e0: 2020 6466 5f6f 6464 203d 2074 6162 6c65    df_odd = table
-000045f0: 2827 636f 6d62 696e 655f 6461 7461 2729  ('combine_data')
-00004600: 2e66 696c 7465 7228 2769 6420 2520 3220  .filter('id % 2 
-00004610: 3d3d 2031 2729 0a20 2064 665f 6576 656e  == 1').  df_even
-00004620: 203d 2074 6162 6c65 2827 636f 6d62 696e   = table('combin
-00004630: 655f 6461 7461 2729 2e66 696c 7465 7228  e_data').filter(
-00004640: 2769 6420 2520 3220 3d3d 2030 2729 0a0a  'id % 2 == 0')..
-00004650: 2020 7265 7475 726e 205b 2064 665f 6f64    return [ df_od
-00004660: 642c 2064 665f 6576 656e 205d 0a0a 2320  d, df_even ]..# 
-00004670: 6578 6563 7574 6573 2070 6970 656c 696e  executes pipelin
-00004680: 6520 7573 696e 6720 636f 6e63 7572 7265  e using concurre
-00004690: 6e74 2074 6872 6561 6473 2c20 6f6e 6520  nt threads, one 
-000046a0: 7065 7220 6561 6368 2073 7465 702c 2066  per each step, f
-000046b0: 6f6c 6c6f 7769 6e67 2074 6865 2064 6570  ollowing the dep
-000046c0: 656e 6465 6e63 7920 4441 470a 2320 7069  endency DAG.# pi
-000046d0: 7065 6c69 6e65 2069 7320 6120 6e6f 726d  peline is a norm
-000046e0: 616c 2070 7974 686f 6e20 6361 6c6c 6162  al python callab
-000046f0: 6c65 206f 626a 6563 742c 2061 7320 6966  le object, as if
-00004700: 2069 7420 7761 7320 6120 6675 6e63 7469   it was a functi
-00004710: 6f6e 2c20 6974 2072 6574 7572 6e73 2061  on, it returns a
-00004720: 206c 6973 7420 6f66 2061 6c6c 2073 7465   list of all ste
-00004730: 7073 0a70 6970 656c 696e 655f 7265 7375  ps.pipeline_resu
-00004740: 6c74 7320 3d20 7070 6e28 6d61 785f 636f  lts = ppn(max_co
-00004750: 6e63 7572 7265 6e74 5f73 7465 7073 3d31  ncurrent_steps=1
-00004760: 3029 0a0a 7072 696e 7428 2770 6970 656c  0)..print('pipel
-00004770: 696e 6520 7265 7375 6c74 733a 2729 0a70  ine results:').p
-00004780: 7269 6e74 2870 6970 656c 696e 655f 7265  rint(pipeline_re
-00004790: 7375 6c74 7329 0a0a 2373 686f 7720 736f  sults)..#show so
-000047a0: 6d65 2066 696e 616c 2076 616c 7565 730a  me final values.
-000047b0: 7072 696e 7428 2765 7665 6e20 6e75 6d62  print('even numb
-000047c0: 6572 733a 2729 0a70 7269 6e74 2874 6162  ers:').print(tab
-000047d0: 6c65 2827 6576 656e 2729 2e6c 696d 6974  le('even').limit
-000047e0: 2831 3029 2e63 6f6c 6c65 6374 2829 290a  (10).collect()).
-000047f0: 7072 696e 7428 276f 6464 206e 756d 6265  print('odd numbe
-00004800: 7273 3a27 290a 7072 696e 7428 7461 626c  rs:').print(tabl
-00004810: 6528 276f 6464 2729 2e6c 696d 6974 2831  e('odd').limit(1
-00004820: 3029 2e63 6f6c 6c65 6374 2829 290a 0a3e  0).collect())..>
-00004830: 3e20 5761 6974 696e 6720 666f 7220 616c  > Waiting for al
-00004840: 6c20 7461 736b 7320 746f 2066 696e 6973  l tasks to finis
-00004850: 682e 2e2e 0a3e 3e20 2020 7374 6172 7469  h....>>   starti
-00004860: 6e67 3a20 4e6f 6465 2872 6177 5f64 6174  ng: Node(raw_dat
-00004870: 615f 7369 6e67 6c65 5f73 6f75 7263 653a  a_single_source:
-00004880: 207b 2773 7461 7465 273a 2027 5255 4e4e   {'state': 'RUNN
-00004890: 494e 4727 2c20 2772 6573 756c 7427 3a20  ING', 'result': 
-000048a0: 4e6f 6e65 2c20 2765 7863 6570 7469 6f6e  None, 'exception
-000048b0: 273a 204e 6f6e 652c 2027 636f 6d70 6c65  ': None, 'comple
-000048c0: 7465 6427 3a20 4661 6c73 657d 2029 0a3e  ted': False} ).>
-000048d0: 3e20 2020 7374 6172 7469 6e67 3a20 4e6f  >   starting: No
-000048e0: 6465 2872 6177 5f64 6174 615f 7369 6e67  de(raw_data_sing
-000048f0: 6c65 5f73 6f75 7263 655f 7769 7468 5f63  le_source_with_c
-00004900: 7573 746f 6d5f 6e61 6d65 3a20 7b27 7374  ustom_name: {'st
-00004910: 6174 6527 3a20 2752 554e 4e49 4e47 272c  ate': 'RUNNING',
-00004920: 2027 7265 7375 6c74 273a 204e 6f6e 652c   'result': None,
-00004930: 2027 6578 6365 7074 696f 6e27 3a20 4e6f   'exception': No
-00004940: 6e65 2c20 2763 6f6d 706c 6574 6564 273a  ne, 'completed':
-00004950: 2046 616c 7365 7d20 290a 3e3e 2020 2073   False} ).>>   s
-00004960: 7461 7274 696e 673a 204e 6f64 6528 7261  tarting: Node(ra
-00004970: 775f 6461 7461 5f6d 756c 7469 5f73 6f75  w_data_multi_sou
-00004980: 7263 653a 207b 2773 7461 7465 273a 2027  rce: {'state': '
-00004990: 5255 4e4e 494e 4727 2c20 2772 6573 756c  RUNNING', 'resul
-000049a0: 7427 3a20 4e6f 6e65 2c20 2765 7863 6570  t': None, 'excep
-000049b0: 7469 6f6e 273a 204e 6f6e 652c 2027 636f  tion': None, 'co
-000049c0: 6d70 6c65 7465 6427 3a20 4661 6c73 657d  mpleted': False}
-000049d0: 2029 0a3e 3e20 2020 6669 6e69 7368 6564   ).>>   finished
-000049e0: 3a20 4e6f 6465 2872 6177 5f64 6174 615f  : Node(raw_data_
-000049f0: 7369 6e67 6c65 5f73 6f75 7263 653a 207b  single_source: {
-00004a00: 2773 7461 7465 273a 2027 5355 4343 4553  'state': 'SUCCES
-00004a10: 5327 2c20 2772 6573 756c 7427 3a20 5b44  S', 'result': [D
-00004a20: 6174 6146 7261 6d65 5b69 643a 2062 6967  ataFrame[id: big
-00004a30: 696e 745d 5d2c 2027 6578 6365 7074 696f  int]], 'exceptio
-00004a40: 6e27 3a20 4e6f 6e65 2c20 2763 6f6d 706c  n': None, 'compl
-00004a50: 6574 6564 273a 2054 7275 657d 2029 2028  eted': True} ) (
-00004a60: 7374 696c 6c20 7275 6e6e 696e 673a 2032  still running: 2
-00004a70: 290a 3e3e 2020 2066 696e 6973 6865 643a  ).>>   finished:
-00004a80: 204e 6f64 6528 7261 775f 6461 7461 5f73   Node(raw_data_s
-00004a90: 696e 676c 655f 736f 7572 6365 5f77 6974  ingle_source_wit
-00004aa0: 685f 6375 7374 6f6d 5f6e 616d 653a 207b  h_custom_name: {
-00004ab0: 2773 7461 7465 273a 2027 5355 4343 4553  'state': 'SUCCES
-00004ac0: 5327 2c20 2772 6573 756c 7427 3a20 5b44  S', 'result': [D
-00004ad0: 6174 6146 7261 6d65 5b69 643a 2062 6967  ataFrame[id: big
-00004ae0: 696e 745d 5d2c 2027 6578 6365 7074 696f  int]], 'exceptio
-00004af0: 6e27 3a20 4e6f 6e65 2c20 2763 6f6d 706c  n': None, 'compl
-00004b00: 6574 6564 273a 2054 7275 657d 2029 2028  eted': True} ) (
-00004b10: 7374 696c 6c20 7275 6e6e 696e 673a 2031  still running: 1
-00004b20: 290a 3e3e 2020 2073 7461 7274 696e 673a  ).>>   starting:
-00004b30: 204e 6f64 6528 636f 6d62 696e 655f 6461   Node(combine_da
-00004b40: 7461 3a20 7b27 7374 6174 6527 3a20 2752  ta: {'state': 'R
-00004b50: 554e 4e49 4e47 272c 2027 7265 7375 6c74  UNNING', 'result
-00004b60: 273a 204e 6f6e 652c 2027 6578 6365 7074  ': None, 'except
-00004b70: 696f 6e27 3a20 4e6f 6e65 2c20 2763 6f6d  ion': None, 'com
-00004b80: 706c 6574 6564 273a 2046 616c 7365 7d20  pleted': False} 
-00004b90: 290a 3e3e 2020 2066 696e 6973 6865 643a  ).>>   finished:
-00004ba0: 204e 6f64 6528 7261 775f 6461 7461 5f6d   Node(raw_data_m
-00004bb0: 756c 7469 5f73 6f75 7263 653a 207b 2773  ulti_source: {'s
-00004bc0: 7461 7465 273a 2027 5355 4343 4553 5327  tate': 'SUCCESS'
-00004bd0: 2c20 2772 6573 756c 7427 3a20 5b44 6174  , 'result': [Dat
-00004be0: 6146 7261 6d65 5b69 643a 2062 6967 696e  aFrame[id: bigin
-00004bf0: 745d 2c20 4461 7461 4672 616d 655b 6964  t], DataFrame[id
-00004c00: 3a20 6269 6769 6e74 5d5d 2c20 2765 7863  : bigint]], 'exc
-00004c10: 6570 7469 6f6e 273a 204e 6f6e 652c 2027  eption': None, '
-00004c20: 636f 6d70 6c65 7465 6427 3a20 5472 7565  completed': True
-00004c30: 7d20 2920 2873 7469 6c6c 2072 756e 6e69  } ) (still runni
-00004c40: 6e67 3a20 3129 0a3e 3e20 2020 7374 6172  ng: 1).>>   star
-00004c50: 7469 6e67 3a20 4e6f 6465 2873 706c 6974  ting: Node(split
-00004c60: 5f64 6174 613a 207b 2773 7461 7465 273a  _data: {'state':
-00004c70: 2027 5255 4e4e 494e 4727 2c20 2772 6573   'RUNNING', 'res
-00004c80: 756c 7427 3a20 4e6f 6e65 2c20 2765 7863  ult': None, 'exc
-00004c90: 6570 7469 6f6e 273a 204e 6f6e 652c 2027  eption': None, '
-00004ca0: 636f 6d70 6c65 7465 6427 3a20 4661 6c73  completed': Fals
-00004cb0: 657d 2029 0a3e 3e20 2020 6669 6e69 7368  e} ).>>   finish
-00004cc0: 6564 3a20 4e6f 6465 2863 6f6d 6269 6e65  ed: Node(combine
-00004cd0: 5f64 6174 613a 207b 2773 7461 7465 273a  _data: {'state':
-00004ce0: 2027 5355 4343 4553 5327 2c20 2772 6573   'SUCCESS', 'res
-00004cf0: 756c 7427 3a20 5b44 6174 6146 7261 6d65  ult': [DataFrame
-00004d00: 5b69 643a 2062 6967 696e 745d 5d2c 2027  [id: bigint]], '
-00004d10: 6578 6365 7074 696f 6e27 3a20 4e6f 6e65  exception': None
-00004d20: 2c20 2763 6f6d 706c 6574 6564 273a 2054  , 'completed': T
-00004d30: 7275 657d 2029 2028 7374 696c 6c20 7275  rue} ) (still ru
-00004d40: 6e6e 696e 673a 2031 290a 3e3e 2020 2066  nning: 1).>>   f
-00004d50: 696e 6973 6865 643a 204e 6f64 6528 7370  inished: Node(sp
-00004d60: 6c69 745f 6461 7461 3a20 7b27 7374 6174  lit_data: {'stat
-00004d70: 6527 3a20 2753 5543 4345 5353 272c 2027  e': 'SUCCESS', '
-00004d80: 7265 7375 6c74 273a 205b 4461 7461 4672  result': [DataFr
-00004d90: 616d 655b 6964 3a20 6269 6769 6e74 5d2c  ame[id: bigint],
-00004da0: 2044 6174 6146 7261 6d65 5b69 643a 2062   DataFrame[id: b
-00004db0: 6967 696e 745d 5d2c 2027 6578 6365 7074  igint]], 'except
-00004dc0: 696f 6e27 3a20 4e6f 6e65 2c20 2763 6f6d  ion': None, 'com
-00004dd0: 706c 6574 6564 273a 2054 7275 657d 2029  pleted': True} )
-00004de0: 2028 7374 696c 6c20 7275 6e6e 696e 673a   (still running:
-00004df0: 2030 290a 3e3e 2041 6c6c 2074 6173 6b73   0).>> All tasks
-00004e00: 2066 696e 6973 6865 642c 2073 6875 7474   finished, shutt
-00004e10: 696e 6720 646f 776e 0a3e 3e20 7069 7065  ing down.>> pipe
-00004e20: 6c69 6e65 2072 6573 756c 7473 3a0a 3e3e  line results:.>>
-00004e30: 205b 7261 775f 6461 7461 5f73 696e 676c   [raw_data_singl
-00004e40: 655f 736f 7572 6365 2c20 7261 775f 6461  e_source, raw_da
-00004e50: 7461 5f73 696e 676c 655f 736f 7572 6365  ta_single_source
-00004e60: 5f77 6974 685f 6375 7374 6f6d 5f6e 616d  _with_custom_nam
-00004e70: 652c 2072 6177 5f64 6174 615f 6d75 6c74  e, raw_data_mult
-00004e80: 695f 736f 7572 6365 2c20 636f 6d62 696e  i_source, combin
-00004e90: 655f 6461 7461 2c20 7370 6c69 745f 6461  e_data, split_da
-00004ea0: 7461 5d0a 3e3e 2065 7665 6e20 6e75 6d62  ta].>> even numb
-00004eb0: 6572 733a 0a3e 3e20 5b52 6f77 2869 643d  ers:.>> [Row(id=
-00004ec0: 3229 2c20 526f 7728 6964 3d34 292c 2052  2), Row(id=4), R
-00004ed0: 6f77 2869 643d 3629 2c20 526f 7728 6964  ow(id=6), Row(id
-00004ee0: 3d38 292c 2052 6f77 2869 643d 3130 3029  =8), Row(id=100)
-00004ef0: 2c20 526f 7728 6964 3d31 3032 292c 2052  , Row(id=102), R
-00004f00: 6f77 2869 643d 3130 3429 2c20 526f 7728  ow(id=104), Row(
-00004f10: 6964 3d31 3036 292c 2052 6f77 2869 643d  id=106), Row(id=
-00004f20: 3130 3829 2c20 526f 7728 6964 3d31 3030  108), Row(id=100
-00004f30: 3029 5d0a 3e3e 206f 6464 206e 756d 6265  0)].>> odd numbe
-00004f40: 7273 3a0a 3e3e 205b 526f 7728 6964 3d31  rs:.>> [Row(id=1
-00004f50: 292c 2052 6f77 2869 643d 3329 2c20 526f  ), Row(id=3), Ro
-00004f60: 7728 6964 3d35 292c 2052 6f77 2869 643d  w(id=5), Row(id=
-00004f70: 3729 2c20 526f 7728 6964 3d39 292c 2052  7), Row(id=9), R
-00004f80: 6f77 2869 643d 3130 3129 2c20 526f 7728  ow(id=101), Row(
-00004f90: 6964 3d31 3033 292c 2052 6f77 2869 643d  id=103), Row(id=
-00004fa0: 3130 3529 2c20 526f 7728 6964 3d31 3037  105), Row(id=107
-00004fb0: 292c 2052 6f77 2869 643d 3130 3929 5d0a  ), Row(id=109)].
-00004fc0: 6060 600a 0a70 6970 656c 696e 6520 7374  ```..pipeline st
-00004fd0: 6570 7320 6172 6520 7265 7275 6e61 626c  eps are rerunabl
-00004fe0: 6520 6173 2061 6e79 206f 7264 696e 6172  e as any ordinar
-00004ff0: 7920 6675 6e63 7469 6f6e 3a0a 6060 6070  y function:.```p
-00005000: 7974 686f 6e0a 2320 746f 2072 6572 756e  ython.# to rerun
-00005010: 2067 6976 656e 2073 7465 702c 206a 7573   given step, jus
-00005020: 7420 6578 6563 7574 6520 6974 2061 7320  t execute it as 
-00005030: 6966 2069 7420 7761 7320 6120 7075 7265  if it was a pure
-00005040: 2066 756e 6374 696f 6e0a 2320 7265 7475   function.# retu
-00005050: 726e 2069 7320 616c 6177 6179 7320 6120  rn is alaways a 
-00005060: 6c69 7374 206f 6620 6461 7461 6672 616d  list of datafram
-00005070: 7320 7468 6174 2067 6976 656e 2040 7070  s that given @pp
-00005080: 6e2e 7374 6570 2072 6574 7572 6e73 0a23  n.step returns.#
-00005090: 206e 6f74 653a 2074 6865 2073 7061 726b   note: the spark
-000050a0: 2076 6965 7720 2772 6177 5f64 6174 615f   view 'raw_data_
-000050b0: 7369 6e67 6c65 5f73 6f75 7263 6527 2077  single_source' w
-000050c0: 696c 6c20 6265 2075 7064 6174 6564 2077  ill be updated w
-000050d0: 6865 6e20 7468 6973 2066 756e 6374 696f  hen this functio
-000050e0: 6e20 6669 6e69 7368 6573 2028 6173 2070  n finishes (as p
-000050f0: 6572 2064 6566 696e 7469 6f6e 2069 6e20  er defintion in 
-00005100: 4070 706e 2e73 7465 7020 6162 6f76 6529  @ppn.step above)
-00005110: 0a72 6177 5f64 6174 615f 7369 6e67 6c65  .raw_data_single
-00005120: 5f73 6f75 7263 6528 290a 6060 600a       _source().```.
+000044e0: 2c20 7261 775f 6461 7461 5f73 696e 676c  , raw_data_singl
+000044f0: 655f 736f 7572 6365 5f77 6974 685f 6375  e_source_with_cu
+00004500: 7374 6f6d 5f6e 616d 652c 2072 6177 5f64  stom_name, raw_d
+00004510: 6174 615f 6d75 6c74 695f 736f 7572 6365  ata_multi_source
+00004520: 5d29 0a64 6566 2063 6f6d 6269 6e65 5f64  ]).def combine_d
+00004530: 6174 6128 7029 3a0a 2020 6466 203d 2074  ata(p):.  df = t
+00004540: 6162 6c65 2827 7261 775f 6461 7461 5f73  able('raw_data_s
+00004550: 696e 676c 655f 736f 7572 6365 2729 205c  ingle_source') \
+00004560: 0a20 2020 202e 756e 696f 6e28 7461 626c  .    .union(tabl
+00004570: 6528 2772 6177 5f6e 6963 655f 6e61 6d65  e('raw_nice_name
+00004580: 2729 2920 5c0a 2020 2020 2e75 6e69 6f6e  ')) \.    .union
+00004590: 2874 6162 6c65 2827 7261 775f 6461 7461  (table('raw_data
+000045a0: 3127 2929 205c 0a20 2020 202e 756e 696f  1')) \.    .unio
+000045b0: 6e28 7461 626c 6528 2772 6177 5f64 6174  n(table('raw_dat
+000045c0: 6132 2729 290a 0a20 2072 6574 7572 6e20  a2'))..  return 
+000045d0: 6466 0a0a 2320 7370 6c69 7473 2074 6865  df..# splits the
+000045e0: 2063 6f6d 6269 6e65 645f 6461 7461 2069   combined_data i
+000045f0: 6e74 6f20 276f 6464 2720 616e 6420 2765  nto 'odd' and 'e
+00004600: 7665 6e27 2076 6965 7773 0a40 7070 6e2e  ven' views.@ppn.
+00004610: 7374 6570 2864 6570 656e 6473 5f6f 6e3d  step(depends_on=
+00004620: 5b63 6f6d 6269 6e65 5f64 6174 615d 2c20  [combine_data], 
+00004630: 7265 7475 726e 733d 5b27 6f64 6427 2c20  returns=['odd', 
+00004640: 2765 7665 6e27 5d29 0a64 6566 2073 706c  'even']).def spl
+00004650: 6974 5f64 6174 6128 7029 3a0a 2020 6466  it_data(p):.  df
+00004660: 5f6f 6464 203d 2074 6162 6c65 2827 636f  _odd = table('co
+00004670: 6d62 696e 655f 6461 7461 2729 2e66 696c  mbine_data').fil
+00004680: 7465 7228 2769 6420 2520 3220 3d3d 2031  ter('id % 2 == 1
+00004690: 2729 0a20 2064 665f 6576 656e 203d 2074  ').  df_even = t
+000046a0: 6162 6c65 2827 636f 6d62 696e 655f 6461  able('combine_da
+000046b0: 7461 2729 2e66 696c 7465 7228 2769 6420  ta').filter('id 
+000046c0: 2520 3220 3d3d 2030 2729 0a0a 2020 7265  % 2 == 0')..  re
+000046d0: 7475 726e 205b 2064 665f 6f64 642c 2064  turn [ df_odd, d
+000046e0: 665f 6576 656e 205d 0a0a 2320 6966 2079  f_even ]..# if y
+000046f0: 6f75 2068 6176 6520 6970 7964 6167 7265  ou have ipydagre
+00004700: 6433 2069 6e73 7461 6c6c 6564 2c20 796f  d3 installed, yo
+00004710: 7520 6361 6e20 7365 6520 696e 2072 6561  u can see in rea
+00004720: 6c20 7469 6d65 2073 7461 7465 2063 6861  l time state cha
+00004730: 6e67 6573 206f 6620 6561 6368 206f 6620  nges of each of 
+00004740: 7468 6520 7374 6570 730a 6469 7370 6c61  the steps.displa
+00004750: 7928 7070 6e2e 7669 7375 616c 697a 6528  y(ppn.visualize(
+00004760: 2929 0a0a 2320 6578 6563 7574 6573 2070  ))..# executes p
+00004770: 6970 656c 696e 6520 7573 696e 6720 636f  ipeline using co
+00004780: 6e63 7572 7265 6e74 2074 6872 6561 6473  ncurrent threads
+00004790: 2c20 6f6e 6520 7065 7220 6561 6368 2073  , one per each s
+000047a0: 7465 702c 2066 6f6c 6c6f 7769 6e67 2074  tep, following t
+000047b0: 6865 2064 6570 656e 6465 6e63 7920 4441  he dependency DA
+000047c0: 470a 2320 7069 7065 6c69 6e65 2069 7320  G.# pipeline is 
+000047d0: 6120 6e6f 726d 616c 2070 7974 686f 6e20  a normal python 
+000047e0: 6361 6c6c 6162 6c65 206f 626a 6563 742c  callable object,
+000047f0: 2061 7320 6966 2069 7420 7761 7320 6120   as if it was a 
+00004800: 6675 6e63 7469 6f6e 2c20 6974 2072 6574  function, it ret
+00004810: 7572 6e73 2061 206c 6973 7420 6f66 2061  urns a list of a
+00004820: 6c6c 2073 7465 7073 0a70 6970 656c 696e  ll steps.pipelin
+00004830: 655f 7265 7375 6c74 7320 3d20 7070 6e28  e_results = ppn(
+00004840: 6d61 785f 636f 6e63 7572 7265 6e74 5f73  max_concurrent_s
+00004850: 7465 7073 3d31 3029 0a0a 7072 696e 7428  teps=10)..print(
+00004860: 2770 6970 656c 696e 6520 7265 7375 6c74  'pipeline result
+00004870: 733a 2729 0a70 7269 6e74 2870 6970 656c  s:').print(pipel
+00004880: 696e 655f 7265 7375 6c74 7329 0a0a 2373  ine_results)..#s
+00004890: 686f 7720 736f 6d65 2066 696e 616c 2076  how some final v
+000048a0: 616c 7565 730a 7072 696e 7428 2765 7665  alues.print('eve
+000048b0: 6e20 6e75 6d62 6572 733a 2729 0a70 7269  n numbers:').pri
+000048c0: 6e74 2874 6162 6c65 2827 6576 656e 2729  nt(table('even')
+000048d0: 2e6c 696d 6974 2831 3029 2e63 6f6c 6c65  .limit(10).colle
+000048e0: 6374 2829 290a 7072 696e 7428 276f 6464  ct()).print('odd
+000048f0: 206e 756d 6265 7273 3a27 290a 7072 696e   numbers:').prin
+00004900: 7428 7461 626c 6528 276f 6464 2729 2e6c  t(table('odd').l
+00004910: 696d 6974 2831 3029 2e63 6f6c 6c65 6374  imit(10).collect
+00004920: 2829 290a 0a3e 3e20 5761 6974 696e 6720  ())..>> Waiting 
+00004930: 666f 7220 616c 6c20 7461 736b 7320 746f  for all tasks to
+00004940: 2066 696e 6973 682e 2e2e 0a3e 3e20 2020   finish....>>   
+00004950: 7374 6172 7469 6e67 3a20 4e6f 6465 2872  starting: Node(r
+00004960: 6177 5f64 6174 615f 7369 6e67 6c65 5f73  aw_data_single_s
+00004970: 6f75 7263 653a 207b 2773 7461 7465 273a  ource: {'state':
+00004980: 2027 5255 4e4e 494e 4727 2c20 2772 6573   'RUNNING', 'res
+00004990: 756c 7427 3a20 4e6f 6e65 2c20 2765 7863  ult': None, 'exc
+000049a0: 6570 7469 6f6e 273a 204e 6f6e 652c 2027  eption': None, '
+000049b0: 636f 6d70 6c65 7465 6427 3a20 4661 6c73  completed': Fals
+000049c0: 657d 2029 0a3e 3e20 2020 7374 6172 7469  e} ).>>   starti
+000049d0: 6e67 3a20 4e6f 6465 2872 6177 5f64 6174  ng: Node(raw_dat
+000049e0: 615f 7369 6e67 6c65 5f73 6f75 7263 655f  a_single_source_
+000049f0: 7769 7468 5f63 7573 746f 6d5f 6e61 6d65  with_custom_name
+00004a00: 3a20 7b27 7374 6174 6527 3a20 2752 554e  : {'state': 'RUN
+00004a10: 4e49 4e47 272c 2027 7265 7375 6c74 273a  NING', 'result':
+00004a20: 204e 6f6e 652c 2027 6578 6365 7074 696f   None, 'exceptio
+00004a30: 6e27 3a20 4e6f 6e65 2c20 2763 6f6d 706c  n': None, 'compl
+00004a40: 6574 6564 273a 2046 616c 7365 7d20 290a  eted': False} ).
+00004a50: 3e3e 2020 2073 7461 7274 696e 673a 204e  >>   starting: N
+00004a60: 6f64 6528 7261 775f 6461 7461 5f6d 756c  ode(raw_data_mul
+00004a70: 7469 5f73 6f75 7263 653a 207b 2773 7461  ti_source: {'sta
+00004a80: 7465 273a 2027 5255 4e4e 494e 4727 2c20  te': 'RUNNING', 
+00004a90: 2772 6573 756c 7427 3a20 4e6f 6e65 2c20  'result': None, 
+00004aa0: 2765 7863 6570 7469 6f6e 273a 204e 6f6e  'exception': Non
+00004ab0: 652c 2027 636f 6d70 6c65 7465 6427 3a20  e, 'completed': 
+00004ac0: 4661 6c73 657d 2029 0a3e 3e20 2020 6669  False} ).>>   fi
+00004ad0: 6e69 7368 6564 3a20 4e6f 6465 2872 6177  nished: Node(raw
+00004ae0: 5f64 6174 615f 7369 6e67 6c65 5f73 6f75  _data_single_sou
+00004af0: 7263 653a 207b 2773 7461 7465 273a 2027  rce: {'state': '
+00004b00: 5355 4343 4553 5327 2c20 2772 6573 756c  SUCCESS', 'resul
+00004b10: 7427 3a20 5b44 6174 6146 7261 6d65 5b69  t': [DataFrame[i
+00004b20: 643a 2062 6967 696e 745d 5d2c 2027 6578  d: bigint]], 'ex
+00004b30: 6365 7074 696f 6e27 3a20 4e6f 6e65 2c20  ception': None, 
+00004b40: 2763 6f6d 706c 6574 6564 273a 2054 7275  'completed': Tru
+00004b50: 657d 2029 2028 7374 696c 6c20 7275 6e6e  e} ) (still runn
+00004b60: 696e 673a 2032 290a 3e3e 2020 2066 696e  ing: 2).>>   fin
+00004b70: 6973 6865 643a 204e 6f64 6528 7261 775f  ished: Node(raw_
+00004b80: 6461 7461 5f73 696e 676c 655f 736f 7572  data_single_sour
+00004b90: 6365 5f77 6974 685f 6375 7374 6f6d 5f6e  ce_with_custom_n
+00004ba0: 616d 653a 207b 2773 7461 7465 273a 2027  ame: {'state': '
+00004bb0: 5355 4343 4553 5327 2c20 2772 6573 756c  SUCCESS', 'resul
+00004bc0: 7427 3a20 5b44 6174 6146 7261 6d65 5b69  t': [DataFrame[i
+00004bd0: 643a 2062 6967 696e 745d 5d2c 2027 6578  d: bigint]], 'ex
+00004be0: 6365 7074 696f 6e27 3a20 4e6f 6e65 2c20  ception': None, 
+00004bf0: 2763 6f6d 706c 6574 6564 273a 2054 7275  'completed': Tru
+00004c00: 657d 2029 2028 7374 696c 6c20 7275 6e6e  e} ) (still runn
+00004c10: 696e 673a 2031 290a 3e3e 2020 2073 7461  ing: 1).>>   sta
+00004c20: 7274 696e 673a 204e 6f64 6528 636f 6d62  rting: Node(comb
+00004c30: 696e 655f 6461 7461 3a20 7b27 7374 6174  ine_data: {'stat
+00004c40: 6527 3a20 2752 554e 4e49 4e47 272c 2027  e': 'RUNNING', '
+00004c50: 7265 7375 6c74 273a 204e 6f6e 652c 2027  result': None, '
+00004c60: 6578 6365 7074 696f 6e27 3a20 4e6f 6e65  exception': None
+00004c70: 2c20 2763 6f6d 706c 6574 6564 273a 2046  , 'completed': F
+00004c80: 616c 7365 7d20 290a 3e3e 2020 2066 696e  alse} ).>>   fin
+00004c90: 6973 6865 643a 204e 6f64 6528 7261 775f  ished: Node(raw_
+00004ca0: 6461 7461 5f6d 756c 7469 5f73 6f75 7263  data_multi_sourc
+00004cb0: 653a 207b 2773 7461 7465 273a 2027 5355  e: {'state': 'SU
+00004cc0: 4343 4553 5327 2c20 2772 6573 756c 7427  CCESS', 'result'
+00004cd0: 3a20 5b44 6174 6146 7261 6d65 5b69 643a  : [DataFrame[id:
+00004ce0: 2062 6967 696e 745d 2c20 4461 7461 4672   bigint], DataFr
+00004cf0: 616d 655b 6964 3a20 6269 6769 6e74 5d5d  ame[id: bigint]]
+00004d00: 2c20 2765 7863 6570 7469 6f6e 273a 204e  , 'exception': N
+00004d10: 6f6e 652c 2027 636f 6d70 6c65 7465 6427  one, 'completed'
+00004d20: 3a20 5472 7565 7d20 2920 2873 7469 6c6c  : True} ) (still
+00004d30: 2072 756e 6e69 6e67 3a20 3129 0a3e 3e20   running: 1).>> 
+00004d40: 2020 7374 6172 7469 6e67 3a20 4e6f 6465    starting: Node
+00004d50: 2873 706c 6974 5f64 6174 613a 207b 2773  (split_data: {'s
+00004d60: 7461 7465 273a 2027 5255 4e4e 494e 4727  tate': 'RUNNING'
+00004d70: 2c20 2772 6573 756c 7427 3a20 4e6f 6e65  , 'result': None
+00004d80: 2c20 2765 7863 6570 7469 6f6e 273a 204e  , 'exception': N
+00004d90: 6f6e 652c 2027 636f 6d70 6c65 7465 6427  one, 'completed'
+00004da0: 3a20 4661 6c73 657d 2029 0a3e 3e20 2020  : False} ).>>   
+00004db0: 6669 6e69 7368 6564 3a20 4e6f 6465 2863  finished: Node(c
+00004dc0: 6f6d 6269 6e65 5f64 6174 613a 207b 2773  ombine_data: {'s
+00004dd0: 7461 7465 273a 2027 5355 4343 4553 5327  tate': 'SUCCESS'
+00004de0: 2c20 2772 6573 756c 7427 3a20 5b44 6174  , 'result': [Dat
+00004df0: 6146 7261 6d65 5b69 643a 2062 6967 696e  aFrame[id: bigin
+00004e00: 745d 5d2c 2027 6578 6365 7074 696f 6e27  t]], 'exception'
+00004e10: 3a20 4e6f 6e65 2c20 2763 6f6d 706c 6574  : None, 'complet
+00004e20: 6564 273a 2054 7275 657d 2029 2028 7374  ed': True} ) (st
+00004e30: 696c 6c20 7275 6e6e 696e 673a 2031 290a  ill running: 1).
+00004e40: 3e3e 2020 2066 696e 6973 6865 643a 204e  >>   finished: N
+00004e50: 6f64 6528 7370 6c69 745f 6461 7461 3a20  ode(split_data: 
+00004e60: 7b27 7374 6174 6527 3a20 2753 5543 4345  {'state': 'SUCCE
+00004e70: 5353 272c 2027 7265 7375 6c74 273a 205b  SS', 'result': [
+00004e80: 4461 7461 4672 616d 655b 6964 3a20 6269  DataFrame[id: bi
+00004e90: 6769 6e74 5d2c 2044 6174 6146 7261 6d65  gint], DataFrame
+00004ea0: 5b69 643a 2062 6967 696e 745d 5d2c 2027  [id: bigint]], '
+00004eb0: 6578 6365 7074 696f 6e27 3a20 4e6f 6e65  exception': None
+00004ec0: 2c20 2763 6f6d 706c 6574 6564 273a 2054  , 'completed': T
+00004ed0: 7275 657d 2029 2028 7374 696c 6c20 7275  rue} ) (still ru
+00004ee0: 6e6e 696e 673a 2030 290a 3e3e 2041 6c6c  nning: 0).>> All
+00004ef0: 2074 6173 6b73 2066 696e 6973 6865 642c   tasks finished,
+00004f00: 2073 6875 7474 696e 6720 646f 776e 0a3e   shutting down.>
+00004f10: 3e20 7069 7065 6c69 6e65 2072 6573 756c  > pipeline resul
+00004f20: 7473 3a0a 3e3e 205b 7261 775f 6461 7461  ts:.>> [raw_data
+00004f30: 5f73 696e 676c 655f 736f 7572 6365 2c20  _single_source, 
+00004f40: 7261 775f 6461 7461 5f73 696e 676c 655f  raw_data_single_
+00004f50: 736f 7572 6365 5f77 6974 685f 6375 7374  source_with_cust
+00004f60: 6f6d 5f6e 616d 652c 2072 6177 5f64 6174  om_name, raw_dat
+00004f70: 615f 6d75 6c74 695f 736f 7572 6365 2c20  a_multi_source, 
+00004f80: 636f 6d62 696e 655f 6461 7461 2c20 7370  combine_data, sp
+00004f90: 6c69 745f 6461 7461 5d0a 3e3e 2065 7665  lit_data].>> eve
+00004fa0: 6e20 6e75 6d62 6572 733a 0a3e 3e20 5b52  n numbers:.>> [R
+00004fb0: 6f77 2869 643d 3229 2c20 526f 7728 6964  ow(id=2), Row(id
+00004fc0: 3d34 292c 2052 6f77 2869 643d 3629 2c20  =4), Row(id=6), 
+00004fd0: 526f 7728 6964 3d38 292c 2052 6f77 2869  Row(id=8), Row(i
+00004fe0: 643d 3130 3029 2c20 526f 7728 6964 3d31  d=100), Row(id=1
+00004ff0: 3032 292c 2052 6f77 2869 643d 3130 3429  02), Row(id=104)
+00005000: 2c20 526f 7728 6964 3d31 3036 292c 2052  , Row(id=106), R
+00005010: 6f77 2869 643d 3130 3829 2c20 526f 7728  ow(id=108), Row(
+00005020: 6964 3d31 3030 3029 5d0a 3e3e 206f 6464  id=1000)].>> odd
+00005030: 206e 756d 6265 7273 3a0a 3e3e 205b 526f   numbers:.>> [Ro
+00005040: 7728 6964 3d31 292c 2052 6f77 2869 643d  w(id=1), Row(id=
+00005050: 3329 2c20 526f 7728 6964 3d35 292c 2052  3), Row(id=5), R
+00005060: 6f77 2869 643d 3729 2c20 526f 7728 6964  ow(id=7), Row(id
+00005070: 3d39 292c 2052 6f77 2869 643d 3130 3129  =9), Row(id=101)
+00005080: 2c20 526f 7728 6964 3d31 3033 292c 2052  , Row(id=103), R
+00005090: 6f77 2869 643d 3130 3529 2c20 526f 7728  ow(id=105), Row(
+000050a0: 6964 3d31 3037 292c 2052 6f77 2869 643d  id=107), Row(id=
+000050b0: 3130 3929 5d0a 6060 600a 0a70 6970 656c  109)].```..pipel
+000050c0: 696e 6520 7374 6570 7320 6172 6520 7265  ine steps are re
+000050d0: 7275 6e61 626c 6520 6173 2061 6e79 206f  runable as any o
+000050e0: 7264 696e 6172 7920 6675 6e63 7469 6f6e  rdinary function
+000050f0: 3a0a 6060 6070 7974 686f 6e0a 2320 746f  :.```python.# to
+00005100: 2072 6572 756e 2067 6976 656e 2073 7465   rerun given ste
+00005110: 702c 206a 7573 7420 6578 6563 7574 6520  p, just execute 
+00005120: 6974 2061 7320 6966 2069 7420 7761 7320  it as if it was 
+00005130: 6120 7075 7265 2066 756e 6374 696f 6e0a  a pure function.
+00005140: 2320 7265 7475 726e 2069 7320 616c 6177  # return is alaw
+00005150: 6179 7320 6120 6c69 7374 206f 6620 6461  ays a list of da
+00005160: 7461 6672 616d 7320 7468 6174 2067 6976  taframs that giv
+00005170: 656e 2040 7070 6e2e 7374 6570 2072 6574  en @ppn.step ret
+00005180: 7572 6e73 0a23 206e 6f74 653a 2074 6865  urns.# note: the
+00005190: 2073 7061 726b 2076 6965 7720 2772 6177   spark view 'raw
+000051a0: 5f64 6174 615f 7369 6e67 6c65 5f73 6f75  _data_single_sou
+000051b0: 7263 6527 2077 696c 6c20 6265 2075 7064  rce' will be upd
+000051c0: 6174 6564 2077 6865 6e20 7468 6973 2066  ated when this f
+000051d0: 756e 6374 696f 6e20 6669 6e69 7368 6573  unction finishes
+000051e0: 2028 6173 2070 6572 2064 6566 696e 7469   (as per definti
+000051f0: 6f6e 2069 6e20 4070 706e 2e73 7465 7020  on in @ppn.step 
+00005200: 6162 6f76 6529 0a72 6177 5f64 6174 615f  above).raw_data_
+00005210: 7369 6e67 6c65 5f73 6f75 7263 6528 290a  single_source().
+00005220: 6060 600a                                ```.
```

### Comparing `bdq-0.0.1/README.md` & `bdq-0.0.2/README.md`

 * *Files 2% similar despite different names*

```diff
@@ -799,463 +799,479 @@
 000031e0: 6772 6170 682e 6e6f 6465 2864 6570 656e  graph.node(depen
 000031f0: 6473 5f6f 6e3d 5b67 5d29 0a64 6566 2069  ds_on=[g]).def i
 00003200: 2829 3a0a 2020 7072 696e 7428 2274 6869  ():.  print("thi
 00003210: 7320 7769 6c6c 206e 6576 6572 2065 7865  s will never exe
 00003220: 6375 7465 2074 6f6f 2229 0a20 2072 6574  cute too").  ret
 00003230: 7572 6e20 2274 6869 7320 7769 6c6c 206e  urn "this will n
 00003240: 6576 6572 2065 7865 6375 7465 2074 6f6f  ever execute too
-00003250: 220a 0a23 6578 6563 7574 6520 4441 470a  "..#execute DAG.
-00003260: 6772 6170 682e 6578 6563 7574 6528 6d61  graph.execute(ma
-00003270: 785f 776f 726b 6572 733d 3130 290a 0a23  x_workers=10)..#
-00003280: 6974 6572 6174 6520 6f76 6572 2072 6573  iterate over res
-00003290: 756c 7473 0a70 7269 6e74 2822 4974 6572  ults.print("Iter
-000032a0: 6174 6520 6f76 6572 2072 6573 756c 7473  ate over results
-000032b0: 2e2e 2e22 290a 666f 7220 6e6f 6465 2069  ...").for node i
-000032c0: 6e20 6772 6170 682e 6e6f 6465 733a 0a20  n graph.nodes:. 
-000032d0: 2070 7269 6e74 286e 6f64 6529 0a0a 3e3e   print(node)..>>
-000032e0: 2057 6169 7469 6e67 2066 6f72 2061 6c6c   Waiting for all
-000032f0: 2074 6173 6b73 2074 6f20 6669 6e69 7368   tasks to finish
-00003300: 2e2e 2e0a 3e3e 2020 2073 7461 7274 696e  ....>>   startin
-00003310: 673a 204e 6f64 6528 3c66 756e 6374 696f  g: Node(<functio
-00003320: 6e20 6120 6174 2030 7837 6635 3066 3462  n a at 0x7f50f4b
-00003330: 3965 6535 303e 3a20 7b27 7374 6174 6527  9ee50>: {'state'
-00003340: 3a20 2752 554e 4e49 4e47 272c 2027 7265  : 'RUNNING', 're
-00003350: 7375 6c74 273a 204e 6f6e 652c 2027 6578  sult': None, 'ex
-00003360: 6365 7074 696f 6e27 3a20 4e6f 6e65 2c20  ception': None, 
-00003370: 2763 6f6d 706c 6574 6564 273a 2046 616c  'completed': Fal
-00003380: 7365 7d20 290a 3e3e 2020 2073 7461 7274  se} ).>>   start
-00003390: 696e 673a 204e 6f64 6528 3c66 756e 6374  ing: Node(<funct
-000033a0: 696f 6e20 6220 6174 2030 7837 6635 3066  ion b at 0x7f50f
-000033b0: 3462 3533 3034 303e 3a20 7b27 7374 6174  4b53040>: {'stat
-000033c0: 6527 3a20 2752 554e 4e49 4e47 272c 2027  e': 'RUNNING', '
-000033d0: 7265 7375 6c74 273a 204e 6f6e 652c 2027  result': None, '
-000033e0: 6578 6365 7074 696f 6e27 3a20 4e6f 6e65  exception': None
-000033f0: 2c20 2763 6f6d 706c 6574 6564 273a 2046  , 'completed': F
-00003400: 616c 7365 7d20 290a 3e3e 2020 2073 7461  alse} ).>>   sta
-00003410: 7274 696e 673a 204e 6f64 6528 3c66 756e  rting: Node(<fun
-00003420: 6374 696f 6e20 6520 6174 2030 7837 6635  ction e at 0x7f5
-00003430: 3066 3462 3533 6238 303e 3a20 7b27 7374  0f4b53b80>: {'st
-00003440: 6174 6527 3a20 2752 554e 4e49 4e47 272c  ate': 'RUNNING',
-00003450: 2027 7265 7375 6c74 273a 204e 6f6e 652c   'result': None,
-00003460: 2027 6578 6365 7074 696f 6e27 3a20 4e6f   'exception': No
-00003470: 6e65 2c20 2763 6f6d 706c 6574 6564 273a  ne, 'completed':
-00003480: 2046 616c 7365 7d20 290a 3e3e 2020 2073   False} ).>>   s
-00003490: 7461 7274 696e 673a 204e 6f64 6528 3c66  tarting: Node(<f
-000034a0: 756e 6374 696f 6e20 6720 6174 2030 7837  unction g at 0x7
-000034b0: 6635 3066 3462 3533 3565 303e 3a20 7b27  f50f4b535e0>: {'
-000034c0: 7374 6174 6527 3a20 2752 554e 4e49 4e47  state': 'RUNNING
-000034d0: 272c 2027 7265 7375 6c74 273a 204e 6f6e  ', 'result': Non
-000034e0: 652c 2027 6578 6365 7074 696f 6e27 3a20  e, 'exception': 
-000034f0: 4e6f 6e65 2c20 2763 6f6d 706c 6574 6564  None, 'completed
-00003500: 273a 2046 616c 7365 7d20 290a 3e3e 2020  ': False} ).>>  
-00003510: 2066 696e 6973 6865 643a 204e 6f64 6528   finished: Node(
-00003520: 3c66 756e 6374 696f 6e20 6120 6174 2030  <function a at 0
-00003530: 7837 6635 3066 3462 3965 6535 303e 3a20  x7f50f4b9ee50>: 
-00003540: 7b27 7374 6174 6527 3a20 2753 5543 4345  {'state': 'SUCCE
-00003550: 5353 272c 2027 7265 7375 6c74 273a 2035  SS', 'result': 5
-00003560: 2c20 2765 7863 6570 7469 6f6e 273a 204e  , 'exception': N
-00003570: 6f6e 652c 2027 636f 6d70 6c65 7465 6427  one, 'completed'
-00003580: 3a20 5472 7565 7d20 2920 2873 7469 6c6c  : True} ) (still
-00003590: 2072 756e 6e69 6e67 3a20 3329 0a3e 3e20   running: 3).>> 
-000035a0: 2020 7374 6172 7469 6e67 3a20 4e6f 6465    starting: Node
-000035b0: 283c 6675 6e63 7469 6f6e 2063 2061 7420  (<function c at 
-000035c0: 3078 3766 3530 6634 6235 3334 6330 3e3a  0x7f50f4b534c0>:
-000035d0: 207b 2773 7461 7465 273a 2027 5255 4e4e   {'state': 'RUNN
-000035e0: 494e 4727 2c20 2772 6573 756c 7427 3a20  ING', 'result': 
-000035f0: 4e6f 6e65 2c20 2765 7863 6570 7469 6f6e  None, 'exception
-00003600: 273a 204e 6f6e 652c 2027 636f 6d70 6c65  ': None, 'comple
-00003610: 7465 6427 3a20 4661 6c73 657d 2029 0a3e  ted': False} ).>
-00003620: 3e20 2020 6669 6e69 7368 6564 3a20 4e6f  >   finished: No
-00003630: 6465 283c 6675 6e63 7469 6f6e 2062 2061  de(<function b a
-00003640: 7420 3078 3766 3530 6634 6235 3330 3430  t 0x7f50f4b53040
-00003650: 3e3a 207b 2773 7461 7465 273a 2027 5355  >: {'state': 'SU
-00003660: 4343 4553 5327 2c20 2772 6573 756c 7427  CCESS', 'result'
-00003670: 3a20 2762 6565 6570 272c 2027 6578 6365  : 'beeep', 'exce
-00003680: 7074 696f 6e27 3a20 4e6f 6e65 2c20 2763  ption': None, 'c
-00003690: 6f6d 706c 6574 6564 273a 2054 7275 657d  ompleted': True}
-000036a0: 2029 2028 7374 696c 6c20 7275 6e6e 696e   ) (still runnin
-000036b0: 673a 2033 290a 3e3e 2020 2065 7272 6f72  g: 3).>>   error
-000036c0: 3a20 4e6f 6465 283c 6675 6e63 7469 6f6e  : Node(<function
-000036d0: 2065 2061 7420 3078 3766 3530 6634 6235   e at 0x7f50f4b5
-000036e0: 3362 3830 3e3a 207b 2773 7461 7465 273a  3b80>: {'state':
-000036f0: 2027 4552 524f 5227 2c20 2772 6573 756c   'ERROR', 'resul
-00003700: 7427 3a20 4e6f 6e65 2c20 2765 7863 6570  t': None, 'excep
-00003710: 7469 6f6e 273a 2056 616c 7565 4572 726f  tion': ValueErro
-00003720: 7228 276f 6d67 2c20 6372 6173 6821 2035  r('omg, crash! 5
-00003730: 2729 2c20 2763 6f6d 706c 6574 6564 273a  '), 'completed':
-00003740: 2054 7275 657d 2029 3a20 6f6d 672c 2063   True} ): omg, c
-00003750: 7261 7368 2120 3520 2873 7469 6c6c 2072  rash! 5 (still r
-00003760: 756e 6e69 6e67 3a20 3229 0a3e 3e20 2020  unning: 2).>>   
-00003770: 6669 6e69 7368 6564 3a20 4e6f 6465 283c  finished: Node(<
-00003780: 6675 6e63 7469 6f6e 2067 2061 7420 3078  function g at 0x
-00003790: 3766 3530 6634 6235 3335 6530 3e3a 207b  7f50f4b535e0>: {
-000037a0: 2773 7461 7465 273a 2027 534b 4950 5045  'state': 'SKIPPE
-000037b0: 4427 2c20 2772 6573 756c 7427 3a20 3c74  D', 'result': <t
-000037c0: 6872 6561 6469 6e67 2e45 7665 6e74 206f  hreading.Event o
-000037d0: 626a 6563 7420 6174 2030 7837 6635 3065  bject at 0x7f50e
-000037e0: 6331 3663 3964 303e 2c20 2765 7863 6570  c16c9d0>, 'excep
-000037f0: 7469 6f6e 273a 204e 6f6e 652c 2027 636f  tion': None, 'co
-00003800: 6d70 6c65 7465 6427 3a20 5472 7565 7d20  mpleted': True} 
-00003810: 2920 2873 7469 6c6c 2072 756e 6e69 6e67  ) (still running
-00003820: 3a20 3129 0a3e 3e20 2020 7374 6172 7469  : 1).>>   starti
-00003830: 6e67 3a20 4e6f 6465 283c 6675 6e63 7469  ng: Node(<functi
-00003840: 6f6e 2064 2061 7420 3078 3766 3530 6634  on d at 0x7f50f4
-00003850: 6235 3361 3630 3e3a 207b 2773 7461 7465  b53a60>: {'state
-00003860: 273a 2027 5255 4e4e 494e 4727 2c20 2772  ': 'RUNNING', 'r
-00003870: 6573 756c 7427 3a20 4e6f 6e65 2c20 2765  esult': None, 'e
-00003880: 7863 6570 7469 6f6e 273a 204e 6f6e 652c  xception': None,
-00003890: 2027 636f 6d70 6c65 7465 6427 3a20 4661   'completed': Fa
-000038a0: 6c73 657d 2029 0a3e 3e20 2020 6669 6e69  lse} ).>>   fini
-000038b0: 7368 6564 3a20 4e6f 6465 283c 6675 6e63  shed: Node(<func
-000038c0: 7469 6f6e 2063 2061 7420 3078 3766 3530  tion c at 0x7f50
-000038d0: 6634 6235 3334 6330 3e3a 207b 2773 7461  f4b534c0>: {'sta
-000038e0: 7465 273a 2027 5355 4343 4553 5327 2c20  te': 'SUCCESS', 
-000038f0: 2772 6573 756c 7427 3a20 382c 2027 6578  'result': 8, 'ex
-00003900: 6365 7074 696f 6e27 3a20 4e6f 6e65 2c20  ception': None, 
-00003910: 2763 6f6d 706c 6574 6564 273a 2054 7275  'completed': Tru
-00003920: 657d 2029 2028 7374 696c 6c20 7275 6e6e  e} ) (still runn
-00003930: 696e 673a 2031 290a 3e3e 2020 2066 696e  ing: 1).>>   fin
-00003940: 6973 6865 643a 204e 6f64 6528 3c66 756e  ished: Node(<fun
-00003950: 6374 696f 6e20 6420 6174 2030 7837 6635  ction d at 0x7f5
-00003960: 3066 3462 3533 6136 303e 3a20 7b27 7374  0f4b53a60>: {'st
-00003970: 6174 6527 3a20 2753 5543 4345 5353 272c  ate': 'SUCCESS',
-00003980: 2027 7265 7375 6c74 273a 2027 6720 6d61   'result': 'g ma
-00003990: 6e20 7361 793a 2062 6565 6570 6265 6565  n say: beeepbeee
-000039a0: 7062 6565 6570 272c 2027 6578 6365 7074  pbeeep', 'except
-000039b0: 696f 6e27 3a20 4e6f 6e65 2c20 2763 6f6d  ion': None, 'com
-000039c0: 706c 6574 6564 273a 2054 7275 657d 2029  pleted': True} )
-000039d0: 2028 7374 696c 6c20 7275 6e6e 696e 673a   (still running:
-000039e0: 2030 290a 3e3e 2041 6c6c 2074 6173 6b73   0).>> All tasks
-000039f0: 2066 696e 6973 6865 642c 2073 6875 7474   finished, shutt
-00003a00: 696e 6720 646f 776e 0a3e 3e0a 3e3e 2049  ing down.>>.>> I
-00003a10: 7465 7261 7465 206f 7665 7220 7265 7375  terate over resu
-00003a20: 6c74 732e 2e2e 0a3e 3e20 4e6f 6465 283c  lts....>> Node(<
-00003a30: 6675 6e63 7469 6f6e 2061 2061 7420 3078  function a at 0x
-00003a40: 3766 3530 6634 6239 6565 3530 3e3a 207b  7f50f4b9ee50>: {
-00003a50: 2773 7461 7465 273a 2027 5355 4343 4553  'state': 'SUCCES
-00003a60: 5327 2c20 2772 6573 756c 7427 3a20 352c  S', 'result': 5,
-00003a70: 2027 6578 6365 7074 696f 6e27 3a20 4e6f   'exception': No
-00003a80: 6e65 2c20 2763 6f6d 706c 6574 6564 273a  ne, 'completed':
-00003a90: 2054 7275 657d 2029 0a3e 3e20 4e6f 6465   True} ).>> Node
-00003aa0: 283c 6675 6e63 7469 6f6e 2062 2061 7420  (<function b at 
-00003ab0: 3078 3766 3530 6634 6235 3330 3430 3e3a  0x7f50f4b53040>:
-00003ac0: 207b 2773 7461 7465 273a 2027 5355 4343   {'state': 'SUCC
-00003ad0: 4553 5327 2c20 2772 6573 756c 7427 3a20  ESS', 'result': 
-00003ae0: 2762 6565 6570 272c 2027 6578 6365 7074  'beeep', 'except
-00003af0: 696f 6e27 3a20 4e6f 6e65 2c20 2763 6f6d  ion': None, 'com
-00003b00: 706c 6574 6564 273a 2054 7275 657d 2029  pleted': True} )
-00003b10: 0a3e 3e20 4e6f 6465 283c 6675 6e63 7469  .>> Node(<functi
-00003b20: 6f6e 2063 2061 7420 3078 3766 3530 6634  on c at 0x7f50f4
-00003b30: 6235 3334 6330 3e3a 207b 2773 7461 7465  b534c0>: {'state
-00003b40: 273a 2027 5355 4343 4553 5327 2c20 2772  ': 'SUCCESS', 'r
-00003b50: 6573 756c 7427 3a20 382c 2027 6578 6365  esult': 8, 'exce
-00003b60: 7074 696f 6e27 3a20 4e6f 6e65 2c20 2763  ption': None, 'c
-00003b70: 6f6d 706c 6574 6564 273a 2054 7275 657d  ompleted': True}
-00003b80: 2029 0a3e 3e20 4e6f 6465 283c 6675 6e63   ).>> Node(<func
-00003b90: 7469 6f6e 2064 2061 7420 3078 3766 3530  tion d at 0x7f50
-00003ba0: 6634 6235 3361 3630 3e3a 207b 2773 7461  f4b53a60>: {'sta
-00003bb0: 7465 273a 2027 5355 4343 4553 5327 2c20  te': 'SUCCESS', 
-00003bc0: 2772 6573 756c 7427 3a20 2767 206d 616e  'result': 'g man
-00003bd0: 2073 6179 3a20 6265 6565 7062 6565 6570   say: beeepbeeep
-00003be0: 6265 6565 7027 2c20 2765 7863 6570 7469  beeep', 'excepti
-00003bf0: 6f6e 273a 204e 6f6e 652c 2027 636f 6d70  on': None, 'comp
-00003c00: 6c65 7465 6427 3a20 5472 7565 7d20 290a  leted': True} ).
-00003c10: 3e3e 204e 6f64 6528 3c66 756e 6374 696f  >> Node(<functio
-00003c20: 6e20 6520 6174 2030 7837 6635 3066 3462  n e at 0x7f50f4b
-00003c30: 3533 6238 303e 3a20 7b27 7374 6174 6527  53b80>: {'state'
-00003c40: 3a20 2745 5252 4f52 272c 2027 7265 7375  : 'ERROR', 'resu
-00003c50: 6c74 273a 204e 6f6e 652c 2027 6578 6365  lt': None, 'exce
-00003c60: 7074 696f 6e27 3a20 5661 6c75 6545 7272  ption': ValueErr
-00003c70: 6f72 2827 6f6d 672c 2063 7261 7368 2120  or('omg, crash! 
-00003c80: 3527 292c 2027 636f 6d70 6c65 7465 6427  5'), 'completed'
-00003c90: 3a20 5472 7565 7d20 290a 3e3e 204e 6f64  : True} ).>> Nod
-00003ca0: 6528 3c66 756e 6374 696f 6e20 6620 6174  e(<function f at
-00003cb0: 2030 7837 6635 3066 3462 3533 3064 303e   0x7f50f4b530d0>
-00003cc0: 3a20 7b27 7374 6174 6527 3a20 2753 4b49  : {'state': 'SKI
-00003cd0: 5050 4544 272c 2027 7265 7375 6c74 273a  PPED', 'result':
-00003ce0: 204e 6f6e 652c 2027 6578 6365 7074 696f   None, 'exceptio
-00003cf0: 6e27 3a20 4e6f 6e65 2c20 2763 6f6d 706c  n': None, 'compl
-00003d00: 6574 6564 273a 2046 616c 7365 7d20 290a  eted': False} ).
-00003d10: 3e3e 204e 6f64 6528 3c66 756e 6374 696f  >> Node(<functio
-00003d20: 6e20 6720 6174 2030 7837 6635 3066 3462  n g at 0x7f50f4b
-00003d30: 3533 3565 303e 3a20 7b27 7374 6174 6527  535e0>: {'state'
-00003d40: 3a20 2753 4b49 5050 4544 272c 2027 7265  : 'SKIPPED', 're
-00003d50: 7375 6c74 273a 203c 7468 7265 6164 696e  sult': <threadin
-00003d60: 672e 4576 656e 7420 6f62 6a65 6374 2061  g.Event object a
-00003d70: 7420 3078 3766 3530 6563 3136 6339 6430  t 0x7f50ec16c9d0
-00003d80: 3e2c 2027 6578 6365 7074 696f 6e27 3a20  >, 'exception': 
-00003d90: 4e6f 6e65 2c20 2763 6f6d 706c 6574 6564  None, 'completed
-00003da0: 273a 2054 7275 657d 2029 0a3e 3e20 4e6f  ': True} ).>> No
-00003db0: 6465 283c 6675 6e63 7469 6f6e 2069 2061  de(<function i a
-00003dc0: 7420 3078 3766 3530 6634 6235 3332 3830  t 0x7f50f4b53280
-00003dd0: 3e3a 207b 2773 7461 7465 273a 2027 534b  >: {'state': 'SK
-00003de0: 4950 5045 4427 2c20 2772 6573 756c 7427  IPPED', 'result'
-00003df0: 3a20 4e6f 6e65 2c20 2765 7863 6570 7469  : None, 'excepti
-00003e00: 6f6e 273a 204e 6f6e 652c 2027 636f 6d70  on': None, 'comp
-00003e10: 6c65 7465 6427 3a20 4661 6c73 657d 2029  leted': False} )
-00003e20: 0a60 6060 0a0a 2323 2045 7865 6375 7465  .```..## Execute
-00003e30: 2073 7061 726b 2070 6970 656c 696e 6520   spark pipeline 
-00003e40: 6f66 206d 756c 7469 706c 6520 7374 6570  of multiple step
-00003e50: 730a 7573 696e 6720 4441 4720 636f 6d70  s.using DAG comp
-00003e60: 6f6e 656e 7420 746f 2068 616e 646c 6520  onent to handle 
-00003e70: 7061 7261 6c6c 656c 2065 7865 6375 7469  parallel executi
-00003e80: 6f6e 0a60 6060 7079 7468 6f6e 0a69 6d70  on.```python.imp
-00003e90: 6f72 7420 6264 710a 6672 6f6d 2062 6471  ort bdq.from bdq
-00003ea0: 2069 6d70 6f72 7420 7370 6172 6b2c 2074   import spark, t
-00003eb0: 6162 6c65 0a0a 7070 6e20 3d20 6264 712e  able..ppn = bdq.
-00003ec0: 5370 6172 6b50 6970 656c 696e 6528 7370  SparkPipeline(sp
-00003ed0: 6172 6b2c 2022 7265 7461 696c 2229 0a0a  ark, "retail")..
-00003ee0: 2320 7265 7475 726e 7320 6461 7461 6672  # returns datafr
-00003ef0: 616d 652c 2061 6e64 2063 7265 6174 6573  ame, and creates
-00003f00: 2073 7061 726b 2076 6965 7720 2772 6177   spark view 'raw
-00003f10: 5f64 6174 615f 7369 6e67 6c65 5f73 6f75  _data_single_sou
-00003f20: 7263 6527 0a40 7070 6e2e 7374 6570 2829  rce'.@ppn.step()
-00003f30: 0a64 6566 2072 6177 5f64 6174 615f 7369  .def raw_data_si
-00003f40: 6e67 6c65 5f73 6f75 7263 6528 7029 3a0a  ngle_source(p):.
-00003f50: 2020 7265 7475 726e 2073 7061 726b 2e72    return spark.r
-00003f60: 616e 6765 2831 2c20 3130 290a 0a23 2072  ange(1, 10)..# r
-00003f70: 6574 7572 6e73 2064 6174 6166 7261 6d65  eturns dataframe
-00003f80: 2c20 616e 6420 6372 6561 7465 7320 7370  , and creates sp
-00003f90: 6172 6b20 7669 6577 2027 7261 775f 6e69  ark view 'raw_ni
-00003fa0: 6365 5f6e 616d 6527 0a40 7070 6e2e 7374  ce_name'.@ppn.st
-00003fb0: 6570 2872 6574 7572 6e73 3d5b 2272 6177  ep(returns=["raw
-00003fc0: 5f6e 6963 655f 6e61 6d65 225d 290a 6465  _nice_name"]).de
-00003fd0: 6620 7261 775f 6461 7461 5f73 696e 676c  f raw_data_singl
-00003fe0: 655f 736f 7572 6365 5f77 6974 685f 6375  e_source_with_cu
-00003ff0: 7374 6f6d 5f6e 616d 6528 7029 3a0a 2020  stom_name(p):.  
-00004000: 7265 7475 726e 2073 7061 726b 2e72 616e  return spark.ran
-00004010: 6765 2831 3030 2c20 3131 3029 0a0a 2320  ge(100, 110)..# 
-00004020: 7265 7475 726e 7320 7477 6f20 6461 7461  returns two data
-00004030: 6672 616d 6573 2c20 616e 6420 6372 6561  frames, and crea
-00004040: 7465 7320 7477 6f20 7370 6172 6b20 7669  tes two spark vi
-00004050: 6577 7320 2772 6177 5f64 6174 6131 272c  ews 'raw_data1',
-00004060: 2027 7261 775f 6461 7461 3227 0a40 7070   'raw_data2'.@pp
-00004070: 6e2e 7374 6570 2872 6574 7572 6e73 3d5b  n.step(returns=[
-00004080: 2272 6177 5f64 6174 6131 222c 2022 7261  "raw_data1", "ra
-00004090: 775f 6461 7461 3222 5d29 0a64 6566 2072  w_data2"]).def r
-000040a0: 6177 5f64 6174 615f 6d75 6c74 695f 736f  aw_data_multi_so
-000040b0: 7572 6365 2870 293a 0a20 2064 6631 203d  urce(p):.  df1 =
-000040c0: 2073 7061 726b 2e72 616e 6765 2831 3030   spark.range(100
-000040d0: 302c 2032 3030 3029 0a20 2064 6632 203d  0, 2000).  df2 =
-000040e0: 2073 7061 726b 2e72 616e 6765 2832 3030   spark.range(200
-000040f0: 302c 2033 3030 3029 0a0a 2020 7265 7475  0, 3000)..  retu
-00004100: 726e 205b 6466 312c 2064 6632 5d0a 0a23  rn [df1, df2]..#
-00004110: 2077 6169 7473 2066 6f72 2072 6177 2064   waits for raw d
-00004120: 6174 6120 736f 7572 6365 7320 746f 2066  ata sources to f
-00004130: 696e 6973 682c 2061 6e64 2063 6f6d 6269  inish, and combi
-00004140: 6e65 7320 7468 6520 6461 7461 2069 6e74  nes the data int
-00004150: 6f20 6f6e 6520 756e 696f 6e65 6420 7669  o one unioned vi
-00004160: 6577 2060 636f 6d62 696e 655f 6461 7461  ew `combine_data
-00004170: 600a 2320 6e6f 7465 2074 6861 7420 6465  `.# note that de
-00004180: 7065 6e64 656e 6369 6573 2061 7265 2070  pendencies are p
-00004190: 7974 686f 6e20 6675 6e63 7469 6f6e 732c  ython functions,
-000041a0: 206e 6f74 206e 616d 6573 206f 6620 7669   not names of vi
-000041b0: 6577 7320 2854 4f44 4f3a 2074 6f20 6861  ews (TODO: to ha
-000041c0: 6e64 6c65 2076 6965 7720 6e61 6d65 7320  ndle view names 
-000041d0: 6173 2077 656c 6c29 0a40 7070 6e2e 7374  as well).@ppn.st
-000041e0: 6570 2864 6570 656e 6473 5f6f 6e3d 5b72  ep(depends_on=[r
-000041f0: 6177 5f64 6174 615f 7369 6e67 6c65 5f73  aw_data_single_s
-00004200: 6f75 7263 652c 2072 6177 5f64 6174 615f  ource, raw_data_
-00004210: 7369 6e67 6c65 5f73 6f75 7263 655f 7769  single_source_wi
-00004220: 7468 5f63 7573 746f 6d5f 6e61 6d65 2c20  th_custom_name, 
-00004230: 7261 775f 6461 7461 5f6d 756c 7469 5f73  raw_data_multi_s
-00004240: 6f75 7263 655d 290a 6465 6620 636f 6d62  ource]).def comb
-00004250: 696e 655f 6461 7461 2870 293a 0a20 2064  ine_data(p):.  d
-00004260: 6620 3d20 7461 626c 6528 2772 6177 5f64  f = table('raw_d
+00003250: 220a 0a23 2069 6620 796f 7520 6861 7665  "..# if you have
+00003260: 2069 7079 6461 6772 6564 3320 696e 7374   ipydagred3 inst
+00003270: 616c 6c65 642c 2079 6f75 2063 616e 2073  alled, you can s
+00003280: 6565 2069 6e20 7265 616c 2074 696d 6520  ee in real time 
+00003290: 7374 6174 6520 6368 616e 6765 7320 6f66  state changes of
+000032a0: 2065 6163 6820 6f66 2074 6865 206e 6f64   each of the nod
+000032b0: 6573 0a64 6973 706c 6179 2867 7261 7068  es.display(graph
+000032c0: 2e76 6973 7561 6c69 7a65 2829 290a 0a23  .visualize())..#
+000032d0: 6578 6563 7574 6520 4441 470a 6772 6170  execute DAG.grap
+000032e0: 682e 6578 6563 7574 6528 6d61 785f 776f  h.execute(max_wo
+000032f0: 726b 6572 733d 3130 290a 0a23 6974 6572  rkers=10)..#iter
+00003300: 6174 6520 6f76 6572 2072 6573 756c 7473  ate over results
+00003310: 0a70 7269 6e74 2822 4974 6572 6174 6520  .print("Iterate 
+00003320: 6f76 6572 2072 6573 756c 7473 2e2e 2e22  over results..."
+00003330: 290a 666f 7220 6e6f 6465 2069 6e20 6772  ).for node in gr
+00003340: 6170 682e 6e6f 6465 733a 0a20 2070 7269  aph.nodes:.  pri
+00003350: 6e74 286e 6f64 6529 0a0a 3e3e 2057 6169  nt(node)..>> Wai
+00003360: 7469 6e67 2066 6f72 2061 6c6c 2074 6173  ting for all tas
+00003370: 6b73 2074 6f20 6669 6e69 7368 2e2e 2e0a  ks to finish....
+00003380: 3e3e 2020 2073 7461 7274 696e 673a 204e  >>   starting: N
+00003390: 6f64 6528 3c66 756e 6374 696f 6e20 6120  ode(<function a 
+000033a0: 6174 2030 7837 6635 3066 3462 3965 6535  at 0x7f50f4b9ee5
+000033b0: 303e 3a20 7b27 7374 6174 6527 3a20 2752  0>: {'state': 'R
+000033c0: 554e 4e49 4e47 272c 2027 7265 7375 6c74  UNNING', 'result
+000033d0: 273a 204e 6f6e 652c 2027 6578 6365 7074  ': None, 'except
+000033e0: 696f 6e27 3a20 4e6f 6e65 2c20 2763 6f6d  ion': None, 'com
+000033f0: 706c 6574 6564 273a 2046 616c 7365 7d20  pleted': False} 
+00003400: 290a 3e3e 2020 2073 7461 7274 696e 673a  ).>>   starting:
+00003410: 204e 6f64 6528 3c66 756e 6374 696f 6e20   Node(<function 
+00003420: 6220 6174 2030 7837 6635 3066 3462 3533  b at 0x7f50f4b53
+00003430: 3034 303e 3a20 7b27 7374 6174 6527 3a20  040>: {'state': 
+00003440: 2752 554e 4e49 4e47 272c 2027 7265 7375  'RUNNING', 'resu
+00003450: 6c74 273a 204e 6f6e 652c 2027 6578 6365  lt': None, 'exce
+00003460: 7074 696f 6e27 3a20 4e6f 6e65 2c20 2763  ption': None, 'c
+00003470: 6f6d 706c 6574 6564 273a 2046 616c 7365  ompleted': False
+00003480: 7d20 290a 3e3e 2020 2073 7461 7274 696e  } ).>>   startin
+00003490: 673a 204e 6f64 6528 3c66 756e 6374 696f  g: Node(<functio
+000034a0: 6e20 6520 6174 2030 7837 6635 3066 3462  n e at 0x7f50f4b
+000034b0: 3533 6238 303e 3a20 7b27 7374 6174 6527  53b80>: {'state'
+000034c0: 3a20 2752 554e 4e49 4e47 272c 2027 7265  : 'RUNNING', 're
+000034d0: 7375 6c74 273a 204e 6f6e 652c 2027 6578  sult': None, 'ex
+000034e0: 6365 7074 696f 6e27 3a20 4e6f 6e65 2c20  ception': None, 
+000034f0: 2763 6f6d 706c 6574 6564 273a 2046 616c  'completed': Fal
+00003500: 7365 7d20 290a 3e3e 2020 2073 7461 7274  se} ).>>   start
+00003510: 696e 673a 204e 6f64 6528 3c66 756e 6374  ing: Node(<funct
+00003520: 696f 6e20 6720 6174 2030 7837 6635 3066  ion g at 0x7f50f
+00003530: 3462 3533 3565 303e 3a20 7b27 7374 6174  4b535e0>: {'stat
+00003540: 6527 3a20 2752 554e 4e49 4e47 272c 2027  e': 'RUNNING', '
+00003550: 7265 7375 6c74 273a 204e 6f6e 652c 2027  result': None, '
+00003560: 6578 6365 7074 696f 6e27 3a20 4e6f 6e65  exception': None
+00003570: 2c20 2763 6f6d 706c 6574 6564 273a 2046  , 'completed': F
+00003580: 616c 7365 7d20 290a 3e3e 2020 2066 696e  alse} ).>>   fin
+00003590: 6973 6865 643a 204e 6f64 6528 3c66 756e  ished: Node(<fun
+000035a0: 6374 696f 6e20 6120 6174 2030 7837 6635  ction a at 0x7f5
+000035b0: 3066 3462 3965 6535 303e 3a20 7b27 7374  0f4b9ee50>: {'st
+000035c0: 6174 6527 3a20 2753 5543 4345 5353 272c  ate': 'SUCCESS',
+000035d0: 2027 7265 7375 6c74 273a 2035 2c20 2765   'result': 5, 'e
+000035e0: 7863 6570 7469 6f6e 273a 204e 6f6e 652c  xception': None,
+000035f0: 2027 636f 6d70 6c65 7465 6427 3a20 5472   'completed': Tr
+00003600: 7565 7d20 2920 2873 7469 6c6c 2072 756e  ue} ) (still run
+00003610: 6e69 6e67 3a20 3329 0a3e 3e20 2020 7374  ning: 3).>>   st
+00003620: 6172 7469 6e67 3a20 4e6f 6465 283c 6675  arting: Node(<fu
+00003630: 6e63 7469 6f6e 2063 2061 7420 3078 3766  nction c at 0x7f
+00003640: 3530 6634 6235 3334 6330 3e3a 207b 2773  50f4b534c0>: {'s
+00003650: 7461 7465 273a 2027 5255 4e4e 494e 4727  tate': 'RUNNING'
+00003660: 2c20 2772 6573 756c 7427 3a20 4e6f 6e65  , 'result': None
+00003670: 2c20 2765 7863 6570 7469 6f6e 273a 204e  , 'exception': N
+00003680: 6f6e 652c 2027 636f 6d70 6c65 7465 6427  one, 'completed'
+00003690: 3a20 4661 6c73 657d 2029 0a3e 3e20 2020  : False} ).>>   
+000036a0: 6669 6e69 7368 6564 3a20 4e6f 6465 283c  finished: Node(<
+000036b0: 6675 6e63 7469 6f6e 2062 2061 7420 3078  function b at 0x
+000036c0: 3766 3530 6634 6235 3330 3430 3e3a 207b  7f50f4b53040>: {
+000036d0: 2773 7461 7465 273a 2027 5355 4343 4553  'state': 'SUCCES
+000036e0: 5327 2c20 2772 6573 756c 7427 3a20 2762  S', 'result': 'b
+000036f0: 6565 6570 272c 2027 6578 6365 7074 696f  eeep', 'exceptio
+00003700: 6e27 3a20 4e6f 6e65 2c20 2763 6f6d 706c  n': None, 'compl
+00003710: 6574 6564 273a 2054 7275 657d 2029 2028  eted': True} ) (
+00003720: 7374 696c 6c20 7275 6e6e 696e 673a 2033  still running: 3
+00003730: 290a 3e3e 2020 2065 7272 6f72 3a20 4e6f  ).>>   error: No
+00003740: 6465 283c 6675 6e63 7469 6f6e 2065 2061  de(<function e a
+00003750: 7420 3078 3766 3530 6634 6235 3362 3830  t 0x7f50f4b53b80
+00003760: 3e3a 207b 2773 7461 7465 273a 2027 4552  >: {'state': 'ER
+00003770: 524f 5227 2c20 2772 6573 756c 7427 3a20  ROR', 'result': 
+00003780: 4e6f 6e65 2c20 2765 7863 6570 7469 6f6e  None, 'exception
+00003790: 273a 2056 616c 7565 4572 726f 7228 276f  ': ValueError('o
+000037a0: 6d67 2c20 6372 6173 6821 2035 2729 2c20  mg, crash! 5'), 
+000037b0: 2763 6f6d 706c 6574 6564 273a 2054 7275  'completed': Tru
+000037c0: 657d 2029 3a20 6f6d 672c 2063 7261 7368  e} ): omg, crash
+000037d0: 2120 3520 2873 7469 6c6c 2072 756e 6e69  ! 5 (still runni
+000037e0: 6e67 3a20 3229 0a3e 3e20 2020 6669 6e69  ng: 2).>>   fini
+000037f0: 7368 6564 3a20 4e6f 6465 283c 6675 6e63  shed: Node(<func
+00003800: 7469 6f6e 2067 2061 7420 3078 3766 3530  tion g at 0x7f50
+00003810: 6634 6235 3335 6530 3e3a 207b 2773 7461  f4b535e0>: {'sta
+00003820: 7465 273a 2027 534b 4950 5045 4427 2c20  te': 'SKIPPED', 
+00003830: 2772 6573 756c 7427 3a20 3c74 6872 6561  'result': <threa
+00003840: 6469 6e67 2e45 7665 6e74 206f 626a 6563  ding.Event objec
+00003850: 7420 6174 2030 7837 6635 3065 6331 3663  t at 0x7f50ec16c
+00003860: 3964 303e 2c20 2765 7863 6570 7469 6f6e  9d0>, 'exception
+00003870: 273a 204e 6f6e 652c 2027 636f 6d70 6c65  ': None, 'comple
+00003880: 7465 6427 3a20 5472 7565 7d20 2920 2873  ted': True} ) (s
+00003890: 7469 6c6c 2072 756e 6e69 6e67 3a20 3129  till running: 1)
+000038a0: 0a3e 3e20 2020 7374 6172 7469 6e67 3a20  .>>   starting: 
+000038b0: 4e6f 6465 283c 6675 6e63 7469 6f6e 2064  Node(<function d
+000038c0: 2061 7420 3078 3766 3530 6634 6235 3361   at 0x7f50f4b53a
+000038d0: 3630 3e3a 207b 2773 7461 7465 273a 2027  60>: {'state': '
+000038e0: 5255 4e4e 494e 4727 2c20 2772 6573 756c  RUNNING', 'resul
+000038f0: 7427 3a20 4e6f 6e65 2c20 2765 7863 6570  t': None, 'excep
+00003900: 7469 6f6e 273a 204e 6f6e 652c 2027 636f  tion': None, 'co
+00003910: 6d70 6c65 7465 6427 3a20 4661 6c73 657d  mpleted': False}
+00003920: 2029 0a3e 3e20 2020 6669 6e69 7368 6564   ).>>   finished
+00003930: 3a20 4e6f 6465 283c 6675 6e63 7469 6f6e  : Node(<function
+00003940: 2063 2061 7420 3078 3766 3530 6634 6235   c at 0x7f50f4b5
+00003950: 3334 6330 3e3a 207b 2773 7461 7465 273a  34c0>: {'state':
+00003960: 2027 5355 4343 4553 5327 2c20 2772 6573   'SUCCESS', 'res
+00003970: 756c 7427 3a20 382c 2027 6578 6365 7074  ult': 8, 'except
+00003980: 696f 6e27 3a20 4e6f 6e65 2c20 2763 6f6d  ion': None, 'com
+00003990: 706c 6574 6564 273a 2054 7275 657d 2029  pleted': True} )
+000039a0: 2028 7374 696c 6c20 7275 6e6e 696e 673a   (still running:
+000039b0: 2031 290a 3e3e 2020 2066 696e 6973 6865   1).>>   finishe
+000039c0: 643a 204e 6f64 6528 3c66 756e 6374 696f  d: Node(<functio
+000039d0: 6e20 6420 6174 2030 7837 6635 3066 3462  n d at 0x7f50f4b
+000039e0: 3533 6136 303e 3a20 7b27 7374 6174 6527  53a60>: {'state'
+000039f0: 3a20 2753 5543 4345 5353 272c 2027 7265  : 'SUCCESS', 're
+00003a00: 7375 6c74 273a 2027 6720 6d61 6e20 7361  sult': 'g man sa
+00003a10: 793a 2062 6565 6570 6265 6565 7062 6565  y: beeepbeeepbee
+00003a20: 6570 272c 2027 6578 6365 7074 696f 6e27  ep', 'exception'
+00003a30: 3a20 4e6f 6e65 2c20 2763 6f6d 706c 6574  : None, 'complet
+00003a40: 6564 273a 2054 7275 657d 2029 2028 7374  ed': True} ) (st
+00003a50: 696c 6c20 7275 6e6e 696e 673a 2030 290a  ill running: 0).
+00003a60: 3e3e 2041 6c6c 2074 6173 6b73 2066 696e  >> All tasks fin
+00003a70: 6973 6865 642c 2073 6875 7474 696e 6720  ished, shutting 
+00003a80: 646f 776e 0a3e 3e0a 3e3e 2049 7465 7261  down.>>.>> Itera
+00003a90: 7465 206f 7665 7220 7265 7375 6c74 732e  te over results.
+00003aa0: 2e2e 0a3e 3e20 4e6f 6465 283c 6675 6e63  ...>> Node(<func
+00003ab0: 7469 6f6e 2061 2061 7420 3078 3766 3530  tion a at 0x7f50
+00003ac0: 6634 6239 6565 3530 3e3a 207b 2773 7461  f4b9ee50>: {'sta
+00003ad0: 7465 273a 2027 5355 4343 4553 5327 2c20  te': 'SUCCESS', 
+00003ae0: 2772 6573 756c 7427 3a20 352c 2027 6578  'result': 5, 'ex
+00003af0: 6365 7074 696f 6e27 3a20 4e6f 6e65 2c20  ception': None, 
+00003b00: 2763 6f6d 706c 6574 6564 273a 2054 7275  'completed': Tru
+00003b10: 657d 2029 0a3e 3e20 4e6f 6465 283c 6675  e} ).>> Node(<fu
+00003b20: 6e63 7469 6f6e 2062 2061 7420 3078 3766  nction b at 0x7f
+00003b30: 3530 6634 6235 3330 3430 3e3a 207b 2773  50f4b53040>: {'s
+00003b40: 7461 7465 273a 2027 5355 4343 4553 5327  tate': 'SUCCESS'
+00003b50: 2c20 2772 6573 756c 7427 3a20 2762 6565  , 'result': 'bee
+00003b60: 6570 272c 2027 6578 6365 7074 696f 6e27  ep', 'exception'
+00003b70: 3a20 4e6f 6e65 2c20 2763 6f6d 706c 6574  : None, 'complet
+00003b80: 6564 273a 2054 7275 657d 2029 0a3e 3e20  ed': True} ).>> 
+00003b90: 4e6f 6465 283c 6675 6e63 7469 6f6e 2063  Node(<function c
+00003ba0: 2061 7420 3078 3766 3530 6634 6235 3334   at 0x7f50f4b534
+00003bb0: 6330 3e3a 207b 2773 7461 7465 273a 2027  c0>: {'state': '
+00003bc0: 5355 4343 4553 5327 2c20 2772 6573 756c  SUCCESS', 'resul
+00003bd0: 7427 3a20 382c 2027 6578 6365 7074 696f  t': 8, 'exceptio
+00003be0: 6e27 3a20 4e6f 6e65 2c20 2763 6f6d 706c  n': None, 'compl
+00003bf0: 6574 6564 273a 2054 7275 657d 2029 0a3e  eted': True} ).>
+00003c00: 3e20 4e6f 6465 283c 6675 6e63 7469 6f6e  > Node(<function
+00003c10: 2064 2061 7420 3078 3766 3530 6634 6235   d at 0x7f50f4b5
+00003c20: 3361 3630 3e3a 207b 2773 7461 7465 273a  3a60>: {'state':
+00003c30: 2027 5355 4343 4553 5327 2c20 2772 6573   'SUCCESS', 'res
+00003c40: 756c 7427 3a20 2767 206d 616e 2073 6179  ult': 'g man say
+00003c50: 3a20 6265 6565 7062 6565 6570 6265 6565  : beeepbeeepbeee
+00003c60: 7027 2c20 2765 7863 6570 7469 6f6e 273a  p', 'exception':
+00003c70: 204e 6f6e 652c 2027 636f 6d70 6c65 7465   None, 'complete
+00003c80: 6427 3a20 5472 7565 7d20 290a 3e3e 204e  d': True} ).>> N
+00003c90: 6f64 6528 3c66 756e 6374 696f 6e20 6520  ode(<function e 
+00003ca0: 6174 2030 7837 6635 3066 3462 3533 6238  at 0x7f50f4b53b8
+00003cb0: 303e 3a20 7b27 7374 6174 6527 3a20 2745  0>: {'state': 'E
+00003cc0: 5252 4f52 272c 2027 7265 7375 6c74 273a  RROR', 'result':
+00003cd0: 204e 6f6e 652c 2027 6578 6365 7074 696f   None, 'exceptio
+00003ce0: 6e27 3a20 5661 6c75 6545 7272 6f72 2827  n': ValueError('
+00003cf0: 6f6d 672c 2063 7261 7368 2120 3527 292c  omg, crash! 5'),
+00003d00: 2027 636f 6d70 6c65 7465 6427 3a20 5472   'completed': Tr
+00003d10: 7565 7d20 290a 3e3e 204e 6f64 6528 3c66  ue} ).>> Node(<f
+00003d20: 756e 6374 696f 6e20 6620 6174 2030 7837  unction f at 0x7
+00003d30: 6635 3066 3462 3533 3064 303e 3a20 7b27  f50f4b530d0>: {'
+00003d40: 7374 6174 6527 3a20 2753 4b49 5050 4544  state': 'SKIPPED
+00003d50: 272c 2027 7265 7375 6c74 273a 204e 6f6e  ', 'result': Non
+00003d60: 652c 2027 6578 6365 7074 696f 6e27 3a20  e, 'exception': 
+00003d70: 4e6f 6e65 2c20 2763 6f6d 706c 6574 6564  None, 'completed
+00003d80: 273a 2046 616c 7365 7d20 290a 3e3e 204e  ': False} ).>> N
+00003d90: 6f64 6528 3c66 756e 6374 696f 6e20 6720  ode(<function g 
+00003da0: 6174 2030 7837 6635 3066 3462 3533 3565  at 0x7f50f4b535e
+00003db0: 303e 3a20 7b27 7374 6174 6527 3a20 2753  0>: {'state': 'S
+00003dc0: 4b49 5050 4544 272c 2027 7265 7375 6c74  KIPPED', 'result
+00003dd0: 273a 203c 7468 7265 6164 696e 672e 4576  ': <threading.Ev
+00003de0: 656e 7420 6f62 6a65 6374 2061 7420 3078  ent object at 0x
+00003df0: 3766 3530 6563 3136 6339 6430 3e2c 2027  7f50ec16c9d0>, '
+00003e00: 6578 6365 7074 696f 6e27 3a20 4e6f 6e65  exception': None
+00003e10: 2c20 2763 6f6d 706c 6574 6564 273a 2054  , 'completed': T
+00003e20: 7275 657d 2029 0a3e 3e20 4e6f 6465 283c  rue} ).>> Node(<
+00003e30: 6675 6e63 7469 6f6e 2069 2061 7420 3078  function i at 0x
+00003e40: 3766 3530 6634 6235 3332 3830 3e3a 207b  7f50f4b53280>: {
+00003e50: 2773 7461 7465 273a 2027 534b 4950 5045  'state': 'SKIPPE
+00003e60: 4427 2c20 2772 6573 756c 7427 3a20 4e6f  D', 'result': No
+00003e70: 6e65 2c20 2765 7863 6570 7469 6f6e 273a  ne, 'exception':
+00003e80: 204e 6f6e 652c 2027 636f 6d70 6c65 7465   None, 'complete
+00003e90: 6427 3a20 4661 6c73 657d 2029 0a60 6060  d': False} ).```
+00003ea0: 0a0a 2323 2045 7865 6375 7465 2073 7061  ..## Execute spa
+00003eb0: 726b 2070 6970 656c 696e 6520 6f66 206d  rk pipeline of m
+00003ec0: 756c 7469 706c 6520 7374 6570 730a 7573  ultiple steps.us
+00003ed0: 696e 6720 4441 4720 636f 6d70 6f6e 656e  ing DAG componen
+00003ee0: 7420 746f 2068 616e 646c 6520 7061 7261  t to handle para
+00003ef0: 6c6c 656c 2065 7865 6375 7469 6f6e 0a60  llel execution.`
+00003f00: 6060 7079 7468 6f6e 0a69 6d70 6f72 7420  ``python.import 
+00003f10: 6264 710a 6672 6f6d 2062 6471 2069 6d70  bdq.from bdq imp
+00003f20: 6f72 7420 7370 6172 6b2c 2074 6162 6c65  ort spark, table
+00003f30: 0a0a 7070 6e20 3d20 6264 712e 5370 6172  ..ppn = bdq.Spar
+00003f40: 6b50 6970 656c 696e 6528 7370 6172 6b2c  kPipeline(spark,
+00003f50: 2022 7265 7461 696c 2229 0a0a 2320 7265   "retail")..# re
+00003f60: 7475 726e 7320 6461 7461 6672 616d 652c  turns dataframe,
+00003f70: 2061 6e64 2063 7265 6174 6573 2073 7061   and creates spa
+00003f80: 726b 2076 6965 7720 2772 6177 5f64 6174  rk view 'raw_dat
+00003f90: 615f 7369 6e67 6c65 5f73 6f75 7263 6527  a_single_source'
+00003fa0: 0a40 7070 6e2e 7374 6570 2829 0a64 6566  .@ppn.step().def
+00003fb0: 2072 6177 5f64 6174 615f 7369 6e67 6c65   raw_data_single
+00003fc0: 5f73 6f75 7263 6528 7029 3a0a 2020 7265  _source(p):.  re
+00003fd0: 7475 726e 2073 7061 726b 2e72 616e 6765  turn spark.range
+00003fe0: 2831 2c20 3130 290a 0a23 2072 6574 7572  (1, 10)..# retur
+00003ff0: 6e73 2064 6174 6166 7261 6d65 2c20 616e  ns dataframe, an
+00004000: 6420 6372 6561 7465 7320 7370 6172 6b20  d creates spark 
+00004010: 7669 6577 2027 7261 775f 6e69 6365 5f6e  view 'raw_nice_n
+00004020: 616d 6527 0a40 7070 6e2e 7374 6570 2872  ame'.@ppn.step(r
+00004030: 6574 7572 6e73 3d5b 2272 6177 5f6e 6963  eturns=["raw_nic
+00004040: 655f 6e61 6d65 225d 290a 6465 6620 7261  e_name"]).def ra
+00004050: 775f 6461 7461 5f73 696e 676c 655f 736f  w_data_single_so
+00004060: 7572 6365 5f77 6974 685f 6375 7374 6f6d  urce_with_custom
+00004070: 5f6e 616d 6528 7029 3a0a 2020 7265 7475  _name(p):.  retu
+00004080: 726e 2073 7061 726b 2e72 616e 6765 2831  rn spark.range(1
+00004090: 3030 2c20 3131 3029 0a0a 2320 7265 7475  00, 110)..# retu
+000040a0: 726e 7320 7477 6f20 6461 7461 6672 616d  rns two datafram
+000040b0: 6573 2c20 616e 6420 6372 6561 7465 7320  es, and creates 
+000040c0: 7477 6f20 7370 6172 6b20 7669 6577 7320  two spark views 
+000040d0: 2772 6177 5f64 6174 6131 272c 2027 7261  'raw_data1', 'ra
+000040e0: 775f 6461 7461 3227 0a40 7070 6e2e 7374  w_data2'.@ppn.st
+000040f0: 6570 2872 6574 7572 6e73 3d5b 2272 6177  ep(returns=["raw
+00004100: 5f64 6174 6131 222c 2022 7261 775f 6461  _data1", "raw_da
+00004110: 7461 3222 5d29 0a64 6566 2072 6177 5f64  ta2"]).def raw_d
+00004120: 6174 615f 6d75 6c74 695f 736f 7572 6365  ata_multi_source
+00004130: 2870 293a 0a20 2064 6631 203d 2073 7061  (p):.  df1 = spa
+00004140: 726b 2e72 616e 6765 2831 3030 302c 2032  rk.range(1000, 2
+00004150: 3030 3029 0a20 2064 6632 203d 2073 7061  000).  df2 = spa
+00004160: 726b 2e72 616e 6765 2832 3030 302c 2033  rk.range(2000, 3
+00004170: 3030 3029 0a0a 2020 7265 7475 726e 205b  000)..  return [
+00004180: 6466 312c 2064 6632 5d0a 0a23 2077 6169  df1, df2]..# wai
+00004190: 7473 2066 6f72 2072 6177 2064 6174 6120  ts for raw data 
+000041a0: 736f 7572 6365 7320 746f 2066 696e 6973  sources to finis
+000041b0: 682c 2061 6e64 2063 6f6d 6269 6e65 7320  h, and combines 
+000041c0: 7468 6520 6461 7461 2069 6e74 6f20 6f6e  the data into on
+000041d0: 6520 756e 696f 6e65 6420 7669 6577 2060  e unioned view `
+000041e0: 636f 6d62 696e 655f 6461 7461 600a 2320  combine_data`.# 
+000041f0: 6e6f 7465 2074 6861 7420 6465 7065 6e64  note that depend
+00004200: 656e 6369 6573 2061 7265 2070 7974 686f  encies are pytho
+00004210: 6e20 6675 6e63 7469 6f6e 732c 206e 6f74  n functions, not
+00004220: 206e 616d 6573 206f 6620 7669 6577 7320   names of views 
+00004230: 2854 4f44 4f3a 2074 6f20 6861 6e64 6c65  (TODO: to handle
+00004240: 2076 6965 7720 6e61 6d65 7320 6173 2077   view names as w
+00004250: 656c 6c29 0a40 7070 6e2e 7374 6570 2864  ell).@ppn.step(d
+00004260: 6570 656e 6473 5f6f 6e3d 5b72 6177 5f64  epends_on=[raw_d
 00004270: 6174 615f 7369 6e67 6c65 5f73 6f75 7263  ata_single_sourc
-00004280: 6527 2920 5c0a 2020 2020 2e75 6e69 6f6e  e') \.    .union
-00004290: 2874 6162 6c65 2827 7261 775f 6e69 6365  (table('raw_nice
-000042a0: 5f6e 616d 6527 2929 205c 0a20 2020 202e  _name')) \.    .
-000042b0: 756e 696f 6e28 7461 626c 6528 2772 6177  union(table('raw
-000042c0: 5f64 6174 6131 2729 2920 5c0a 2020 2020  _data1')) \.    
-000042d0: 2e75 6e69 6f6e 2874 6162 6c65 2827 7261  .union(table('ra
-000042e0: 775f 6461 7461 3227 2929 0a0a 2020 7265  w_data2'))..  re
-000042f0: 7475 726e 2064 660a 0a23 2073 706c 6974  turn df..# split
-00004300: 7320 7468 6520 636f 6d62 696e 6564 5f64  s the combined_d
-00004310: 6174 6120 696e 746f 2027 6f64 6427 2061  ata into 'odd' a
-00004320: 6e64 2027 6576 656e 2720 7669 6577 730a  nd 'even' views.
-00004330: 4070 706e 2e73 7465 7028 6465 7065 6e64  @ppn.step(depend
-00004340: 735f 6f6e 3d5b 636f 6d62 696e 655f 6461  s_on=[combine_da
-00004350: 7461 5d2c 2072 6574 7572 6e73 3d5b 276f  ta], returns=['o
-00004360: 6464 272c 2027 6576 656e 275d 290a 6465  dd', 'even']).de
-00004370: 6620 7370 6c69 745f 6461 7461 2870 293a  f split_data(p):
-00004380: 0a20 2064 665f 6f64 6420 3d20 7461 626c  .  df_odd = tabl
-00004390: 6528 2763 6f6d 6269 6e65 5f64 6174 6127  e('combine_data'
-000043a0: 292e 6669 6c74 6572 2827 6964 2025 2032  ).filter('id % 2
-000043b0: 203d 3d20 3127 290a 2020 6466 5f65 7665   == 1').  df_eve
-000043c0: 6e20 3d20 7461 626c 6528 2763 6f6d 6269  n = table('combi
-000043d0: 6e65 5f64 6174 6127 292e 6669 6c74 6572  ne_data').filter
-000043e0: 2827 6964 2025 2032 203d 3d20 3027 290a  ('id % 2 == 0').
-000043f0: 0a20 2072 6574 7572 6e20 5b20 6466 5f6f  .  return [ df_o
-00004400: 6464 2c20 6466 5f65 7665 6e20 5d0a 0a23  dd, df_even ]..#
-00004410: 2065 7865 6375 7465 7320 7069 7065 6c69   executes pipeli
-00004420: 6e65 2075 7369 6e67 2063 6f6e 6375 7272  ne using concurr
-00004430: 656e 7420 7468 7265 6164 732c 206f 6e65  ent threads, one
-00004440: 2070 6572 2065 6163 6820 7374 6570 2c20   per each step, 
-00004450: 666f 6c6c 6f77 696e 6720 7468 6520 6465  following the de
-00004460: 7065 6e64 656e 6379 2044 4147 0a23 2070  pendency DAG.# p
-00004470: 6970 656c 696e 6520 6973 2061 206e 6f72  ipeline is a nor
-00004480: 6d61 6c20 7079 7468 6f6e 2063 616c 6c61  mal python calla
-00004490: 626c 6520 6f62 6a65 6374 2c20 6173 2069  ble object, as i
-000044a0: 6620 6974 2077 6173 2061 2066 756e 6374  f it was a funct
-000044b0: 696f 6e2c 2069 7420 7265 7475 726e 7320  ion, it returns 
-000044c0: 6120 6c69 7374 206f 6620 616c 6c20 7374  a list of all st
-000044d0: 6570 730a 7069 7065 6c69 6e65 5f72 6573  eps.pipeline_res
-000044e0: 756c 7473 203d 2070 706e 286d 6178 5f63  ults = ppn(max_c
-000044f0: 6f6e 6375 7272 656e 745f 7374 6570 733d  oncurrent_steps=
-00004500: 3130 290a 0a70 7269 6e74 2827 7069 7065  10)..print('pipe
-00004510: 6c69 6e65 2072 6573 756c 7473 3a27 290a  line results:').
-00004520: 7072 696e 7428 7069 7065 6c69 6e65 5f72  print(pipeline_r
-00004530: 6573 756c 7473 290a 0a23 7368 6f77 2073  esults)..#show s
-00004540: 6f6d 6520 6669 6e61 6c20 7661 6c75 6573  ome final values
-00004550: 0a70 7269 6e74 2827 6576 656e 206e 756d  .print('even num
-00004560: 6265 7273 3a27 290a 7072 696e 7428 7461  bers:').print(ta
-00004570: 626c 6528 2765 7665 6e27 292e 6c69 6d69  ble('even').limi
-00004580: 7428 3130 292e 636f 6c6c 6563 7428 2929  t(10).collect())
-00004590: 0a70 7269 6e74 2827 6f64 6420 6e75 6d62  .print('odd numb
-000045a0: 6572 733a 2729 0a70 7269 6e74 2874 6162  ers:').print(tab
-000045b0: 6c65 2827 6f64 6427 292e 6c69 6d69 7428  le('odd').limit(
-000045c0: 3130 292e 636f 6c6c 6563 7428 2929 0a0a  10).collect())..
-000045d0: 3e3e 2057 6169 7469 6e67 2066 6f72 2061  >> Waiting for a
-000045e0: 6c6c 2074 6173 6b73 2074 6f20 6669 6e69  ll tasks to fini
-000045f0: 7368 2e2e 2e0a 3e3e 2020 2073 7461 7274  sh....>>   start
-00004600: 696e 673a 204e 6f64 6528 7261 775f 6461  ing: Node(raw_da
-00004610: 7461 5f73 696e 676c 655f 736f 7572 6365  ta_single_source
-00004620: 3a20 7b27 7374 6174 6527 3a20 2752 554e  : {'state': 'RUN
-00004630: 4e49 4e47 272c 2027 7265 7375 6c74 273a  NING', 'result':
-00004640: 204e 6f6e 652c 2027 6578 6365 7074 696f   None, 'exceptio
-00004650: 6e27 3a20 4e6f 6e65 2c20 2763 6f6d 706c  n': None, 'compl
-00004660: 6574 6564 273a 2046 616c 7365 7d20 290a  eted': False} ).
-00004670: 3e3e 2020 2073 7461 7274 696e 673a 204e  >>   starting: N
-00004680: 6f64 6528 7261 775f 6461 7461 5f73 696e  ode(raw_data_sin
-00004690: 676c 655f 736f 7572 6365 5f77 6974 685f  gle_source_with_
-000046a0: 6375 7374 6f6d 5f6e 616d 653a 207b 2773  custom_name: {'s
-000046b0: 7461 7465 273a 2027 5255 4e4e 494e 4727  tate': 'RUNNING'
-000046c0: 2c20 2772 6573 756c 7427 3a20 4e6f 6e65  , 'result': None
-000046d0: 2c20 2765 7863 6570 7469 6f6e 273a 204e  , 'exception': N
-000046e0: 6f6e 652c 2027 636f 6d70 6c65 7465 6427  one, 'completed'
-000046f0: 3a20 4661 6c73 657d 2029 0a3e 3e20 2020  : False} ).>>   
-00004700: 7374 6172 7469 6e67 3a20 4e6f 6465 2872  starting: Node(r
-00004710: 6177 5f64 6174 615f 6d75 6c74 695f 736f  aw_data_multi_so
-00004720: 7572 6365 3a20 7b27 7374 6174 6527 3a20  urce: {'state': 
-00004730: 2752 554e 4e49 4e47 272c 2027 7265 7375  'RUNNING', 'resu
-00004740: 6c74 273a 204e 6f6e 652c 2027 6578 6365  lt': None, 'exce
-00004750: 7074 696f 6e27 3a20 4e6f 6e65 2c20 2763  ption': None, 'c
-00004760: 6f6d 706c 6574 6564 273a 2046 616c 7365  ompleted': False
-00004770: 7d20 290a 3e3e 2020 2066 696e 6973 6865  } ).>>   finishe
-00004780: 643a 204e 6f64 6528 7261 775f 6461 7461  d: Node(raw_data
-00004790: 5f73 696e 676c 655f 736f 7572 6365 3a20  _single_source: 
-000047a0: 7b27 7374 6174 6527 3a20 2753 5543 4345  {'state': 'SUCCE
-000047b0: 5353 272c 2027 7265 7375 6c74 273a 205b  SS', 'result': [
-000047c0: 4461 7461 4672 616d 655b 6964 3a20 6269  DataFrame[id: bi
-000047d0: 6769 6e74 5d5d 2c20 2765 7863 6570 7469  gint]], 'excepti
-000047e0: 6f6e 273a 204e 6f6e 652c 2027 636f 6d70  on': None, 'comp
-000047f0: 6c65 7465 6427 3a20 5472 7565 7d20 2920  leted': True} ) 
-00004800: 2873 7469 6c6c 2072 756e 6e69 6e67 3a20  (still running: 
-00004810: 3229 0a3e 3e20 2020 6669 6e69 7368 6564  2).>>   finished
-00004820: 3a20 4e6f 6465 2872 6177 5f64 6174 615f  : Node(raw_data_
-00004830: 7369 6e67 6c65 5f73 6f75 7263 655f 7769  single_source_wi
-00004840: 7468 5f63 7573 746f 6d5f 6e61 6d65 3a20  th_custom_name: 
-00004850: 7b27 7374 6174 6527 3a20 2753 5543 4345  {'state': 'SUCCE
-00004860: 5353 272c 2027 7265 7375 6c74 273a 205b  SS', 'result': [
-00004870: 4461 7461 4672 616d 655b 6964 3a20 6269  DataFrame[id: bi
-00004880: 6769 6e74 5d5d 2c20 2765 7863 6570 7469  gint]], 'excepti
-00004890: 6f6e 273a 204e 6f6e 652c 2027 636f 6d70  on': None, 'comp
-000048a0: 6c65 7465 6427 3a20 5472 7565 7d20 2920  leted': True} ) 
-000048b0: 2873 7469 6c6c 2072 756e 6e69 6e67 3a20  (still running: 
-000048c0: 3129 0a3e 3e20 2020 7374 6172 7469 6e67  1).>>   starting
-000048d0: 3a20 4e6f 6465 2863 6f6d 6269 6e65 5f64  : Node(combine_d
-000048e0: 6174 613a 207b 2773 7461 7465 273a 2027  ata: {'state': '
-000048f0: 5255 4e4e 494e 4727 2c20 2772 6573 756c  RUNNING', 'resul
-00004900: 7427 3a20 4e6f 6e65 2c20 2765 7863 6570  t': None, 'excep
-00004910: 7469 6f6e 273a 204e 6f6e 652c 2027 636f  tion': None, 'co
-00004920: 6d70 6c65 7465 6427 3a20 4661 6c73 657d  mpleted': False}
-00004930: 2029 0a3e 3e20 2020 6669 6e69 7368 6564   ).>>   finished
-00004940: 3a20 4e6f 6465 2872 6177 5f64 6174 615f  : Node(raw_data_
-00004950: 6d75 6c74 695f 736f 7572 6365 3a20 7b27  multi_source: {'
-00004960: 7374 6174 6527 3a20 2753 5543 4345 5353  state': 'SUCCESS
-00004970: 272c 2027 7265 7375 6c74 273a 205b 4461  ', 'result': [Da
-00004980: 7461 4672 616d 655b 6964 3a20 6269 6769  taFrame[id: bigi
-00004990: 6e74 5d2c 2044 6174 6146 7261 6d65 5b69  nt], DataFrame[i
-000049a0: 643a 2062 6967 696e 745d 5d2c 2027 6578  d: bigint]], 'ex
-000049b0: 6365 7074 696f 6e27 3a20 4e6f 6e65 2c20  ception': None, 
-000049c0: 2763 6f6d 706c 6574 6564 273a 2054 7275  'completed': Tru
-000049d0: 657d 2029 2028 7374 696c 6c20 7275 6e6e  e} ) (still runn
-000049e0: 696e 673a 2031 290a 3e3e 2020 2073 7461  ing: 1).>>   sta
-000049f0: 7274 696e 673a 204e 6f64 6528 7370 6c69  rting: Node(spli
-00004a00: 745f 6461 7461 3a20 7b27 7374 6174 6527  t_data: {'state'
-00004a10: 3a20 2752 554e 4e49 4e47 272c 2027 7265  : 'RUNNING', 're
-00004a20: 7375 6c74 273a 204e 6f6e 652c 2027 6578  sult': None, 'ex
-00004a30: 6365 7074 696f 6e27 3a20 4e6f 6e65 2c20  ception': None, 
-00004a40: 2763 6f6d 706c 6574 6564 273a 2046 616c  'completed': Fal
-00004a50: 7365 7d20 290a 3e3e 2020 2066 696e 6973  se} ).>>   finis
-00004a60: 6865 643a 204e 6f64 6528 636f 6d62 696e  hed: Node(combin
-00004a70: 655f 6461 7461 3a20 7b27 7374 6174 6527  e_data: {'state'
-00004a80: 3a20 2753 5543 4345 5353 272c 2027 7265  : 'SUCCESS', 're
-00004a90: 7375 6c74 273a 205b 4461 7461 4672 616d  sult': [DataFram
-00004aa0: 655b 6964 3a20 6269 6769 6e74 5d5d 2c20  e[id: bigint]], 
-00004ab0: 2765 7863 6570 7469 6f6e 273a 204e 6f6e  'exception': Non
-00004ac0: 652c 2027 636f 6d70 6c65 7465 6427 3a20  e, 'completed': 
-00004ad0: 5472 7565 7d20 2920 2873 7469 6c6c 2072  True} ) (still r
-00004ae0: 756e 6e69 6e67 3a20 3129 0a3e 3e20 2020  unning: 1).>>   
-00004af0: 6669 6e69 7368 6564 3a20 4e6f 6465 2873  finished: Node(s
-00004b00: 706c 6974 5f64 6174 613a 207b 2773 7461  plit_data: {'sta
-00004b10: 7465 273a 2027 5355 4343 4553 5327 2c20  te': 'SUCCESS', 
-00004b20: 2772 6573 756c 7427 3a20 5b44 6174 6146  'result': [DataF
-00004b30: 7261 6d65 5b69 643a 2062 6967 696e 745d  rame[id: bigint]
-00004b40: 2c20 4461 7461 4672 616d 655b 6964 3a20  , DataFrame[id: 
-00004b50: 6269 6769 6e74 5d5d 2c20 2765 7863 6570  bigint]], 'excep
-00004b60: 7469 6f6e 273a 204e 6f6e 652c 2027 636f  tion': None, 'co
-00004b70: 6d70 6c65 7465 6427 3a20 5472 7565 7d20  mpleted': True} 
-00004b80: 2920 2873 7469 6c6c 2072 756e 6e69 6e67  ) (still running
-00004b90: 3a20 3029 0a3e 3e20 416c 6c20 7461 736b  : 0).>> All task
-00004ba0: 7320 6669 6e69 7368 6564 2c20 7368 7574  s finished, shut
-00004bb0: 7469 6e67 2064 6f77 6e0a 3e3e 2070 6970  ting down.>> pip
-00004bc0: 656c 696e 6520 7265 7375 6c74 733a 0a3e  eline results:.>
-00004bd0: 3e20 5b72 6177 5f64 6174 615f 7369 6e67  > [raw_data_sing
-00004be0: 6c65 5f73 6f75 7263 652c 2072 6177 5f64  le_source, raw_d
-00004bf0: 6174 615f 7369 6e67 6c65 5f73 6f75 7263  ata_single_sourc
-00004c00: 655f 7769 7468 5f63 7573 746f 6d5f 6e61  e_with_custom_na
-00004c10: 6d65 2c20 7261 775f 6461 7461 5f6d 756c  me, raw_data_mul
-00004c20: 7469 5f73 6f75 7263 652c 2063 6f6d 6269  ti_source, combi
-00004c30: 6e65 5f64 6174 612c 2073 706c 6974 5f64  ne_data, split_d
-00004c40: 6174 615d 0a3e 3e20 6576 656e 206e 756d  ata].>> even num
-00004c50: 6265 7273 3a0a 3e3e 205b 526f 7728 6964  bers:.>> [Row(id
-00004c60: 3d32 292c 2052 6f77 2869 643d 3429 2c20  =2), Row(id=4), 
-00004c70: 526f 7728 6964 3d36 292c 2052 6f77 2869  Row(id=6), Row(i
-00004c80: 643d 3829 2c20 526f 7728 6964 3d31 3030  d=8), Row(id=100
-00004c90: 292c 2052 6f77 2869 643d 3130 3229 2c20  ), Row(id=102), 
-00004ca0: 526f 7728 6964 3d31 3034 292c 2052 6f77  Row(id=104), Row
-00004cb0: 2869 643d 3130 3629 2c20 526f 7728 6964  (id=106), Row(id
-00004cc0: 3d31 3038 292c 2052 6f77 2869 643d 3130  =108), Row(id=10
-00004cd0: 3030 295d 0a3e 3e20 6f64 6420 6e75 6d62  00)].>> odd numb
-00004ce0: 6572 733a 0a3e 3e20 5b52 6f77 2869 643d  ers:.>> [Row(id=
-00004cf0: 3129 2c20 526f 7728 6964 3d33 292c 2052  1), Row(id=3), R
-00004d00: 6f77 2869 643d 3529 2c20 526f 7728 6964  ow(id=5), Row(id
-00004d10: 3d37 292c 2052 6f77 2869 643d 3929 2c20  =7), Row(id=9), 
-00004d20: 526f 7728 6964 3d31 3031 292c 2052 6f77  Row(id=101), Row
-00004d30: 2869 643d 3130 3329 2c20 526f 7728 6964  (id=103), Row(id
-00004d40: 3d31 3035 292c 2052 6f77 2869 643d 3130  =105), Row(id=10
-00004d50: 3729 2c20 526f 7728 6964 3d31 3039 295d  7), Row(id=109)]
-00004d60: 0a60 6060 0a0a 7069 7065 6c69 6e65 2073  .```..pipeline s
-00004d70: 7465 7073 2061 7265 2072 6572 756e 6162  teps are rerunab
-00004d80: 6c65 2061 7320 616e 7920 6f72 6469 6e61  le as any ordina
-00004d90: 7279 2066 756e 6374 696f 6e3a 0a60 6060  ry function:.```
-00004da0: 7079 7468 6f6e 0a23 2074 6f20 7265 7275  python.# to reru
-00004db0: 6e20 6769 7665 6e20 7374 6570 2c20 6a75  n given step, ju
-00004dc0: 7374 2065 7865 6375 7465 2069 7420 6173  st execute it as
-00004dd0: 2069 6620 6974 2077 6173 2061 2070 7572   if it was a pur
-00004de0: 6520 6675 6e63 7469 6f6e 0a23 2072 6574  e function.# ret
-00004df0: 7572 6e20 6973 2061 6c61 7761 7973 2061  urn is alaways a
-00004e00: 206c 6973 7420 6f66 2064 6174 6166 7261   list of datafra
-00004e10: 6d73 2074 6861 7420 6769 7665 6e20 4070  ms that given @p
-00004e20: 706e 2e73 7465 7020 7265 7475 726e 730a  pn.step returns.
-00004e30: 2320 6e6f 7465 3a20 7468 6520 7370 6172  # note: the spar
-00004e40: 6b20 7669 6577 2027 7261 775f 6461 7461  k view 'raw_data
-00004e50: 5f73 696e 676c 655f 736f 7572 6365 2720  _single_source' 
-00004e60: 7769 6c6c 2062 6520 7570 6461 7465 6420  will be updated 
-00004e70: 7768 656e 2074 6869 7320 6675 6e63 7469  when this functi
-00004e80: 6f6e 2066 696e 6973 6865 7320 2861 7320  on finishes (as 
-00004e90: 7065 7220 6465 6669 6e74 696f 6e20 696e  per defintion in
-00004ea0: 2040 7070 6e2e 7374 6570 2061 626f 7665   @ppn.step above
-00004eb0: 290a 7261 775f 6461 7461 5f73 696e 676c  ).raw_data_singl
-00004ec0: 655f 736f 7572 6365 2829 0a60 6060 0a    e_source().```.
+00004280: 652c 2072 6177 5f64 6174 615f 7369 6e67  e, raw_data_sing
+00004290: 6c65 5f73 6f75 7263 655f 7769 7468 5f63  le_source_with_c
+000042a0: 7573 746f 6d5f 6e61 6d65 2c20 7261 775f  ustom_name, raw_
+000042b0: 6461 7461 5f6d 756c 7469 5f73 6f75 7263  data_multi_sourc
+000042c0: 655d 290a 6465 6620 636f 6d62 696e 655f  e]).def combine_
+000042d0: 6461 7461 2870 293a 0a20 2064 6620 3d20  data(p):.  df = 
+000042e0: 7461 626c 6528 2772 6177 5f64 6174 615f  table('raw_data_
+000042f0: 7369 6e67 6c65 5f73 6f75 7263 6527 2920  single_source') 
+00004300: 5c0a 2020 2020 2e75 6e69 6f6e 2874 6162  \.    .union(tab
+00004310: 6c65 2827 7261 775f 6e69 6365 5f6e 616d  le('raw_nice_nam
+00004320: 6527 2929 205c 0a20 2020 202e 756e 696f  e')) \.    .unio
+00004330: 6e28 7461 626c 6528 2772 6177 5f64 6174  n(table('raw_dat
+00004340: 6131 2729 2920 5c0a 2020 2020 2e75 6e69  a1')) \.    .uni
+00004350: 6f6e 2874 6162 6c65 2827 7261 775f 6461  on(table('raw_da
+00004360: 7461 3227 2929 0a0a 2020 7265 7475 726e  ta2'))..  return
+00004370: 2064 660a 0a23 2073 706c 6974 7320 7468   df..# splits th
+00004380: 6520 636f 6d62 696e 6564 5f64 6174 6120  e combined_data 
+00004390: 696e 746f 2027 6f64 6427 2061 6e64 2027  into 'odd' and '
+000043a0: 6576 656e 2720 7669 6577 730a 4070 706e  even' views.@ppn
+000043b0: 2e73 7465 7028 6465 7065 6e64 735f 6f6e  .step(depends_on
+000043c0: 3d5b 636f 6d62 696e 655f 6461 7461 5d2c  =[combine_data],
+000043d0: 2072 6574 7572 6e73 3d5b 276f 6464 272c   returns=['odd',
+000043e0: 2027 6576 656e 275d 290a 6465 6620 7370   'even']).def sp
+000043f0: 6c69 745f 6461 7461 2870 293a 0a20 2064  lit_data(p):.  d
+00004400: 665f 6f64 6420 3d20 7461 626c 6528 2763  f_odd = table('c
+00004410: 6f6d 6269 6e65 5f64 6174 6127 292e 6669  ombine_data').fi
+00004420: 6c74 6572 2827 6964 2025 2032 203d 3d20  lter('id % 2 == 
+00004430: 3127 290a 2020 6466 5f65 7665 6e20 3d20  1').  df_even = 
+00004440: 7461 626c 6528 2763 6f6d 6269 6e65 5f64  table('combine_d
+00004450: 6174 6127 292e 6669 6c74 6572 2827 6964  ata').filter('id
+00004460: 2025 2032 203d 3d20 3027 290a 0a20 2072   % 2 == 0')..  r
+00004470: 6574 7572 6e20 5b20 6466 5f6f 6464 2c20  eturn [ df_odd, 
+00004480: 6466 5f65 7665 6e20 5d0a 0a23 2069 6620  df_even ]..# if 
+00004490: 796f 7520 6861 7665 2069 7079 6461 6772  you have ipydagr
+000044a0: 6564 3320 696e 7374 616c 6c65 642c 2079  ed3 installed, y
+000044b0: 6f75 2063 616e 2073 6565 2069 6e20 7265  ou can see in re
+000044c0: 616c 2074 696d 6520 7374 6174 6520 6368  al time state ch
+000044d0: 616e 6765 7320 6f66 2065 6163 6820 6f66  anges of each of
+000044e0: 2074 6865 2073 7465 7073 0a64 6973 706c   the steps.displ
+000044f0: 6179 2870 706e 2e76 6973 7561 6c69 7a65  ay(ppn.visualize
+00004500: 2829 290a 0a23 2065 7865 6375 7465 7320  ())..# executes 
+00004510: 7069 7065 6c69 6e65 2075 7369 6e67 2063  pipeline using c
+00004520: 6f6e 6375 7272 656e 7420 7468 7265 6164  oncurrent thread
+00004530: 732c 206f 6e65 2070 6572 2065 6163 6820  s, one per each 
+00004540: 7374 6570 2c20 666f 6c6c 6f77 696e 6720  step, following 
+00004550: 7468 6520 6465 7065 6e64 656e 6379 2044  the dependency D
+00004560: 4147 0a23 2070 6970 656c 696e 6520 6973  AG.# pipeline is
+00004570: 2061 206e 6f72 6d61 6c20 7079 7468 6f6e   a normal python
+00004580: 2063 616c 6c61 626c 6520 6f62 6a65 6374   callable object
+00004590: 2c20 6173 2069 6620 6974 2077 6173 2061  , as if it was a
+000045a0: 2066 756e 6374 696f 6e2c 2069 7420 7265   function, it re
+000045b0: 7475 726e 7320 6120 6c69 7374 206f 6620  turns a list of 
+000045c0: 616c 6c20 7374 6570 730a 7069 7065 6c69  all steps.pipeli
+000045d0: 6e65 5f72 6573 756c 7473 203d 2070 706e  ne_results = ppn
+000045e0: 286d 6178 5f63 6f6e 6375 7272 656e 745f  (max_concurrent_
+000045f0: 7374 6570 733d 3130 290a 0a70 7269 6e74  steps=10)..print
+00004600: 2827 7069 7065 6c69 6e65 2072 6573 756c  ('pipeline resul
+00004610: 7473 3a27 290a 7072 696e 7428 7069 7065  ts:').print(pipe
+00004620: 6c69 6e65 5f72 6573 756c 7473 290a 0a23  line_results)..#
+00004630: 7368 6f77 2073 6f6d 6520 6669 6e61 6c20  show some final 
+00004640: 7661 6c75 6573 0a70 7269 6e74 2827 6576  values.print('ev
+00004650: 656e 206e 756d 6265 7273 3a27 290a 7072  en numbers:').pr
+00004660: 696e 7428 7461 626c 6528 2765 7665 6e27  int(table('even'
+00004670: 292e 6c69 6d69 7428 3130 292e 636f 6c6c  ).limit(10).coll
+00004680: 6563 7428 2929 0a70 7269 6e74 2827 6f64  ect()).print('od
+00004690: 6420 6e75 6d62 6572 733a 2729 0a70 7269  d numbers:').pri
+000046a0: 6e74 2874 6162 6c65 2827 6f64 6427 292e  nt(table('odd').
+000046b0: 6c69 6d69 7428 3130 292e 636f 6c6c 6563  limit(10).collec
+000046c0: 7428 2929 0a0a 3e3e 2057 6169 7469 6e67  t())..>> Waiting
+000046d0: 2066 6f72 2061 6c6c 2074 6173 6b73 2074   for all tasks t
+000046e0: 6f20 6669 6e69 7368 2e2e 2e0a 3e3e 2020  o finish....>>  
+000046f0: 2073 7461 7274 696e 673a 204e 6f64 6528   starting: Node(
+00004700: 7261 775f 6461 7461 5f73 696e 676c 655f  raw_data_single_
+00004710: 736f 7572 6365 3a20 7b27 7374 6174 6527  source: {'state'
+00004720: 3a20 2752 554e 4e49 4e47 272c 2027 7265  : 'RUNNING', 're
+00004730: 7375 6c74 273a 204e 6f6e 652c 2027 6578  sult': None, 'ex
+00004740: 6365 7074 696f 6e27 3a20 4e6f 6e65 2c20  ception': None, 
+00004750: 2763 6f6d 706c 6574 6564 273a 2046 616c  'completed': Fal
+00004760: 7365 7d20 290a 3e3e 2020 2073 7461 7274  se} ).>>   start
+00004770: 696e 673a 204e 6f64 6528 7261 775f 6461  ing: Node(raw_da
+00004780: 7461 5f73 696e 676c 655f 736f 7572 6365  ta_single_source
+00004790: 5f77 6974 685f 6375 7374 6f6d 5f6e 616d  _with_custom_nam
+000047a0: 653a 207b 2773 7461 7465 273a 2027 5255  e: {'state': 'RU
+000047b0: 4e4e 494e 4727 2c20 2772 6573 756c 7427  NNING', 'result'
+000047c0: 3a20 4e6f 6e65 2c20 2765 7863 6570 7469  : None, 'excepti
+000047d0: 6f6e 273a 204e 6f6e 652c 2027 636f 6d70  on': None, 'comp
+000047e0: 6c65 7465 6427 3a20 4661 6c73 657d 2029  leted': False} )
+000047f0: 0a3e 3e20 2020 7374 6172 7469 6e67 3a20  .>>   starting: 
+00004800: 4e6f 6465 2872 6177 5f64 6174 615f 6d75  Node(raw_data_mu
+00004810: 6c74 695f 736f 7572 6365 3a20 7b27 7374  lti_source: {'st
+00004820: 6174 6527 3a20 2752 554e 4e49 4e47 272c  ate': 'RUNNING',
+00004830: 2027 7265 7375 6c74 273a 204e 6f6e 652c   'result': None,
+00004840: 2027 6578 6365 7074 696f 6e27 3a20 4e6f   'exception': No
+00004850: 6e65 2c20 2763 6f6d 706c 6574 6564 273a  ne, 'completed':
+00004860: 2046 616c 7365 7d20 290a 3e3e 2020 2066   False} ).>>   f
+00004870: 696e 6973 6865 643a 204e 6f64 6528 7261  inished: Node(ra
+00004880: 775f 6461 7461 5f73 696e 676c 655f 736f  w_data_single_so
+00004890: 7572 6365 3a20 7b27 7374 6174 6527 3a20  urce: {'state': 
+000048a0: 2753 5543 4345 5353 272c 2027 7265 7375  'SUCCESS', 'resu
+000048b0: 6c74 273a 205b 4461 7461 4672 616d 655b  lt': [DataFrame[
+000048c0: 6964 3a20 6269 6769 6e74 5d5d 2c20 2765  id: bigint]], 'e
+000048d0: 7863 6570 7469 6f6e 273a 204e 6f6e 652c  xception': None,
+000048e0: 2027 636f 6d70 6c65 7465 6427 3a20 5472   'completed': Tr
+000048f0: 7565 7d20 2920 2873 7469 6c6c 2072 756e  ue} ) (still run
+00004900: 6e69 6e67 3a20 3229 0a3e 3e20 2020 6669  ning: 2).>>   fi
+00004910: 6e69 7368 6564 3a20 4e6f 6465 2872 6177  nished: Node(raw
+00004920: 5f64 6174 615f 7369 6e67 6c65 5f73 6f75  _data_single_sou
+00004930: 7263 655f 7769 7468 5f63 7573 746f 6d5f  rce_with_custom_
+00004940: 6e61 6d65 3a20 7b27 7374 6174 6527 3a20  name: {'state': 
+00004950: 2753 5543 4345 5353 272c 2027 7265 7375  'SUCCESS', 'resu
+00004960: 6c74 273a 205b 4461 7461 4672 616d 655b  lt': [DataFrame[
+00004970: 6964 3a20 6269 6769 6e74 5d5d 2c20 2765  id: bigint]], 'e
+00004980: 7863 6570 7469 6f6e 273a 204e 6f6e 652c  xception': None,
+00004990: 2027 636f 6d70 6c65 7465 6427 3a20 5472   'completed': Tr
+000049a0: 7565 7d20 2920 2873 7469 6c6c 2072 756e  ue} ) (still run
+000049b0: 6e69 6e67 3a20 3129 0a3e 3e20 2020 7374  ning: 1).>>   st
+000049c0: 6172 7469 6e67 3a20 4e6f 6465 2863 6f6d  arting: Node(com
+000049d0: 6269 6e65 5f64 6174 613a 207b 2773 7461  bine_data: {'sta
+000049e0: 7465 273a 2027 5255 4e4e 494e 4727 2c20  te': 'RUNNING', 
+000049f0: 2772 6573 756c 7427 3a20 4e6f 6e65 2c20  'result': None, 
+00004a00: 2765 7863 6570 7469 6f6e 273a 204e 6f6e  'exception': Non
+00004a10: 652c 2027 636f 6d70 6c65 7465 6427 3a20  e, 'completed': 
+00004a20: 4661 6c73 657d 2029 0a3e 3e20 2020 6669  False} ).>>   fi
+00004a30: 6e69 7368 6564 3a20 4e6f 6465 2872 6177  nished: Node(raw
+00004a40: 5f64 6174 615f 6d75 6c74 695f 736f 7572  _data_multi_sour
+00004a50: 6365 3a20 7b27 7374 6174 6527 3a20 2753  ce: {'state': 'S
+00004a60: 5543 4345 5353 272c 2027 7265 7375 6c74  UCCESS', 'result
+00004a70: 273a 205b 4461 7461 4672 616d 655b 6964  ': [DataFrame[id
+00004a80: 3a20 6269 6769 6e74 5d2c 2044 6174 6146  : bigint], DataF
+00004a90: 7261 6d65 5b69 643a 2062 6967 696e 745d  rame[id: bigint]
+00004aa0: 5d2c 2027 6578 6365 7074 696f 6e27 3a20  ], 'exception': 
+00004ab0: 4e6f 6e65 2c20 2763 6f6d 706c 6574 6564  None, 'completed
+00004ac0: 273a 2054 7275 657d 2029 2028 7374 696c  ': True} ) (stil
+00004ad0: 6c20 7275 6e6e 696e 673a 2031 290a 3e3e  l running: 1).>>
+00004ae0: 2020 2073 7461 7274 696e 673a 204e 6f64     starting: Nod
+00004af0: 6528 7370 6c69 745f 6461 7461 3a20 7b27  e(split_data: {'
+00004b00: 7374 6174 6527 3a20 2752 554e 4e49 4e47  state': 'RUNNING
+00004b10: 272c 2027 7265 7375 6c74 273a 204e 6f6e  ', 'result': Non
+00004b20: 652c 2027 6578 6365 7074 696f 6e27 3a20  e, 'exception': 
+00004b30: 4e6f 6e65 2c20 2763 6f6d 706c 6574 6564  None, 'completed
+00004b40: 273a 2046 616c 7365 7d20 290a 3e3e 2020  ': False} ).>>  
+00004b50: 2066 696e 6973 6865 643a 204e 6f64 6528   finished: Node(
+00004b60: 636f 6d62 696e 655f 6461 7461 3a20 7b27  combine_data: {'
+00004b70: 7374 6174 6527 3a20 2753 5543 4345 5353  state': 'SUCCESS
+00004b80: 272c 2027 7265 7375 6c74 273a 205b 4461  ', 'result': [Da
+00004b90: 7461 4672 616d 655b 6964 3a20 6269 6769  taFrame[id: bigi
+00004ba0: 6e74 5d5d 2c20 2765 7863 6570 7469 6f6e  nt]], 'exception
+00004bb0: 273a 204e 6f6e 652c 2027 636f 6d70 6c65  ': None, 'comple
+00004bc0: 7465 6427 3a20 5472 7565 7d20 2920 2873  ted': True} ) (s
+00004bd0: 7469 6c6c 2072 756e 6e69 6e67 3a20 3129  till running: 1)
+00004be0: 0a3e 3e20 2020 6669 6e69 7368 6564 3a20  .>>   finished: 
+00004bf0: 4e6f 6465 2873 706c 6974 5f64 6174 613a  Node(split_data:
+00004c00: 207b 2773 7461 7465 273a 2027 5355 4343   {'state': 'SUCC
+00004c10: 4553 5327 2c20 2772 6573 756c 7427 3a20  ESS', 'result': 
+00004c20: 5b44 6174 6146 7261 6d65 5b69 643a 2062  [DataFrame[id: b
+00004c30: 6967 696e 745d 2c20 4461 7461 4672 616d  igint], DataFram
+00004c40: 655b 6964 3a20 6269 6769 6e74 5d5d 2c20  e[id: bigint]], 
+00004c50: 2765 7863 6570 7469 6f6e 273a 204e 6f6e  'exception': Non
+00004c60: 652c 2027 636f 6d70 6c65 7465 6427 3a20  e, 'completed': 
+00004c70: 5472 7565 7d20 2920 2873 7469 6c6c 2072  True} ) (still r
+00004c80: 756e 6e69 6e67 3a20 3029 0a3e 3e20 416c  unning: 0).>> Al
+00004c90: 6c20 7461 736b 7320 6669 6e69 7368 6564  l tasks finished
+00004ca0: 2c20 7368 7574 7469 6e67 2064 6f77 6e0a  , shutting down.
+00004cb0: 3e3e 2070 6970 656c 696e 6520 7265 7375  >> pipeline resu
+00004cc0: 6c74 733a 0a3e 3e20 5b72 6177 5f64 6174  lts:.>> [raw_dat
+00004cd0: 615f 7369 6e67 6c65 5f73 6f75 7263 652c  a_single_source,
+00004ce0: 2072 6177 5f64 6174 615f 7369 6e67 6c65   raw_data_single
+00004cf0: 5f73 6f75 7263 655f 7769 7468 5f63 7573  _source_with_cus
+00004d00: 746f 6d5f 6e61 6d65 2c20 7261 775f 6461  tom_name, raw_da
+00004d10: 7461 5f6d 756c 7469 5f73 6f75 7263 652c  ta_multi_source,
+00004d20: 2063 6f6d 6269 6e65 5f64 6174 612c 2073   combine_data, s
+00004d30: 706c 6974 5f64 6174 615d 0a3e 3e20 6576  plit_data].>> ev
+00004d40: 656e 206e 756d 6265 7273 3a0a 3e3e 205b  en numbers:.>> [
+00004d50: 526f 7728 6964 3d32 292c 2052 6f77 2869  Row(id=2), Row(i
+00004d60: 643d 3429 2c20 526f 7728 6964 3d36 292c  d=4), Row(id=6),
+00004d70: 2052 6f77 2869 643d 3829 2c20 526f 7728   Row(id=8), Row(
+00004d80: 6964 3d31 3030 292c 2052 6f77 2869 643d  id=100), Row(id=
+00004d90: 3130 3229 2c20 526f 7728 6964 3d31 3034  102), Row(id=104
+00004da0: 292c 2052 6f77 2869 643d 3130 3629 2c20  ), Row(id=106), 
+00004db0: 526f 7728 6964 3d31 3038 292c 2052 6f77  Row(id=108), Row
+00004dc0: 2869 643d 3130 3030 295d 0a3e 3e20 6f64  (id=1000)].>> od
+00004dd0: 6420 6e75 6d62 6572 733a 0a3e 3e20 5b52  d numbers:.>> [R
+00004de0: 6f77 2869 643d 3129 2c20 526f 7728 6964  ow(id=1), Row(id
+00004df0: 3d33 292c 2052 6f77 2869 643d 3529 2c20  =3), Row(id=5), 
+00004e00: 526f 7728 6964 3d37 292c 2052 6f77 2869  Row(id=7), Row(i
+00004e10: 643d 3929 2c20 526f 7728 6964 3d31 3031  d=9), Row(id=101
+00004e20: 292c 2052 6f77 2869 643d 3130 3329 2c20  ), Row(id=103), 
+00004e30: 526f 7728 6964 3d31 3035 292c 2052 6f77  Row(id=105), Row
+00004e40: 2869 643d 3130 3729 2c20 526f 7728 6964  (id=107), Row(id
+00004e50: 3d31 3039 295d 0a60 6060 0a0a 7069 7065  =109)].```..pipe
+00004e60: 6c69 6e65 2073 7465 7073 2061 7265 2072  line steps are r
+00004e70: 6572 756e 6162 6c65 2061 7320 616e 7920  erunable as any 
+00004e80: 6f72 6469 6e61 7279 2066 756e 6374 696f  ordinary functio
+00004e90: 6e3a 0a60 6060 7079 7468 6f6e 0a23 2074  n:.```python.# t
+00004ea0: 6f20 7265 7275 6e20 6769 7665 6e20 7374  o rerun given st
+00004eb0: 6570 2c20 6a75 7374 2065 7865 6375 7465  ep, just execute
+00004ec0: 2069 7420 6173 2069 6620 6974 2077 6173   it as if it was
+00004ed0: 2061 2070 7572 6520 6675 6e63 7469 6f6e   a pure function
+00004ee0: 0a23 2072 6574 7572 6e20 6973 2061 6c61  .# return is ala
+00004ef0: 7761 7973 2061 206c 6973 7420 6f66 2064  ways a list of d
+00004f00: 6174 6166 7261 6d73 2074 6861 7420 6769  ataframs that gi
+00004f10: 7665 6e20 4070 706e 2e73 7465 7020 7265  ven @ppn.step re
+00004f20: 7475 726e 730a 2320 6e6f 7465 3a20 7468  turns.# note: th
+00004f30: 6520 7370 6172 6b20 7669 6577 2027 7261  e spark view 'ra
+00004f40: 775f 6461 7461 5f73 696e 676c 655f 736f  w_data_single_so
+00004f50: 7572 6365 2720 7769 6c6c 2062 6520 7570  urce' will be up
+00004f60: 6461 7465 6420 7768 656e 2074 6869 7320  dated when this 
+00004f70: 6675 6e63 7469 6f6e 2066 696e 6973 6865  function finishe
+00004f80: 7320 2861 7320 7065 7220 6465 6669 6e74  s (as per defint
+00004f90: 696f 6e20 696e 2040 7070 6e2e 7374 6570  ion in @ppn.step
+00004fa0: 2061 626f 7665 290a 7261 775f 6461 7461   above).raw_data
+00004fb0: 5f73 696e 676c 655f 736f 7572 6365 2829  _single_source()
+00004fc0: 0a60 6060 0a                             .```.
```

### Comparing `bdq-0.0.1/bdq/bdq.egg-info/PKG-INFO` & `bdq-0.0.2/bdq/bdq.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 00000000: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
 00000010: 3a20 322e 310a 4e61 6d65 3a20 6264 710a  : 2.1.Name: bdq.
-00000020: 5665 7273 696f 6e3a 2030 2e30 2e31 0a53  Version: 0.0.1.S
+00000020: 5665 7273 696f 6e3a 2030 2e30 2e32 0a53  Version: 0.0.2.S
 00000030: 756d 6d61 7279 3a20 4269 6720 4461 7461  ummary: Big Data
 00000040: 2051 7561 6c69 7479 2c20 6120 7365 7420   Quality, a set 
 00000050: 6f66 2074 6f6f 6c73 2f66 756e 6374 696f  of tools/functio
 00000060: 6e20 7468 6174 2068 656c 7020 796f 7520  n that help you 
 00000070: 6576 6572 7920 6461 7920 6173 7365 7274  every day assert
 00000080: 2071 7561 6c69 7479 206f 6620 6461 7461   quality of data
 00000090: 7365 7473 2079 6f75 2068 6176 6520 7072  sets you have pr
@@ -837,463 +837,479 @@
 00003440: 7261 7068 2e6e 6f64 6528 6465 7065 6e64  raph.node(depend
 00003450: 735f 6f6e 3d5b 675d 290a 6465 6620 6928  s_on=[g]).def i(
 00003460: 293a 0a20 2070 7269 6e74 2822 7468 6973  ):.  print("this
 00003470: 2077 696c 6c20 6e65 7665 7220 6578 6563   will never exec
 00003480: 7574 6520 746f 6f22 290a 2020 7265 7475  ute too").  retu
 00003490: 726e 2022 7468 6973 2077 696c 6c20 6e65  rn "this will ne
 000034a0: 7665 7220 6578 6563 7574 6520 746f 6f22  ver execute too"
-000034b0: 0a0a 2365 7865 6375 7465 2044 4147 0a67  ..#execute DAG.g
-000034c0: 7261 7068 2e65 7865 6375 7465 286d 6178  raph.execute(max
-000034d0: 5f77 6f72 6b65 7273 3d31 3029 0a0a 2369  _workers=10)..#i
-000034e0: 7465 7261 7465 206f 7665 7220 7265 7375  terate over resu
-000034f0: 6c74 730a 7072 696e 7428 2249 7465 7261  lts.print("Itera
-00003500: 7465 206f 7665 7220 7265 7375 6c74 732e  te over results.
-00003510: 2e2e 2229 0a66 6f72 206e 6f64 6520 696e  ..").for node in
-00003520: 2067 7261 7068 2e6e 6f64 6573 3a0a 2020   graph.nodes:.  
-00003530: 7072 696e 7428 6e6f 6465 290a 0a3e 3e20  print(node)..>> 
-00003540: 5761 6974 696e 6720 666f 7220 616c 6c20  Waiting for all 
-00003550: 7461 736b 7320 746f 2066 696e 6973 682e  tasks to finish.
-00003560: 2e2e 0a3e 3e20 2020 7374 6172 7469 6e67  ...>>   starting
-00003570: 3a20 4e6f 6465 283c 6675 6e63 7469 6f6e  : Node(<function
-00003580: 2061 2061 7420 3078 3766 3530 6634 6239   a at 0x7f50f4b9
-00003590: 6565 3530 3e3a 207b 2773 7461 7465 273a  ee50>: {'state':
-000035a0: 2027 5255 4e4e 494e 4727 2c20 2772 6573   'RUNNING', 'res
-000035b0: 756c 7427 3a20 4e6f 6e65 2c20 2765 7863  ult': None, 'exc
-000035c0: 6570 7469 6f6e 273a 204e 6f6e 652c 2027  eption': None, '
-000035d0: 636f 6d70 6c65 7465 6427 3a20 4661 6c73  completed': Fals
-000035e0: 657d 2029 0a3e 3e20 2020 7374 6172 7469  e} ).>>   starti
-000035f0: 6e67 3a20 4e6f 6465 283c 6675 6e63 7469  ng: Node(<functi
-00003600: 6f6e 2062 2061 7420 3078 3766 3530 6634  on b at 0x7f50f4
-00003610: 6235 3330 3430 3e3a 207b 2773 7461 7465  b53040>: {'state
-00003620: 273a 2027 5255 4e4e 494e 4727 2c20 2772  ': 'RUNNING', 'r
-00003630: 6573 756c 7427 3a20 4e6f 6e65 2c20 2765  esult': None, 'e
-00003640: 7863 6570 7469 6f6e 273a 204e 6f6e 652c  xception': None,
-00003650: 2027 636f 6d70 6c65 7465 6427 3a20 4661   'completed': Fa
-00003660: 6c73 657d 2029 0a3e 3e20 2020 7374 6172  lse} ).>>   star
-00003670: 7469 6e67 3a20 4e6f 6465 283c 6675 6e63  ting: Node(<func
-00003680: 7469 6f6e 2065 2061 7420 3078 3766 3530  tion e at 0x7f50
-00003690: 6634 6235 3362 3830 3e3a 207b 2773 7461  f4b53b80>: {'sta
-000036a0: 7465 273a 2027 5255 4e4e 494e 4727 2c20  te': 'RUNNING', 
-000036b0: 2772 6573 756c 7427 3a20 4e6f 6e65 2c20  'result': None, 
-000036c0: 2765 7863 6570 7469 6f6e 273a 204e 6f6e  'exception': Non
-000036d0: 652c 2027 636f 6d70 6c65 7465 6427 3a20  e, 'completed': 
-000036e0: 4661 6c73 657d 2029 0a3e 3e20 2020 7374  False} ).>>   st
-000036f0: 6172 7469 6e67 3a20 4e6f 6465 283c 6675  arting: Node(<fu
-00003700: 6e63 7469 6f6e 2067 2061 7420 3078 3766  nction g at 0x7f
-00003710: 3530 6634 6235 3335 6530 3e3a 207b 2773  50f4b535e0>: {'s
-00003720: 7461 7465 273a 2027 5255 4e4e 494e 4727  tate': 'RUNNING'
-00003730: 2c20 2772 6573 756c 7427 3a20 4e6f 6e65  , 'result': None
-00003740: 2c20 2765 7863 6570 7469 6f6e 273a 204e  , 'exception': N
-00003750: 6f6e 652c 2027 636f 6d70 6c65 7465 6427  one, 'completed'
-00003760: 3a20 4661 6c73 657d 2029 0a3e 3e20 2020  : False} ).>>   
-00003770: 6669 6e69 7368 6564 3a20 4e6f 6465 283c  finished: Node(<
-00003780: 6675 6e63 7469 6f6e 2061 2061 7420 3078  function a at 0x
-00003790: 3766 3530 6634 6239 6565 3530 3e3a 207b  7f50f4b9ee50>: {
-000037a0: 2773 7461 7465 273a 2027 5355 4343 4553  'state': 'SUCCES
-000037b0: 5327 2c20 2772 6573 756c 7427 3a20 352c  S', 'result': 5,
-000037c0: 2027 6578 6365 7074 696f 6e27 3a20 4e6f   'exception': No
-000037d0: 6e65 2c20 2763 6f6d 706c 6574 6564 273a  ne, 'completed':
-000037e0: 2054 7275 657d 2029 2028 7374 696c 6c20   True} ) (still 
-000037f0: 7275 6e6e 696e 673a 2033 290a 3e3e 2020  running: 3).>>  
-00003800: 2073 7461 7274 696e 673a 204e 6f64 6528   starting: Node(
-00003810: 3c66 756e 6374 696f 6e20 6320 6174 2030  <function c at 0
-00003820: 7837 6635 3066 3462 3533 3463 303e 3a20  x7f50f4b534c0>: 
-00003830: 7b27 7374 6174 6527 3a20 2752 554e 4e49  {'state': 'RUNNI
-00003840: 4e47 272c 2027 7265 7375 6c74 273a 204e  NG', 'result': N
-00003850: 6f6e 652c 2027 6578 6365 7074 696f 6e27  one, 'exception'
-00003860: 3a20 4e6f 6e65 2c20 2763 6f6d 706c 6574  : None, 'complet
-00003870: 6564 273a 2046 616c 7365 7d20 290a 3e3e  ed': False} ).>>
-00003880: 2020 2066 696e 6973 6865 643a 204e 6f64     finished: Nod
-00003890: 6528 3c66 756e 6374 696f 6e20 6220 6174  e(<function b at
-000038a0: 2030 7837 6635 3066 3462 3533 3034 303e   0x7f50f4b53040>
-000038b0: 3a20 7b27 7374 6174 6527 3a20 2753 5543  : {'state': 'SUC
-000038c0: 4345 5353 272c 2027 7265 7375 6c74 273a  CESS', 'result':
-000038d0: 2027 6265 6565 7027 2c20 2765 7863 6570   'beeep', 'excep
-000038e0: 7469 6f6e 273a 204e 6f6e 652c 2027 636f  tion': None, 'co
-000038f0: 6d70 6c65 7465 6427 3a20 5472 7565 7d20  mpleted': True} 
-00003900: 2920 2873 7469 6c6c 2072 756e 6e69 6e67  ) (still running
-00003910: 3a20 3329 0a3e 3e20 2020 6572 726f 723a  : 3).>>   error:
-00003920: 204e 6f64 6528 3c66 756e 6374 696f 6e20   Node(<function 
-00003930: 6520 6174 2030 7837 6635 3066 3462 3533  e at 0x7f50f4b53
-00003940: 6238 303e 3a20 7b27 7374 6174 6527 3a20  b80>: {'state': 
-00003950: 2745 5252 4f52 272c 2027 7265 7375 6c74  'ERROR', 'result
-00003960: 273a 204e 6f6e 652c 2027 6578 6365 7074  ': None, 'except
-00003970: 696f 6e27 3a20 5661 6c75 6545 7272 6f72  ion': ValueError
-00003980: 2827 6f6d 672c 2063 7261 7368 2120 3527  ('omg, crash! 5'
-00003990: 292c 2027 636f 6d70 6c65 7465 6427 3a20  ), 'completed': 
-000039a0: 5472 7565 7d20 293a 206f 6d67 2c20 6372  True} ): omg, cr
-000039b0: 6173 6821 2035 2028 7374 696c 6c20 7275  ash! 5 (still ru
-000039c0: 6e6e 696e 673a 2032 290a 3e3e 2020 2066  nning: 2).>>   f
-000039d0: 696e 6973 6865 643a 204e 6f64 6528 3c66  inished: Node(<f
-000039e0: 756e 6374 696f 6e20 6720 6174 2030 7837  unction g at 0x7
-000039f0: 6635 3066 3462 3533 3565 303e 3a20 7b27  f50f4b535e0>: {'
-00003a00: 7374 6174 6527 3a20 2753 4b49 5050 4544  state': 'SKIPPED
-00003a10: 272c 2027 7265 7375 6c74 273a 203c 7468  ', 'result': <th
-00003a20: 7265 6164 696e 672e 4576 656e 7420 6f62  reading.Event ob
-00003a30: 6a65 6374 2061 7420 3078 3766 3530 6563  ject at 0x7f50ec
-00003a40: 3136 6339 6430 3e2c 2027 6578 6365 7074  16c9d0>, 'except
-00003a50: 696f 6e27 3a20 4e6f 6e65 2c20 2763 6f6d  ion': None, 'com
-00003a60: 706c 6574 6564 273a 2054 7275 657d 2029  pleted': True} )
-00003a70: 2028 7374 696c 6c20 7275 6e6e 696e 673a   (still running:
-00003a80: 2031 290a 3e3e 2020 2073 7461 7274 696e   1).>>   startin
-00003a90: 673a 204e 6f64 6528 3c66 756e 6374 696f  g: Node(<functio
-00003aa0: 6e20 6420 6174 2030 7837 6635 3066 3462  n d at 0x7f50f4b
-00003ab0: 3533 6136 303e 3a20 7b27 7374 6174 6527  53a60>: {'state'
-00003ac0: 3a20 2752 554e 4e49 4e47 272c 2027 7265  : 'RUNNING', 're
-00003ad0: 7375 6c74 273a 204e 6f6e 652c 2027 6578  sult': None, 'ex
-00003ae0: 6365 7074 696f 6e27 3a20 4e6f 6e65 2c20  ception': None, 
-00003af0: 2763 6f6d 706c 6574 6564 273a 2046 616c  'completed': Fal
-00003b00: 7365 7d20 290a 3e3e 2020 2066 696e 6973  se} ).>>   finis
-00003b10: 6865 643a 204e 6f64 6528 3c66 756e 6374  hed: Node(<funct
-00003b20: 696f 6e20 6320 6174 2030 7837 6635 3066  ion c at 0x7f50f
-00003b30: 3462 3533 3463 303e 3a20 7b27 7374 6174  4b534c0>: {'stat
-00003b40: 6527 3a20 2753 5543 4345 5353 272c 2027  e': 'SUCCESS', '
-00003b50: 7265 7375 6c74 273a 2038 2c20 2765 7863  result': 8, 'exc
-00003b60: 6570 7469 6f6e 273a 204e 6f6e 652c 2027  eption': None, '
-00003b70: 636f 6d70 6c65 7465 6427 3a20 5472 7565  completed': True
-00003b80: 7d20 2920 2873 7469 6c6c 2072 756e 6e69  } ) (still runni
-00003b90: 6e67 3a20 3129 0a3e 3e20 2020 6669 6e69  ng: 1).>>   fini
-00003ba0: 7368 6564 3a20 4e6f 6465 283c 6675 6e63  shed: Node(<func
-00003bb0: 7469 6f6e 2064 2061 7420 3078 3766 3530  tion d at 0x7f50
-00003bc0: 6634 6235 3361 3630 3e3a 207b 2773 7461  f4b53a60>: {'sta
-00003bd0: 7465 273a 2027 5355 4343 4553 5327 2c20  te': 'SUCCESS', 
-00003be0: 2772 6573 756c 7427 3a20 2767 206d 616e  'result': 'g man
-00003bf0: 2073 6179 3a20 6265 6565 7062 6565 6570   say: beeepbeeep
-00003c00: 6265 6565 7027 2c20 2765 7863 6570 7469  beeep', 'excepti
-00003c10: 6f6e 273a 204e 6f6e 652c 2027 636f 6d70  on': None, 'comp
-00003c20: 6c65 7465 6427 3a20 5472 7565 7d20 2920  leted': True} ) 
-00003c30: 2873 7469 6c6c 2072 756e 6e69 6e67 3a20  (still running: 
-00003c40: 3029 0a3e 3e20 416c 6c20 7461 736b 7320  0).>> All tasks 
-00003c50: 6669 6e69 7368 6564 2c20 7368 7574 7469  finished, shutti
-00003c60: 6e67 2064 6f77 6e0a 3e3e 0a3e 3e20 4974  ng down.>>.>> It
-00003c70: 6572 6174 6520 6f76 6572 2072 6573 756c  erate over resul
-00003c80: 7473 2e2e 2e0a 3e3e 204e 6f64 6528 3c66  ts....>> Node(<f
-00003c90: 756e 6374 696f 6e20 6120 6174 2030 7837  unction a at 0x7
-00003ca0: 6635 3066 3462 3965 6535 303e 3a20 7b27  f50f4b9ee50>: {'
-00003cb0: 7374 6174 6527 3a20 2753 5543 4345 5353  state': 'SUCCESS
-00003cc0: 272c 2027 7265 7375 6c74 273a 2035 2c20  ', 'result': 5, 
-00003cd0: 2765 7863 6570 7469 6f6e 273a 204e 6f6e  'exception': Non
-00003ce0: 652c 2027 636f 6d70 6c65 7465 6427 3a20  e, 'completed': 
-00003cf0: 5472 7565 7d20 290a 3e3e 204e 6f64 6528  True} ).>> Node(
-00003d00: 3c66 756e 6374 696f 6e20 6220 6174 2030  <function b at 0
-00003d10: 7837 6635 3066 3462 3533 3034 303e 3a20  x7f50f4b53040>: 
-00003d20: 7b27 7374 6174 6527 3a20 2753 5543 4345  {'state': 'SUCCE
-00003d30: 5353 272c 2027 7265 7375 6c74 273a 2027  SS', 'result': '
-00003d40: 6265 6565 7027 2c20 2765 7863 6570 7469  beeep', 'excepti
-00003d50: 6f6e 273a 204e 6f6e 652c 2027 636f 6d70  on': None, 'comp
-00003d60: 6c65 7465 6427 3a20 5472 7565 7d20 290a  leted': True} ).
-00003d70: 3e3e 204e 6f64 6528 3c66 756e 6374 696f  >> Node(<functio
-00003d80: 6e20 6320 6174 2030 7837 6635 3066 3462  n c at 0x7f50f4b
-00003d90: 3533 3463 303e 3a20 7b27 7374 6174 6527  534c0>: {'state'
-00003da0: 3a20 2753 5543 4345 5353 272c 2027 7265  : 'SUCCESS', 're
-00003db0: 7375 6c74 273a 2038 2c20 2765 7863 6570  sult': 8, 'excep
-00003dc0: 7469 6f6e 273a 204e 6f6e 652c 2027 636f  tion': None, 'co
-00003dd0: 6d70 6c65 7465 6427 3a20 5472 7565 7d20  mpleted': True} 
-00003de0: 290a 3e3e 204e 6f64 6528 3c66 756e 6374  ).>> Node(<funct
-00003df0: 696f 6e20 6420 6174 2030 7837 6635 3066  ion d at 0x7f50f
-00003e00: 3462 3533 6136 303e 3a20 7b27 7374 6174  4b53a60>: {'stat
-00003e10: 6527 3a20 2753 5543 4345 5353 272c 2027  e': 'SUCCESS', '
-00003e20: 7265 7375 6c74 273a 2027 6720 6d61 6e20  result': 'g man 
-00003e30: 7361 793a 2062 6565 6570 6265 6565 7062  say: beeepbeeepb
-00003e40: 6565 6570 272c 2027 6578 6365 7074 696f  eeep', 'exceptio
-00003e50: 6e27 3a20 4e6f 6e65 2c20 2763 6f6d 706c  n': None, 'compl
-00003e60: 6574 6564 273a 2054 7275 657d 2029 0a3e  eted': True} ).>
-00003e70: 3e20 4e6f 6465 283c 6675 6e63 7469 6f6e  > Node(<function
-00003e80: 2065 2061 7420 3078 3766 3530 6634 6235   e at 0x7f50f4b5
-00003e90: 3362 3830 3e3a 207b 2773 7461 7465 273a  3b80>: {'state':
-00003ea0: 2027 4552 524f 5227 2c20 2772 6573 756c   'ERROR', 'resul
-00003eb0: 7427 3a20 4e6f 6e65 2c20 2765 7863 6570  t': None, 'excep
-00003ec0: 7469 6f6e 273a 2056 616c 7565 4572 726f  tion': ValueErro
-00003ed0: 7228 276f 6d67 2c20 6372 6173 6821 2035  r('omg, crash! 5
-00003ee0: 2729 2c20 2763 6f6d 706c 6574 6564 273a  '), 'completed':
-00003ef0: 2054 7275 657d 2029 0a3e 3e20 4e6f 6465   True} ).>> Node
-00003f00: 283c 6675 6e63 7469 6f6e 2066 2061 7420  (<function f at 
-00003f10: 3078 3766 3530 6634 6235 3330 6430 3e3a  0x7f50f4b530d0>:
-00003f20: 207b 2773 7461 7465 273a 2027 534b 4950   {'state': 'SKIP
-00003f30: 5045 4427 2c20 2772 6573 756c 7427 3a20  PED', 'result': 
-00003f40: 4e6f 6e65 2c20 2765 7863 6570 7469 6f6e  None, 'exception
-00003f50: 273a 204e 6f6e 652c 2027 636f 6d70 6c65  ': None, 'comple
-00003f60: 7465 6427 3a20 4661 6c73 657d 2029 0a3e  ted': False} ).>
-00003f70: 3e20 4e6f 6465 283c 6675 6e63 7469 6f6e  > Node(<function
-00003f80: 2067 2061 7420 3078 3766 3530 6634 6235   g at 0x7f50f4b5
-00003f90: 3335 6530 3e3a 207b 2773 7461 7465 273a  35e0>: {'state':
-00003fa0: 2027 534b 4950 5045 4427 2c20 2772 6573   'SKIPPED', 'res
-00003fb0: 756c 7427 3a20 3c74 6872 6561 6469 6e67  ult': <threading
-00003fc0: 2e45 7665 6e74 206f 626a 6563 7420 6174  .Event object at
-00003fd0: 2030 7837 6635 3065 6331 3663 3964 303e   0x7f50ec16c9d0>
-00003fe0: 2c20 2765 7863 6570 7469 6f6e 273a 204e  , 'exception': N
-00003ff0: 6f6e 652c 2027 636f 6d70 6c65 7465 6427  one, 'completed'
-00004000: 3a20 5472 7565 7d20 290a 3e3e 204e 6f64  : True} ).>> Nod
-00004010: 6528 3c66 756e 6374 696f 6e20 6920 6174  e(<function i at
-00004020: 2030 7837 6635 3066 3462 3533 3238 303e   0x7f50f4b53280>
-00004030: 3a20 7b27 7374 6174 6527 3a20 2753 4b49  : {'state': 'SKI
-00004040: 5050 4544 272c 2027 7265 7375 6c74 273a  PPED', 'result':
-00004050: 204e 6f6e 652c 2027 6578 6365 7074 696f   None, 'exceptio
-00004060: 6e27 3a20 4e6f 6e65 2c20 2763 6f6d 706c  n': None, 'compl
-00004070: 6574 6564 273a 2046 616c 7365 7d20 290a  eted': False} ).
-00004080: 6060 600a 0a23 2320 4578 6563 7574 6520  ```..## Execute 
-00004090: 7370 6172 6b20 7069 7065 6c69 6e65 206f  spark pipeline o
-000040a0: 6620 6d75 6c74 6970 6c65 2073 7465 7073  f multiple steps
-000040b0: 0a75 7369 6e67 2044 4147 2063 6f6d 706f  .using DAG compo
-000040c0: 6e65 6e74 2074 6f20 6861 6e64 6c65 2070  nent to handle p
-000040d0: 6172 616c 6c65 6c20 6578 6563 7574 696f  arallel executio
-000040e0: 6e0a 6060 6070 7974 686f 6e0a 696d 706f  n.```python.impo
-000040f0: 7274 2062 6471 0a66 726f 6d20 6264 7120  rt bdq.from bdq 
-00004100: 696d 706f 7274 2073 7061 726b 2c20 7461  import spark, ta
-00004110: 626c 650a 0a70 706e 203d 2062 6471 2e53  ble..ppn = bdq.S
-00004120: 7061 726b 5069 7065 6c69 6e65 2873 7061  parkPipeline(spa
-00004130: 726b 2c20 2272 6574 6169 6c22 290a 0a23  rk, "retail")..#
-00004140: 2072 6574 7572 6e73 2064 6174 6166 7261   returns datafra
-00004150: 6d65 2c20 616e 6420 6372 6561 7465 7320  me, and creates 
-00004160: 7370 6172 6b20 7669 6577 2027 7261 775f  spark view 'raw_
-00004170: 6461 7461 5f73 696e 676c 655f 736f 7572  data_single_sour
-00004180: 6365 270a 4070 706e 2e73 7465 7028 290a  ce'.@ppn.step().
-00004190: 6465 6620 7261 775f 6461 7461 5f73 696e  def raw_data_sin
-000041a0: 676c 655f 736f 7572 6365 2870 293a 0a20  gle_source(p):. 
-000041b0: 2072 6574 7572 6e20 7370 6172 6b2e 7261   return spark.ra
-000041c0: 6e67 6528 312c 2031 3029 0a0a 2320 7265  nge(1, 10)..# re
-000041d0: 7475 726e 7320 6461 7461 6672 616d 652c  turns dataframe,
-000041e0: 2061 6e64 2063 7265 6174 6573 2073 7061   and creates spa
-000041f0: 726b 2076 6965 7720 2772 6177 5f6e 6963  rk view 'raw_nic
-00004200: 655f 6e61 6d65 270a 4070 706e 2e73 7465  e_name'.@ppn.ste
-00004210: 7028 7265 7475 726e 733d 5b22 7261 775f  p(returns=["raw_
-00004220: 6e69 6365 5f6e 616d 6522 5d29 0a64 6566  nice_name"]).def
-00004230: 2072 6177 5f64 6174 615f 7369 6e67 6c65   raw_data_single
-00004240: 5f73 6f75 7263 655f 7769 7468 5f63 7573  _source_with_cus
-00004250: 746f 6d5f 6e61 6d65 2870 293a 0a20 2072  tom_name(p):.  r
-00004260: 6574 7572 6e20 7370 6172 6b2e 7261 6e67  eturn spark.rang
-00004270: 6528 3130 302c 2031 3130 290a 0a23 2072  e(100, 110)..# r
-00004280: 6574 7572 6e73 2074 776f 2064 6174 6166  eturns two dataf
-00004290: 7261 6d65 732c 2061 6e64 2063 7265 6174  rames, and creat
-000042a0: 6573 2074 776f 2073 7061 726b 2076 6965  es two spark vie
-000042b0: 7773 2027 7261 775f 6461 7461 3127 2c20  ws 'raw_data1', 
-000042c0: 2772 6177 5f64 6174 6132 270a 4070 706e  'raw_data2'.@ppn
-000042d0: 2e73 7465 7028 7265 7475 726e 733d 5b22  .step(returns=["
-000042e0: 7261 775f 6461 7461 3122 2c20 2272 6177  raw_data1", "raw
-000042f0: 5f64 6174 6132 225d 290a 6465 6620 7261  _data2"]).def ra
-00004300: 775f 6461 7461 5f6d 756c 7469 5f73 6f75  w_data_multi_sou
-00004310: 7263 6528 7029 3a0a 2020 6466 3120 3d20  rce(p):.  df1 = 
-00004320: 7370 6172 6b2e 7261 6e67 6528 3130 3030  spark.range(1000
-00004330: 2c20 3230 3030 290a 2020 6466 3220 3d20  , 2000).  df2 = 
-00004340: 7370 6172 6b2e 7261 6e67 6528 3230 3030  spark.range(2000
-00004350: 2c20 3330 3030 290a 0a20 2072 6574 7572  , 3000)..  retur
-00004360: 6e20 5b64 6631 2c20 6466 325d 0a0a 2320  n [df1, df2]..# 
-00004370: 7761 6974 7320 666f 7220 7261 7720 6461  waits for raw da
-00004380: 7461 2073 6f75 7263 6573 2074 6f20 6669  ta sources to fi
-00004390: 6e69 7368 2c20 616e 6420 636f 6d62 696e  nish, and combin
-000043a0: 6573 2074 6865 2064 6174 6120 696e 746f  es the data into
-000043b0: 206f 6e65 2075 6e69 6f6e 6564 2076 6965   one unioned vie
-000043c0: 7720 6063 6f6d 6269 6e65 5f64 6174 6160  w `combine_data`
-000043d0: 0a23 206e 6f74 6520 7468 6174 2064 6570  .# note that dep
-000043e0: 656e 6465 6e63 6965 7320 6172 6520 7079  endencies are py
-000043f0: 7468 6f6e 2066 756e 6374 696f 6e73 2c20  thon functions, 
-00004400: 6e6f 7420 6e61 6d65 7320 6f66 2076 6965  not names of vie
-00004410: 7773 2028 544f 444f 3a20 746f 2068 616e  ws (TODO: to han
-00004420: 646c 6520 7669 6577 206e 616d 6573 2061  dle view names a
-00004430: 7320 7765 6c6c 290a 4070 706e 2e73 7465  s well).@ppn.ste
-00004440: 7028 6465 7065 6e64 735f 6f6e 3d5b 7261  p(depends_on=[ra
-00004450: 775f 6461 7461 5f73 696e 676c 655f 736f  w_data_single_so
-00004460: 7572 6365 2c20 7261 775f 6461 7461 5f73  urce, raw_data_s
-00004470: 696e 676c 655f 736f 7572 6365 5f77 6974  ingle_source_wit
-00004480: 685f 6375 7374 6f6d 5f6e 616d 652c 2072  h_custom_name, r
-00004490: 6177 5f64 6174 615f 6d75 6c74 695f 736f  aw_data_multi_so
-000044a0: 7572 6365 5d29 0a64 6566 2063 6f6d 6269  urce]).def combi
-000044b0: 6e65 5f64 6174 6128 7029 3a0a 2020 6466  ne_data(p):.  df
-000044c0: 203d 2074 6162 6c65 2827 7261 775f 6461   = table('raw_da
+000034b0: 0a0a 2320 6966 2079 6f75 2068 6176 6520  ..# if you have 
+000034c0: 6970 7964 6167 7265 6433 2069 6e73 7461  ipydagred3 insta
+000034d0: 6c6c 6564 2c20 796f 7520 6361 6e20 7365  lled, you can se
+000034e0: 6520 696e 2072 6561 6c20 7469 6d65 2073  e in real time s
+000034f0: 7461 7465 2063 6861 6e67 6573 206f 6620  tate changes of 
+00003500: 6561 6368 206f 6620 7468 6520 6e6f 6465  each of the node
+00003510: 730a 6469 7370 6c61 7928 6772 6170 682e  s.display(graph.
+00003520: 7669 7375 616c 697a 6528 2929 0a0a 2365  visualize())..#e
+00003530: 7865 6375 7465 2044 4147 0a67 7261 7068  xecute DAG.graph
+00003540: 2e65 7865 6375 7465 286d 6178 5f77 6f72  .execute(max_wor
+00003550: 6b65 7273 3d31 3029 0a0a 2369 7465 7261  kers=10)..#itera
+00003560: 7465 206f 7665 7220 7265 7375 6c74 730a  te over results.
+00003570: 7072 696e 7428 2249 7465 7261 7465 206f  print("Iterate o
+00003580: 7665 7220 7265 7375 6c74 732e 2e2e 2229  ver results...")
+00003590: 0a66 6f72 206e 6f64 6520 696e 2067 7261  .for node in gra
+000035a0: 7068 2e6e 6f64 6573 3a0a 2020 7072 696e  ph.nodes:.  prin
+000035b0: 7428 6e6f 6465 290a 0a3e 3e20 5761 6974  t(node)..>> Wait
+000035c0: 696e 6720 666f 7220 616c 6c20 7461 736b  ing for all task
+000035d0: 7320 746f 2066 696e 6973 682e 2e2e 0a3e  s to finish....>
+000035e0: 3e20 2020 7374 6172 7469 6e67 3a20 4e6f  >   starting: No
+000035f0: 6465 283c 6675 6e63 7469 6f6e 2061 2061  de(<function a a
+00003600: 7420 3078 3766 3530 6634 6239 6565 3530  t 0x7f50f4b9ee50
+00003610: 3e3a 207b 2773 7461 7465 273a 2027 5255  >: {'state': 'RU
+00003620: 4e4e 494e 4727 2c20 2772 6573 756c 7427  NNING', 'result'
+00003630: 3a20 4e6f 6e65 2c20 2765 7863 6570 7469  : None, 'excepti
+00003640: 6f6e 273a 204e 6f6e 652c 2027 636f 6d70  on': None, 'comp
+00003650: 6c65 7465 6427 3a20 4661 6c73 657d 2029  leted': False} )
+00003660: 0a3e 3e20 2020 7374 6172 7469 6e67 3a20  .>>   starting: 
+00003670: 4e6f 6465 283c 6675 6e63 7469 6f6e 2062  Node(<function b
+00003680: 2061 7420 3078 3766 3530 6634 6235 3330   at 0x7f50f4b530
+00003690: 3430 3e3a 207b 2773 7461 7465 273a 2027  40>: {'state': '
+000036a0: 5255 4e4e 494e 4727 2c20 2772 6573 756c  RUNNING', 'resul
+000036b0: 7427 3a20 4e6f 6e65 2c20 2765 7863 6570  t': None, 'excep
+000036c0: 7469 6f6e 273a 204e 6f6e 652c 2027 636f  tion': None, 'co
+000036d0: 6d70 6c65 7465 6427 3a20 4661 6c73 657d  mpleted': False}
+000036e0: 2029 0a3e 3e20 2020 7374 6172 7469 6e67   ).>>   starting
+000036f0: 3a20 4e6f 6465 283c 6675 6e63 7469 6f6e  : Node(<function
+00003700: 2065 2061 7420 3078 3766 3530 6634 6235   e at 0x7f50f4b5
+00003710: 3362 3830 3e3a 207b 2773 7461 7465 273a  3b80>: {'state':
+00003720: 2027 5255 4e4e 494e 4727 2c20 2772 6573   'RUNNING', 'res
+00003730: 756c 7427 3a20 4e6f 6e65 2c20 2765 7863  ult': None, 'exc
+00003740: 6570 7469 6f6e 273a 204e 6f6e 652c 2027  eption': None, '
+00003750: 636f 6d70 6c65 7465 6427 3a20 4661 6c73  completed': Fals
+00003760: 657d 2029 0a3e 3e20 2020 7374 6172 7469  e} ).>>   starti
+00003770: 6e67 3a20 4e6f 6465 283c 6675 6e63 7469  ng: Node(<functi
+00003780: 6f6e 2067 2061 7420 3078 3766 3530 6634  on g at 0x7f50f4
+00003790: 6235 3335 6530 3e3a 207b 2773 7461 7465  b535e0>: {'state
+000037a0: 273a 2027 5255 4e4e 494e 4727 2c20 2772  ': 'RUNNING', 'r
+000037b0: 6573 756c 7427 3a20 4e6f 6e65 2c20 2765  esult': None, 'e
+000037c0: 7863 6570 7469 6f6e 273a 204e 6f6e 652c  xception': None,
+000037d0: 2027 636f 6d70 6c65 7465 6427 3a20 4661   'completed': Fa
+000037e0: 6c73 657d 2029 0a3e 3e20 2020 6669 6e69  lse} ).>>   fini
+000037f0: 7368 6564 3a20 4e6f 6465 283c 6675 6e63  shed: Node(<func
+00003800: 7469 6f6e 2061 2061 7420 3078 3766 3530  tion a at 0x7f50
+00003810: 6634 6239 6565 3530 3e3a 207b 2773 7461  f4b9ee50>: {'sta
+00003820: 7465 273a 2027 5355 4343 4553 5327 2c20  te': 'SUCCESS', 
+00003830: 2772 6573 756c 7427 3a20 352c 2027 6578  'result': 5, 'ex
+00003840: 6365 7074 696f 6e27 3a20 4e6f 6e65 2c20  ception': None, 
+00003850: 2763 6f6d 706c 6574 6564 273a 2054 7275  'completed': Tru
+00003860: 657d 2029 2028 7374 696c 6c20 7275 6e6e  e} ) (still runn
+00003870: 696e 673a 2033 290a 3e3e 2020 2073 7461  ing: 3).>>   sta
+00003880: 7274 696e 673a 204e 6f64 6528 3c66 756e  rting: Node(<fun
+00003890: 6374 696f 6e20 6320 6174 2030 7837 6635  ction c at 0x7f5
+000038a0: 3066 3462 3533 3463 303e 3a20 7b27 7374  0f4b534c0>: {'st
+000038b0: 6174 6527 3a20 2752 554e 4e49 4e47 272c  ate': 'RUNNING',
+000038c0: 2027 7265 7375 6c74 273a 204e 6f6e 652c   'result': None,
+000038d0: 2027 6578 6365 7074 696f 6e27 3a20 4e6f   'exception': No
+000038e0: 6e65 2c20 2763 6f6d 706c 6574 6564 273a  ne, 'completed':
+000038f0: 2046 616c 7365 7d20 290a 3e3e 2020 2066   False} ).>>   f
+00003900: 696e 6973 6865 643a 204e 6f64 6528 3c66  inished: Node(<f
+00003910: 756e 6374 696f 6e20 6220 6174 2030 7837  unction b at 0x7
+00003920: 6635 3066 3462 3533 3034 303e 3a20 7b27  f50f4b53040>: {'
+00003930: 7374 6174 6527 3a20 2753 5543 4345 5353  state': 'SUCCESS
+00003940: 272c 2027 7265 7375 6c74 273a 2027 6265  ', 'result': 'be
+00003950: 6565 7027 2c20 2765 7863 6570 7469 6f6e  eep', 'exception
+00003960: 273a 204e 6f6e 652c 2027 636f 6d70 6c65  ': None, 'comple
+00003970: 7465 6427 3a20 5472 7565 7d20 2920 2873  ted': True} ) (s
+00003980: 7469 6c6c 2072 756e 6e69 6e67 3a20 3329  till running: 3)
+00003990: 0a3e 3e20 2020 6572 726f 723a 204e 6f64  .>>   error: Nod
+000039a0: 6528 3c66 756e 6374 696f 6e20 6520 6174  e(<function e at
+000039b0: 2030 7837 6635 3066 3462 3533 6238 303e   0x7f50f4b53b80>
+000039c0: 3a20 7b27 7374 6174 6527 3a20 2745 5252  : {'state': 'ERR
+000039d0: 4f52 272c 2027 7265 7375 6c74 273a 204e  OR', 'result': N
+000039e0: 6f6e 652c 2027 6578 6365 7074 696f 6e27  one, 'exception'
+000039f0: 3a20 5661 6c75 6545 7272 6f72 2827 6f6d  : ValueError('om
+00003a00: 672c 2063 7261 7368 2120 3527 292c 2027  g, crash! 5'), '
+00003a10: 636f 6d70 6c65 7465 6427 3a20 5472 7565  completed': True
+00003a20: 7d20 293a 206f 6d67 2c20 6372 6173 6821  } ): omg, crash!
+00003a30: 2035 2028 7374 696c 6c20 7275 6e6e 696e   5 (still runnin
+00003a40: 673a 2032 290a 3e3e 2020 2066 696e 6973  g: 2).>>   finis
+00003a50: 6865 643a 204e 6f64 6528 3c66 756e 6374  hed: Node(<funct
+00003a60: 696f 6e20 6720 6174 2030 7837 6635 3066  ion g at 0x7f50f
+00003a70: 3462 3533 3565 303e 3a20 7b27 7374 6174  4b535e0>: {'stat
+00003a80: 6527 3a20 2753 4b49 5050 4544 272c 2027  e': 'SKIPPED', '
+00003a90: 7265 7375 6c74 273a 203c 7468 7265 6164  result': <thread
+00003aa0: 696e 672e 4576 656e 7420 6f62 6a65 6374  ing.Event object
+00003ab0: 2061 7420 3078 3766 3530 6563 3136 6339   at 0x7f50ec16c9
+00003ac0: 6430 3e2c 2027 6578 6365 7074 696f 6e27  d0>, 'exception'
+00003ad0: 3a20 4e6f 6e65 2c20 2763 6f6d 706c 6574  : None, 'complet
+00003ae0: 6564 273a 2054 7275 657d 2029 2028 7374  ed': True} ) (st
+00003af0: 696c 6c20 7275 6e6e 696e 673a 2031 290a  ill running: 1).
+00003b00: 3e3e 2020 2073 7461 7274 696e 673a 204e  >>   starting: N
+00003b10: 6f64 6528 3c66 756e 6374 696f 6e20 6420  ode(<function d 
+00003b20: 6174 2030 7837 6635 3066 3462 3533 6136  at 0x7f50f4b53a6
+00003b30: 303e 3a20 7b27 7374 6174 6527 3a20 2752  0>: {'state': 'R
+00003b40: 554e 4e49 4e47 272c 2027 7265 7375 6c74  UNNING', 'result
+00003b50: 273a 204e 6f6e 652c 2027 6578 6365 7074  ': None, 'except
+00003b60: 696f 6e27 3a20 4e6f 6e65 2c20 2763 6f6d  ion': None, 'com
+00003b70: 706c 6574 6564 273a 2046 616c 7365 7d20  pleted': False} 
+00003b80: 290a 3e3e 2020 2066 696e 6973 6865 643a  ).>>   finished:
+00003b90: 204e 6f64 6528 3c66 756e 6374 696f 6e20   Node(<function 
+00003ba0: 6320 6174 2030 7837 6635 3066 3462 3533  c at 0x7f50f4b53
+00003bb0: 3463 303e 3a20 7b27 7374 6174 6527 3a20  4c0>: {'state': 
+00003bc0: 2753 5543 4345 5353 272c 2027 7265 7375  'SUCCESS', 'resu
+00003bd0: 6c74 273a 2038 2c20 2765 7863 6570 7469  lt': 8, 'excepti
+00003be0: 6f6e 273a 204e 6f6e 652c 2027 636f 6d70  on': None, 'comp
+00003bf0: 6c65 7465 6427 3a20 5472 7565 7d20 2920  leted': True} ) 
+00003c00: 2873 7469 6c6c 2072 756e 6e69 6e67 3a20  (still running: 
+00003c10: 3129 0a3e 3e20 2020 6669 6e69 7368 6564  1).>>   finished
+00003c20: 3a20 4e6f 6465 283c 6675 6e63 7469 6f6e  : Node(<function
+00003c30: 2064 2061 7420 3078 3766 3530 6634 6235   d at 0x7f50f4b5
+00003c40: 3361 3630 3e3a 207b 2773 7461 7465 273a  3a60>: {'state':
+00003c50: 2027 5355 4343 4553 5327 2c20 2772 6573   'SUCCESS', 'res
+00003c60: 756c 7427 3a20 2767 206d 616e 2073 6179  ult': 'g man say
+00003c70: 3a20 6265 6565 7062 6565 6570 6265 6565  : beeepbeeepbeee
+00003c80: 7027 2c20 2765 7863 6570 7469 6f6e 273a  p', 'exception':
+00003c90: 204e 6f6e 652c 2027 636f 6d70 6c65 7465   None, 'complete
+00003ca0: 6427 3a20 5472 7565 7d20 2920 2873 7469  d': True} ) (sti
+00003cb0: 6c6c 2072 756e 6e69 6e67 3a20 3029 0a3e  ll running: 0).>
+00003cc0: 3e20 416c 6c20 7461 736b 7320 6669 6e69  > All tasks fini
+00003cd0: 7368 6564 2c20 7368 7574 7469 6e67 2064  shed, shutting d
+00003ce0: 6f77 6e0a 3e3e 0a3e 3e20 4974 6572 6174  own.>>.>> Iterat
+00003cf0: 6520 6f76 6572 2072 6573 756c 7473 2e2e  e over results..
+00003d00: 2e0a 3e3e 204e 6f64 6528 3c66 756e 6374  ..>> Node(<funct
+00003d10: 696f 6e20 6120 6174 2030 7837 6635 3066  ion a at 0x7f50f
+00003d20: 3462 3965 6535 303e 3a20 7b27 7374 6174  4b9ee50>: {'stat
+00003d30: 6527 3a20 2753 5543 4345 5353 272c 2027  e': 'SUCCESS', '
+00003d40: 7265 7375 6c74 273a 2035 2c20 2765 7863  result': 5, 'exc
+00003d50: 6570 7469 6f6e 273a 204e 6f6e 652c 2027  eption': None, '
+00003d60: 636f 6d70 6c65 7465 6427 3a20 5472 7565  completed': True
+00003d70: 7d20 290a 3e3e 204e 6f64 6528 3c66 756e  } ).>> Node(<fun
+00003d80: 6374 696f 6e20 6220 6174 2030 7837 6635  ction b at 0x7f5
+00003d90: 3066 3462 3533 3034 303e 3a20 7b27 7374  0f4b53040>: {'st
+00003da0: 6174 6527 3a20 2753 5543 4345 5353 272c  ate': 'SUCCESS',
+00003db0: 2027 7265 7375 6c74 273a 2027 6265 6565   'result': 'beee
+00003dc0: 7027 2c20 2765 7863 6570 7469 6f6e 273a  p', 'exception':
+00003dd0: 204e 6f6e 652c 2027 636f 6d70 6c65 7465   None, 'complete
+00003de0: 6427 3a20 5472 7565 7d20 290a 3e3e 204e  d': True} ).>> N
+00003df0: 6f64 6528 3c66 756e 6374 696f 6e20 6320  ode(<function c 
+00003e00: 6174 2030 7837 6635 3066 3462 3533 3463  at 0x7f50f4b534c
+00003e10: 303e 3a20 7b27 7374 6174 6527 3a20 2753  0>: {'state': 'S
+00003e20: 5543 4345 5353 272c 2027 7265 7375 6c74  UCCESS', 'result
+00003e30: 273a 2038 2c20 2765 7863 6570 7469 6f6e  ': 8, 'exception
+00003e40: 273a 204e 6f6e 652c 2027 636f 6d70 6c65  ': None, 'comple
+00003e50: 7465 6427 3a20 5472 7565 7d20 290a 3e3e  ted': True} ).>>
+00003e60: 204e 6f64 6528 3c66 756e 6374 696f 6e20   Node(<function 
+00003e70: 6420 6174 2030 7837 6635 3066 3462 3533  d at 0x7f50f4b53
+00003e80: 6136 303e 3a20 7b27 7374 6174 6527 3a20  a60>: {'state': 
+00003e90: 2753 5543 4345 5353 272c 2027 7265 7375  'SUCCESS', 'resu
+00003ea0: 6c74 273a 2027 6720 6d61 6e20 7361 793a  lt': 'g man say:
+00003eb0: 2062 6565 6570 6265 6565 7062 6565 6570   beeepbeeepbeeep
+00003ec0: 272c 2027 6578 6365 7074 696f 6e27 3a20  ', 'exception': 
+00003ed0: 4e6f 6e65 2c20 2763 6f6d 706c 6574 6564  None, 'completed
+00003ee0: 273a 2054 7275 657d 2029 0a3e 3e20 4e6f  ': True} ).>> No
+00003ef0: 6465 283c 6675 6e63 7469 6f6e 2065 2061  de(<function e a
+00003f00: 7420 3078 3766 3530 6634 6235 3362 3830  t 0x7f50f4b53b80
+00003f10: 3e3a 207b 2773 7461 7465 273a 2027 4552  >: {'state': 'ER
+00003f20: 524f 5227 2c20 2772 6573 756c 7427 3a20  ROR', 'result': 
+00003f30: 4e6f 6e65 2c20 2765 7863 6570 7469 6f6e  None, 'exception
+00003f40: 273a 2056 616c 7565 4572 726f 7228 276f  ': ValueError('o
+00003f50: 6d67 2c20 6372 6173 6821 2035 2729 2c20  mg, crash! 5'), 
+00003f60: 2763 6f6d 706c 6574 6564 273a 2054 7275  'completed': Tru
+00003f70: 657d 2029 0a3e 3e20 4e6f 6465 283c 6675  e} ).>> Node(<fu
+00003f80: 6e63 7469 6f6e 2066 2061 7420 3078 3766  nction f at 0x7f
+00003f90: 3530 6634 6235 3330 6430 3e3a 207b 2773  50f4b530d0>: {'s
+00003fa0: 7461 7465 273a 2027 534b 4950 5045 4427  tate': 'SKIPPED'
+00003fb0: 2c20 2772 6573 756c 7427 3a20 4e6f 6e65  , 'result': None
+00003fc0: 2c20 2765 7863 6570 7469 6f6e 273a 204e  , 'exception': N
+00003fd0: 6f6e 652c 2027 636f 6d70 6c65 7465 6427  one, 'completed'
+00003fe0: 3a20 4661 6c73 657d 2029 0a3e 3e20 4e6f  : False} ).>> No
+00003ff0: 6465 283c 6675 6e63 7469 6f6e 2067 2061  de(<function g a
+00004000: 7420 3078 3766 3530 6634 6235 3335 6530  t 0x7f50f4b535e0
+00004010: 3e3a 207b 2773 7461 7465 273a 2027 534b  >: {'state': 'SK
+00004020: 4950 5045 4427 2c20 2772 6573 756c 7427  IPPED', 'result'
+00004030: 3a20 3c74 6872 6561 6469 6e67 2e45 7665  : <threading.Eve
+00004040: 6e74 206f 626a 6563 7420 6174 2030 7837  nt object at 0x7
+00004050: 6635 3065 6331 3663 3964 303e 2c20 2765  f50ec16c9d0>, 'e
+00004060: 7863 6570 7469 6f6e 273a 204e 6f6e 652c  xception': None,
+00004070: 2027 636f 6d70 6c65 7465 6427 3a20 5472   'completed': Tr
+00004080: 7565 7d20 290a 3e3e 204e 6f64 6528 3c66  ue} ).>> Node(<f
+00004090: 756e 6374 696f 6e20 6920 6174 2030 7837  unction i at 0x7
+000040a0: 6635 3066 3462 3533 3238 303e 3a20 7b27  f50f4b53280>: {'
+000040b0: 7374 6174 6527 3a20 2753 4b49 5050 4544  state': 'SKIPPED
+000040c0: 272c 2027 7265 7375 6c74 273a 204e 6f6e  ', 'result': Non
+000040d0: 652c 2027 6578 6365 7074 696f 6e27 3a20  e, 'exception': 
+000040e0: 4e6f 6e65 2c20 2763 6f6d 706c 6574 6564  None, 'completed
+000040f0: 273a 2046 616c 7365 7d20 290a 6060 600a  ': False} ).```.
+00004100: 0a23 2320 4578 6563 7574 6520 7370 6172  .## Execute spar
+00004110: 6b20 7069 7065 6c69 6e65 206f 6620 6d75  k pipeline of mu
+00004120: 6c74 6970 6c65 2073 7465 7073 0a75 7369  ltiple steps.usi
+00004130: 6e67 2044 4147 2063 6f6d 706f 6e65 6e74  ng DAG component
+00004140: 2074 6f20 6861 6e64 6c65 2070 6172 616c   to handle paral
+00004150: 6c65 6c20 6578 6563 7574 696f 6e0a 6060  lel execution.``
+00004160: 6070 7974 686f 6e0a 696d 706f 7274 2062  `python.import b
+00004170: 6471 0a66 726f 6d20 6264 7120 696d 706f  dq.from bdq impo
+00004180: 7274 2073 7061 726b 2c20 7461 626c 650a  rt spark, table.
+00004190: 0a70 706e 203d 2062 6471 2e53 7061 726b  .ppn = bdq.Spark
+000041a0: 5069 7065 6c69 6e65 2873 7061 726b 2c20  Pipeline(spark, 
+000041b0: 2272 6574 6169 6c22 290a 0a23 2072 6574  "retail")..# ret
+000041c0: 7572 6e73 2064 6174 6166 7261 6d65 2c20  urns dataframe, 
+000041d0: 616e 6420 6372 6561 7465 7320 7370 6172  and creates spar
+000041e0: 6b20 7669 6577 2027 7261 775f 6461 7461  k view 'raw_data
+000041f0: 5f73 696e 676c 655f 736f 7572 6365 270a  _single_source'.
+00004200: 4070 706e 2e73 7465 7028 290a 6465 6620  @ppn.step().def 
+00004210: 7261 775f 6461 7461 5f73 696e 676c 655f  raw_data_single_
+00004220: 736f 7572 6365 2870 293a 0a20 2072 6574  source(p):.  ret
+00004230: 7572 6e20 7370 6172 6b2e 7261 6e67 6528  urn spark.range(
+00004240: 312c 2031 3029 0a0a 2320 7265 7475 726e  1, 10)..# return
+00004250: 7320 6461 7461 6672 616d 652c 2061 6e64  s dataframe, and
+00004260: 2063 7265 6174 6573 2073 7061 726b 2076   creates spark v
+00004270: 6965 7720 2772 6177 5f6e 6963 655f 6e61  iew 'raw_nice_na
+00004280: 6d65 270a 4070 706e 2e73 7465 7028 7265  me'.@ppn.step(re
+00004290: 7475 726e 733d 5b22 7261 775f 6e69 6365  turns=["raw_nice
+000042a0: 5f6e 616d 6522 5d29 0a64 6566 2072 6177  _name"]).def raw
+000042b0: 5f64 6174 615f 7369 6e67 6c65 5f73 6f75  _data_single_sou
+000042c0: 7263 655f 7769 7468 5f63 7573 746f 6d5f  rce_with_custom_
+000042d0: 6e61 6d65 2870 293a 0a20 2072 6574 7572  name(p):.  retur
+000042e0: 6e20 7370 6172 6b2e 7261 6e67 6528 3130  n spark.range(10
+000042f0: 302c 2031 3130 290a 0a23 2072 6574 7572  0, 110)..# retur
+00004300: 6e73 2074 776f 2064 6174 6166 7261 6d65  ns two dataframe
+00004310: 732c 2061 6e64 2063 7265 6174 6573 2074  s, and creates t
+00004320: 776f 2073 7061 726b 2076 6965 7773 2027  wo spark views '
+00004330: 7261 775f 6461 7461 3127 2c20 2772 6177  raw_data1', 'raw
+00004340: 5f64 6174 6132 270a 4070 706e 2e73 7465  _data2'.@ppn.ste
+00004350: 7028 7265 7475 726e 733d 5b22 7261 775f  p(returns=["raw_
+00004360: 6461 7461 3122 2c20 2272 6177 5f64 6174  data1", "raw_dat
+00004370: 6132 225d 290a 6465 6620 7261 775f 6461  a2"]).def raw_da
+00004380: 7461 5f6d 756c 7469 5f73 6f75 7263 6528  ta_multi_source(
+00004390: 7029 3a0a 2020 6466 3120 3d20 7370 6172  p):.  df1 = spar
+000043a0: 6b2e 7261 6e67 6528 3130 3030 2c20 3230  k.range(1000, 20
+000043b0: 3030 290a 2020 6466 3220 3d20 7370 6172  00).  df2 = spar
+000043c0: 6b2e 7261 6e67 6528 3230 3030 2c20 3330  k.range(2000, 30
+000043d0: 3030 290a 0a20 2072 6574 7572 6e20 5b64  00)..  return [d
+000043e0: 6631 2c20 6466 325d 0a0a 2320 7761 6974  f1, df2]..# wait
+000043f0: 7320 666f 7220 7261 7720 6461 7461 2073  s for raw data s
+00004400: 6f75 7263 6573 2074 6f20 6669 6e69 7368  ources to finish
+00004410: 2c20 616e 6420 636f 6d62 696e 6573 2074  , and combines t
+00004420: 6865 2064 6174 6120 696e 746f 206f 6e65  he data into one
+00004430: 2075 6e69 6f6e 6564 2076 6965 7720 6063   unioned view `c
+00004440: 6f6d 6269 6e65 5f64 6174 6160 0a23 206e  ombine_data`.# n
+00004450: 6f74 6520 7468 6174 2064 6570 656e 6465  ote that depende
+00004460: 6e63 6965 7320 6172 6520 7079 7468 6f6e  ncies are python
+00004470: 2066 756e 6374 696f 6e73 2c20 6e6f 7420   functions, not 
+00004480: 6e61 6d65 7320 6f66 2076 6965 7773 2028  names of views (
+00004490: 544f 444f 3a20 746f 2068 616e 646c 6520  TODO: to handle 
+000044a0: 7669 6577 206e 616d 6573 2061 7320 7765  view names as we
+000044b0: 6c6c 290a 4070 706e 2e73 7465 7028 6465  ll).@ppn.step(de
+000044c0: 7065 6e64 735f 6f6e 3d5b 7261 775f 6461  pends_on=[raw_da
 000044d0: 7461 5f73 696e 676c 655f 736f 7572 6365  ta_single_source
-000044e0: 2729 205c 0a20 2020 202e 756e 696f 6e28  ') \.    .union(
-000044f0: 7461 626c 6528 2772 6177 5f6e 6963 655f  table('raw_nice_
-00004500: 6e61 6d65 2729 2920 5c0a 2020 2020 2e75  name')) \.    .u
-00004510: 6e69 6f6e 2874 6162 6c65 2827 7261 775f  nion(table('raw_
-00004520: 6461 7461 3127 2929 205c 0a20 2020 202e  data1')) \.    .
-00004530: 756e 696f 6e28 7461 626c 6528 2772 6177  union(table('raw
-00004540: 5f64 6174 6132 2729 290a 0a20 2072 6574  _data2'))..  ret
-00004550: 7572 6e20 6466 0a0a 2320 7370 6c69 7473  urn df..# splits
-00004560: 2074 6865 2063 6f6d 6269 6e65 645f 6461   the combined_da
-00004570: 7461 2069 6e74 6f20 276f 6464 2720 616e  ta into 'odd' an
-00004580: 6420 2765 7665 6e27 2076 6965 7773 0a40  d 'even' views.@
-00004590: 7070 6e2e 7374 6570 2864 6570 656e 6473  ppn.step(depends
-000045a0: 5f6f 6e3d 5b63 6f6d 6269 6e65 5f64 6174  _on=[combine_dat
-000045b0: 615d 2c20 7265 7475 726e 733d 5b27 6f64  a], returns=['od
-000045c0: 6427 2c20 2765 7665 6e27 5d29 0a64 6566  d', 'even']).def
-000045d0: 2073 706c 6974 5f64 6174 6128 7029 3a0a   split_data(p):.
-000045e0: 2020 6466 5f6f 6464 203d 2074 6162 6c65    df_odd = table
-000045f0: 2827 636f 6d62 696e 655f 6461 7461 2729  ('combine_data')
-00004600: 2e66 696c 7465 7228 2769 6420 2520 3220  .filter('id % 2 
-00004610: 3d3d 2031 2729 0a20 2064 665f 6576 656e  == 1').  df_even
-00004620: 203d 2074 6162 6c65 2827 636f 6d62 696e   = table('combin
-00004630: 655f 6461 7461 2729 2e66 696c 7465 7228  e_data').filter(
-00004640: 2769 6420 2520 3220 3d3d 2030 2729 0a0a  'id % 2 == 0')..
-00004650: 2020 7265 7475 726e 205b 2064 665f 6f64    return [ df_od
-00004660: 642c 2064 665f 6576 656e 205d 0a0a 2320  d, df_even ]..# 
-00004670: 6578 6563 7574 6573 2070 6970 656c 696e  executes pipelin
-00004680: 6520 7573 696e 6720 636f 6e63 7572 7265  e using concurre
-00004690: 6e74 2074 6872 6561 6473 2c20 6f6e 6520  nt threads, one 
-000046a0: 7065 7220 6561 6368 2073 7465 702c 2066  per each step, f
-000046b0: 6f6c 6c6f 7769 6e67 2074 6865 2064 6570  ollowing the dep
-000046c0: 656e 6465 6e63 7920 4441 470a 2320 7069  endency DAG.# pi
-000046d0: 7065 6c69 6e65 2069 7320 6120 6e6f 726d  peline is a norm
-000046e0: 616c 2070 7974 686f 6e20 6361 6c6c 6162  al python callab
-000046f0: 6c65 206f 626a 6563 742c 2061 7320 6966  le object, as if
-00004700: 2069 7420 7761 7320 6120 6675 6e63 7469   it was a functi
-00004710: 6f6e 2c20 6974 2072 6574 7572 6e73 2061  on, it returns a
-00004720: 206c 6973 7420 6f66 2061 6c6c 2073 7465   list of all ste
-00004730: 7073 0a70 6970 656c 696e 655f 7265 7375  ps.pipeline_resu
-00004740: 6c74 7320 3d20 7070 6e28 6d61 785f 636f  lts = ppn(max_co
-00004750: 6e63 7572 7265 6e74 5f73 7465 7073 3d31  ncurrent_steps=1
-00004760: 3029 0a0a 7072 696e 7428 2770 6970 656c  0)..print('pipel
-00004770: 696e 6520 7265 7375 6c74 733a 2729 0a70  ine results:').p
-00004780: 7269 6e74 2870 6970 656c 696e 655f 7265  rint(pipeline_re
-00004790: 7375 6c74 7329 0a0a 2373 686f 7720 736f  sults)..#show so
-000047a0: 6d65 2066 696e 616c 2076 616c 7565 730a  me final values.
-000047b0: 7072 696e 7428 2765 7665 6e20 6e75 6d62  print('even numb
-000047c0: 6572 733a 2729 0a70 7269 6e74 2874 6162  ers:').print(tab
-000047d0: 6c65 2827 6576 656e 2729 2e6c 696d 6974  le('even').limit
-000047e0: 2831 3029 2e63 6f6c 6c65 6374 2829 290a  (10).collect()).
-000047f0: 7072 696e 7428 276f 6464 206e 756d 6265  print('odd numbe
-00004800: 7273 3a27 290a 7072 696e 7428 7461 626c  rs:').print(tabl
-00004810: 6528 276f 6464 2729 2e6c 696d 6974 2831  e('odd').limit(1
-00004820: 3029 2e63 6f6c 6c65 6374 2829 290a 0a3e  0).collect())..>
-00004830: 3e20 5761 6974 696e 6720 666f 7220 616c  > Waiting for al
-00004840: 6c20 7461 736b 7320 746f 2066 696e 6973  l tasks to finis
-00004850: 682e 2e2e 0a3e 3e20 2020 7374 6172 7469  h....>>   starti
-00004860: 6e67 3a20 4e6f 6465 2872 6177 5f64 6174  ng: Node(raw_dat
-00004870: 615f 7369 6e67 6c65 5f73 6f75 7263 653a  a_single_source:
-00004880: 207b 2773 7461 7465 273a 2027 5255 4e4e   {'state': 'RUNN
-00004890: 494e 4727 2c20 2772 6573 756c 7427 3a20  ING', 'result': 
-000048a0: 4e6f 6e65 2c20 2765 7863 6570 7469 6f6e  None, 'exception
-000048b0: 273a 204e 6f6e 652c 2027 636f 6d70 6c65  ': None, 'comple
-000048c0: 7465 6427 3a20 4661 6c73 657d 2029 0a3e  ted': False} ).>
-000048d0: 3e20 2020 7374 6172 7469 6e67 3a20 4e6f  >   starting: No
-000048e0: 6465 2872 6177 5f64 6174 615f 7369 6e67  de(raw_data_sing
-000048f0: 6c65 5f73 6f75 7263 655f 7769 7468 5f63  le_source_with_c
-00004900: 7573 746f 6d5f 6e61 6d65 3a20 7b27 7374  ustom_name: {'st
-00004910: 6174 6527 3a20 2752 554e 4e49 4e47 272c  ate': 'RUNNING',
-00004920: 2027 7265 7375 6c74 273a 204e 6f6e 652c   'result': None,
-00004930: 2027 6578 6365 7074 696f 6e27 3a20 4e6f   'exception': No
-00004940: 6e65 2c20 2763 6f6d 706c 6574 6564 273a  ne, 'completed':
-00004950: 2046 616c 7365 7d20 290a 3e3e 2020 2073   False} ).>>   s
-00004960: 7461 7274 696e 673a 204e 6f64 6528 7261  tarting: Node(ra
-00004970: 775f 6461 7461 5f6d 756c 7469 5f73 6f75  w_data_multi_sou
-00004980: 7263 653a 207b 2773 7461 7465 273a 2027  rce: {'state': '
-00004990: 5255 4e4e 494e 4727 2c20 2772 6573 756c  RUNNING', 'resul
-000049a0: 7427 3a20 4e6f 6e65 2c20 2765 7863 6570  t': None, 'excep
-000049b0: 7469 6f6e 273a 204e 6f6e 652c 2027 636f  tion': None, 'co
-000049c0: 6d70 6c65 7465 6427 3a20 4661 6c73 657d  mpleted': False}
-000049d0: 2029 0a3e 3e20 2020 6669 6e69 7368 6564   ).>>   finished
-000049e0: 3a20 4e6f 6465 2872 6177 5f64 6174 615f  : Node(raw_data_
-000049f0: 7369 6e67 6c65 5f73 6f75 7263 653a 207b  single_source: {
-00004a00: 2773 7461 7465 273a 2027 5355 4343 4553  'state': 'SUCCES
-00004a10: 5327 2c20 2772 6573 756c 7427 3a20 5b44  S', 'result': [D
-00004a20: 6174 6146 7261 6d65 5b69 643a 2062 6967  ataFrame[id: big
-00004a30: 696e 745d 5d2c 2027 6578 6365 7074 696f  int]], 'exceptio
-00004a40: 6e27 3a20 4e6f 6e65 2c20 2763 6f6d 706c  n': None, 'compl
-00004a50: 6574 6564 273a 2054 7275 657d 2029 2028  eted': True} ) (
-00004a60: 7374 696c 6c20 7275 6e6e 696e 673a 2032  still running: 2
-00004a70: 290a 3e3e 2020 2066 696e 6973 6865 643a  ).>>   finished:
-00004a80: 204e 6f64 6528 7261 775f 6461 7461 5f73   Node(raw_data_s
-00004a90: 696e 676c 655f 736f 7572 6365 5f77 6974  ingle_source_wit
-00004aa0: 685f 6375 7374 6f6d 5f6e 616d 653a 207b  h_custom_name: {
-00004ab0: 2773 7461 7465 273a 2027 5355 4343 4553  'state': 'SUCCES
-00004ac0: 5327 2c20 2772 6573 756c 7427 3a20 5b44  S', 'result': [D
-00004ad0: 6174 6146 7261 6d65 5b69 643a 2062 6967  ataFrame[id: big
-00004ae0: 696e 745d 5d2c 2027 6578 6365 7074 696f  int]], 'exceptio
-00004af0: 6e27 3a20 4e6f 6e65 2c20 2763 6f6d 706c  n': None, 'compl
-00004b00: 6574 6564 273a 2054 7275 657d 2029 2028  eted': True} ) (
-00004b10: 7374 696c 6c20 7275 6e6e 696e 673a 2031  still running: 1
-00004b20: 290a 3e3e 2020 2073 7461 7274 696e 673a  ).>>   starting:
-00004b30: 204e 6f64 6528 636f 6d62 696e 655f 6461   Node(combine_da
-00004b40: 7461 3a20 7b27 7374 6174 6527 3a20 2752  ta: {'state': 'R
-00004b50: 554e 4e49 4e47 272c 2027 7265 7375 6c74  UNNING', 'result
-00004b60: 273a 204e 6f6e 652c 2027 6578 6365 7074  ': None, 'except
-00004b70: 696f 6e27 3a20 4e6f 6e65 2c20 2763 6f6d  ion': None, 'com
-00004b80: 706c 6574 6564 273a 2046 616c 7365 7d20  pleted': False} 
-00004b90: 290a 3e3e 2020 2066 696e 6973 6865 643a  ).>>   finished:
-00004ba0: 204e 6f64 6528 7261 775f 6461 7461 5f6d   Node(raw_data_m
-00004bb0: 756c 7469 5f73 6f75 7263 653a 207b 2773  ulti_source: {'s
-00004bc0: 7461 7465 273a 2027 5355 4343 4553 5327  tate': 'SUCCESS'
-00004bd0: 2c20 2772 6573 756c 7427 3a20 5b44 6174  , 'result': [Dat
-00004be0: 6146 7261 6d65 5b69 643a 2062 6967 696e  aFrame[id: bigin
-00004bf0: 745d 2c20 4461 7461 4672 616d 655b 6964  t], DataFrame[id
-00004c00: 3a20 6269 6769 6e74 5d5d 2c20 2765 7863  : bigint]], 'exc
-00004c10: 6570 7469 6f6e 273a 204e 6f6e 652c 2027  eption': None, '
-00004c20: 636f 6d70 6c65 7465 6427 3a20 5472 7565  completed': True
-00004c30: 7d20 2920 2873 7469 6c6c 2072 756e 6e69  } ) (still runni
-00004c40: 6e67 3a20 3129 0a3e 3e20 2020 7374 6172  ng: 1).>>   star
-00004c50: 7469 6e67 3a20 4e6f 6465 2873 706c 6974  ting: Node(split
-00004c60: 5f64 6174 613a 207b 2773 7461 7465 273a  _data: {'state':
-00004c70: 2027 5255 4e4e 494e 4727 2c20 2772 6573   'RUNNING', 'res
-00004c80: 756c 7427 3a20 4e6f 6e65 2c20 2765 7863  ult': None, 'exc
-00004c90: 6570 7469 6f6e 273a 204e 6f6e 652c 2027  eption': None, '
-00004ca0: 636f 6d70 6c65 7465 6427 3a20 4661 6c73  completed': Fals
-00004cb0: 657d 2029 0a3e 3e20 2020 6669 6e69 7368  e} ).>>   finish
-00004cc0: 6564 3a20 4e6f 6465 2863 6f6d 6269 6e65  ed: Node(combine
-00004cd0: 5f64 6174 613a 207b 2773 7461 7465 273a  _data: {'state':
-00004ce0: 2027 5355 4343 4553 5327 2c20 2772 6573   'SUCCESS', 'res
-00004cf0: 756c 7427 3a20 5b44 6174 6146 7261 6d65  ult': [DataFrame
-00004d00: 5b69 643a 2062 6967 696e 745d 5d2c 2027  [id: bigint]], '
-00004d10: 6578 6365 7074 696f 6e27 3a20 4e6f 6e65  exception': None
-00004d20: 2c20 2763 6f6d 706c 6574 6564 273a 2054  , 'completed': T
-00004d30: 7275 657d 2029 2028 7374 696c 6c20 7275  rue} ) (still ru
-00004d40: 6e6e 696e 673a 2031 290a 3e3e 2020 2066  nning: 1).>>   f
-00004d50: 696e 6973 6865 643a 204e 6f64 6528 7370  inished: Node(sp
-00004d60: 6c69 745f 6461 7461 3a20 7b27 7374 6174  lit_data: {'stat
-00004d70: 6527 3a20 2753 5543 4345 5353 272c 2027  e': 'SUCCESS', '
-00004d80: 7265 7375 6c74 273a 205b 4461 7461 4672  result': [DataFr
-00004d90: 616d 655b 6964 3a20 6269 6769 6e74 5d2c  ame[id: bigint],
-00004da0: 2044 6174 6146 7261 6d65 5b69 643a 2062   DataFrame[id: b
-00004db0: 6967 696e 745d 5d2c 2027 6578 6365 7074  igint]], 'except
-00004dc0: 696f 6e27 3a20 4e6f 6e65 2c20 2763 6f6d  ion': None, 'com
-00004dd0: 706c 6574 6564 273a 2054 7275 657d 2029  pleted': True} )
-00004de0: 2028 7374 696c 6c20 7275 6e6e 696e 673a   (still running:
-00004df0: 2030 290a 3e3e 2041 6c6c 2074 6173 6b73   0).>> All tasks
-00004e00: 2066 696e 6973 6865 642c 2073 6875 7474   finished, shutt
-00004e10: 696e 6720 646f 776e 0a3e 3e20 7069 7065  ing down.>> pipe
-00004e20: 6c69 6e65 2072 6573 756c 7473 3a0a 3e3e  line results:.>>
-00004e30: 205b 7261 775f 6461 7461 5f73 696e 676c   [raw_data_singl
-00004e40: 655f 736f 7572 6365 2c20 7261 775f 6461  e_source, raw_da
-00004e50: 7461 5f73 696e 676c 655f 736f 7572 6365  ta_single_source
-00004e60: 5f77 6974 685f 6375 7374 6f6d 5f6e 616d  _with_custom_nam
-00004e70: 652c 2072 6177 5f64 6174 615f 6d75 6c74  e, raw_data_mult
-00004e80: 695f 736f 7572 6365 2c20 636f 6d62 696e  i_source, combin
-00004e90: 655f 6461 7461 2c20 7370 6c69 745f 6461  e_data, split_da
-00004ea0: 7461 5d0a 3e3e 2065 7665 6e20 6e75 6d62  ta].>> even numb
-00004eb0: 6572 733a 0a3e 3e20 5b52 6f77 2869 643d  ers:.>> [Row(id=
-00004ec0: 3229 2c20 526f 7728 6964 3d34 292c 2052  2), Row(id=4), R
-00004ed0: 6f77 2869 643d 3629 2c20 526f 7728 6964  ow(id=6), Row(id
-00004ee0: 3d38 292c 2052 6f77 2869 643d 3130 3029  =8), Row(id=100)
-00004ef0: 2c20 526f 7728 6964 3d31 3032 292c 2052  , Row(id=102), R
-00004f00: 6f77 2869 643d 3130 3429 2c20 526f 7728  ow(id=104), Row(
-00004f10: 6964 3d31 3036 292c 2052 6f77 2869 643d  id=106), Row(id=
-00004f20: 3130 3829 2c20 526f 7728 6964 3d31 3030  108), Row(id=100
-00004f30: 3029 5d0a 3e3e 206f 6464 206e 756d 6265  0)].>> odd numbe
-00004f40: 7273 3a0a 3e3e 205b 526f 7728 6964 3d31  rs:.>> [Row(id=1
-00004f50: 292c 2052 6f77 2869 643d 3329 2c20 526f  ), Row(id=3), Ro
-00004f60: 7728 6964 3d35 292c 2052 6f77 2869 643d  w(id=5), Row(id=
-00004f70: 3729 2c20 526f 7728 6964 3d39 292c 2052  7), Row(id=9), R
-00004f80: 6f77 2869 643d 3130 3129 2c20 526f 7728  ow(id=101), Row(
-00004f90: 6964 3d31 3033 292c 2052 6f77 2869 643d  id=103), Row(id=
-00004fa0: 3130 3529 2c20 526f 7728 6964 3d31 3037  105), Row(id=107
-00004fb0: 292c 2052 6f77 2869 643d 3130 3929 5d0a  ), Row(id=109)].
-00004fc0: 6060 600a 0a70 6970 656c 696e 6520 7374  ```..pipeline st
-00004fd0: 6570 7320 6172 6520 7265 7275 6e61 626c  eps are rerunabl
-00004fe0: 6520 6173 2061 6e79 206f 7264 696e 6172  e as any ordinar
-00004ff0: 7920 6675 6e63 7469 6f6e 3a0a 6060 6070  y function:.```p
-00005000: 7974 686f 6e0a 2320 746f 2072 6572 756e  ython.# to rerun
-00005010: 2067 6976 656e 2073 7465 702c 206a 7573   given step, jus
-00005020: 7420 6578 6563 7574 6520 6974 2061 7320  t execute it as 
-00005030: 6966 2069 7420 7761 7320 6120 7075 7265  if it was a pure
-00005040: 2066 756e 6374 696f 6e0a 2320 7265 7475   function.# retu
-00005050: 726e 2069 7320 616c 6177 6179 7320 6120  rn is alaways a 
-00005060: 6c69 7374 206f 6620 6461 7461 6672 616d  list of datafram
-00005070: 7320 7468 6174 2067 6976 656e 2040 7070  s that given @pp
-00005080: 6e2e 7374 6570 2072 6574 7572 6e73 0a23  n.step returns.#
-00005090: 206e 6f74 653a 2074 6865 2073 7061 726b   note: the spark
-000050a0: 2076 6965 7720 2772 6177 5f64 6174 615f   view 'raw_data_
-000050b0: 7369 6e67 6c65 5f73 6f75 7263 6527 2077  single_source' w
-000050c0: 696c 6c20 6265 2075 7064 6174 6564 2077  ill be updated w
-000050d0: 6865 6e20 7468 6973 2066 756e 6374 696f  hen this functio
-000050e0: 6e20 6669 6e69 7368 6573 2028 6173 2070  n finishes (as p
-000050f0: 6572 2064 6566 696e 7469 6f6e 2069 6e20  er defintion in 
-00005100: 4070 706e 2e73 7465 7020 6162 6f76 6529  @ppn.step above)
-00005110: 0a72 6177 5f64 6174 615f 7369 6e67 6c65  .raw_data_single
-00005120: 5f73 6f75 7263 6528 290a 6060 600a       _source().```.
+000044e0: 2c20 7261 775f 6461 7461 5f73 696e 676c  , raw_data_singl
+000044f0: 655f 736f 7572 6365 5f77 6974 685f 6375  e_source_with_cu
+00004500: 7374 6f6d 5f6e 616d 652c 2072 6177 5f64  stom_name, raw_d
+00004510: 6174 615f 6d75 6c74 695f 736f 7572 6365  ata_multi_source
+00004520: 5d29 0a64 6566 2063 6f6d 6269 6e65 5f64  ]).def combine_d
+00004530: 6174 6128 7029 3a0a 2020 6466 203d 2074  ata(p):.  df = t
+00004540: 6162 6c65 2827 7261 775f 6461 7461 5f73  able('raw_data_s
+00004550: 696e 676c 655f 736f 7572 6365 2729 205c  ingle_source') \
+00004560: 0a20 2020 202e 756e 696f 6e28 7461 626c  .    .union(tabl
+00004570: 6528 2772 6177 5f6e 6963 655f 6e61 6d65  e('raw_nice_name
+00004580: 2729 2920 5c0a 2020 2020 2e75 6e69 6f6e  ')) \.    .union
+00004590: 2874 6162 6c65 2827 7261 775f 6461 7461  (table('raw_data
+000045a0: 3127 2929 205c 0a20 2020 202e 756e 696f  1')) \.    .unio
+000045b0: 6e28 7461 626c 6528 2772 6177 5f64 6174  n(table('raw_dat
+000045c0: 6132 2729 290a 0a20 2072 6574 7572 6e20  a2'))..  return 
+000045d0: 6466 0a0a 2320 7370 6c69 7473 2074 6865  df..# splits the
+000045e0: 2063 6f6d 6269 6e65 645f 6461 7461 2069   combined_data i
+000045f0: 6e74 6f20 276f 6464 2720 616e 6420 2765  nto 'odd' and 'e
+00004600: 7665 6e27 2076 6965 7773 0a40 7070 6e2e  ven' views.@ppn.
+00004610: 7374 6570 2864 6570 656e 6473 5f6f 6e3d  step(depends_on=
+00004620: 5b63 6f6d 6269 6e65 5f64 6174 615d 2c20  [combine_data], 
+00004630: 7265 7475 726e 733d 5b27 6f64 6427 2c20  returns=['odd', 
+00004640: 2765 7665 6e27 5d29 0a64 6566 2073 706c  'even']).def spl
+00004650: 6974 5f64 6174 6128 7029 3a0a 2020 6466  it_data(p):.  df
+00004660: 5f6f 6464 203d 2074 6162 6c65 2827 636f  _odd = table('co
+00004670: 6d62 696e 655f 6461 7461 2729 2e66 696c  mbine_data').fil
+00004680: 7465 7228 2769 6420 2520 3220 3d3d 2031  ter('id % 2 == 1
+00004690: 2729 0a20 2064 665f 6576 656e 203d 2074  ').  df_even = t
+000046a0: 6162 6c65 2827 636f 6d62 696e 655f 6461  able('combine_da
+000046b0: 7461 2729 2e66 696c 7465 7228 2769 6420  ta').filter('id 
+000046c0: 2520 3220 3d3d 2030 2729 0a0a 2020 7265  % 2 == 0')..  re
+000046d0: 7475 726e 205b 2064 665f 6f64 642c 2064  turn [ df_odd, d
+000046e0: 665f 6576 656e 205d 0a0a 2320 6966 2079  f_even ]..# if y
+000046f0: 6f75 2068 6176 6520 6970 7964 6167 7265  ou have ipydagre
+00004700: 6433 2069 6e73 7461 6c6c 6564 2c20 796f  d3 installed, yo
+00004710: 7520 6361 6e20 7365 6520 696e 2072 6561  u can see in rea
+00004720: 6c20 7469 6d65 2073 7461 7465 2063 6861  l time state cha
+00004730: 6e67 6573 206f 6620 6561 6368 206f 6620  nges of each of 
+00004740: 7468 6520 7374 6570 730a 6469 7370 6c61  the steps.displa
+00004750: 7928 7070 6e2e 7669 7375 616c 697a 6528  y(ppn.visualize(
+00004760: 2929 0a0a 2320 6578 6563 7574 6573 2070  ))..# executes p
+00004770: 6970 656c 696e 6520 7573 696e 6720 636f  ipeline using co
+00004780: 6e63 7572 7265 6e74 2074 6872 6561 6473  ncurrent threads
+00004790: 2c20 6f6e 6520 7065 7220 6561 6368 2073  , one per each s
+000047a0: 7465 702c 2066 6f6c 6c6f 7769 6e67 2074  tep, following t
+000047b0: 6865 2064 6570 656e 6465 6e63 7920 4441  he dependency DA
+000047c0: 470a 2320 7069 7065 6c69 6e65 2069 7320  G.# pipeline is 
+000047d0: 6120 6e6f 726d 616c 2070 7974 686f 6e20  a normal python 
+000047e0: 6361 6c6c 6162 6c65 206f 626a 6563 742c  callable object,
+000047f0: 2061 7320 6966 2069 7420 7761 7320 6120   as if it was a 
+00004800: 6675 6e63 7469 6f6e 2c20 6974 2072 6574  function, it ret
+00004810: 7572 6e73 2061 206c 6973 7420 6f66 2061  urns a list of a
+00004820: 6c6c 2073 7465 7073 0a70 6970 656c 696e  ll steps.pipelin
+00004830: 655f 7265 7375 6c74 7320 3d20 7070 6e28  e_results = ppn(
+00004840: 6d61 785f 636f 6e63 7572 7265 6e74 5f73  max_concurrent_s
+00004850: 7465 7073 3d31 3029 0a0a 7072 696e 7428  teps=10)..print(
+00004860: 2770 6970 656c 696e 6520 7265 7375 6c74  'pipeline result
+00004870: 733a 2729 0a70 7269 6e74 2870 6970 656c  s:').print(pipel
+00004880: 696e 655f 7265 7375 6c74 7329 0a0a 2373  ine_results)..#s
+00004890: 686f 7720 736f 6d65 2066 696e 616c 2076  how some final v
+000048a0: 616c 7565 730a 7072 696e 7428 2765 7665  alues.print('eve
+000048b0: 6e20 6e75 6d62 6572 733a 2729 0a70 7269  n numbers:').pri
+000048c0: 6e74 2874 6162 6c65 2827 6576 656e 2729  nt(table('even')
+000048d0: 2e6c 696d 6974 2831 3029 2e63 6f6c 6c65  .limit(10).colle
+000048e0: 6374 2829 290a 7072 696e 7428 276f 6464  ct()).print('odd
+000048f0: 206e 756d 6265 7273 3a27 290a 7072 696e   numbers:').prin
+00004900: 7428 7461 626c 6528 276f 6464 2729 2e6c  t(table('odd').l
+00004910: 696d 6974 2831 3029 2e63 6f6c 6c65 6374  imit(10).collect
+00004920: 2829 290a 0a3e 3e20 5761 6974 696e 6720  ())..>> Waiting 
+00004930: 666f 7220 616c 6c20 7461 736b 7320 746f  for all tasks to
+00004940: 2066 696e 6973 682e 2e2e 0a3e 3e20 2020   finish....>>   
+00004950: 7374 6172 7469 6e67 3a20 4e6f 6465 2872  starting: Node(r
+00004960: 6177 5f64 6174 615f 7369 6e67 6c65 5f73  aw_data_single_s
+00004970: 6f75 7263 653a 207b 2773 7461 7465 273a  ource: {'state':
+00004980: 2027 5255 4e4e 494e 4727 2c20 2772 6573   'RUNNING', 'res
+00004990: 756c 7427 3a20 4e6f 6e65 2c20 2765 7863  ult': None, 'exc
+000049a0: 6570 7469 6f6e 273a 204e 6f6e 652c 2027  eption': None, '
+000049b0: 636f 6d70 6c65 7465 6427 3a20 4661 6c73  completed': Fals
+000049c0: 657d 2029 0a3e 3e20 2020 7374 6172 7469  e} ).>>   starti
+000049d0: 6e67 3a20 4e6f 6465 2872 6177 5f64 6174  ng: Node(raw_dat
+000049e0: 615f 7369 6e67 6c65 5f73 6f75 7263 655f  a_single_source_
+000049f0: 7769 7468 5f63 7573 746f 6d5f 6e61 6d65  with_custom_name
+00004a00: 3a20 7b27 7374 6174 6527 3a20 2752 554e  : {'state': 'RUN
+00004a10: 4e49 4e47 272c 2027 7265 7375 6c74 273a  NING', 'result':
+00004a20: 204e 6f6e 652c 2027 6578 6365 7074 696f   None, 'exceptio
+00004a30: 6e27 3a20 4e6f 6e65 2c20 2763 6f6d 706c  n': None, 'compl
+00004a40: 6574 6564 273a 2046 616c 7365 7d20 290a  eted': False} ).
+00004a50: 3e3e 2020 2073 7461 7274 696e 673a 204e  >>   starting: N
+00004a60: 6f64 6528 7261 775f 6461 7461 5f6d 756c  ode(raw_data_mul
+00004a70: 7469 5f73 6f75 7263 653a 207b 2773 7461  ti_source: {'sta
+00004a80: 7465 273a 2027 5255 4e4e 494e 4727 2c20  te': 'RUNNING', 
+00004a90: 2772 6573 756c 7427 3a20 4e6f 6e65 2c20  'result': None, 
+00004aa0: 2765 7863 6570 7469 6f6e 273a 204e 6f6e  'exception': Non
+00004ab0: 652c 2027 636f 6d70 6c65 7465 6427 3a20  e, 'completed': 
+00004ac0: 4661 6c73 657d 2029 0a3e 3e20 2020 6669  False} ).>>   fi
+00004ad0: 6e69 7368 6564 3a20 4e6f 6465 2872 6177  nished: Node(raw
+00004ae0: 5f64 6174 615f 7369 6e67 6c65 5f73 6f75  _data_single_sou
+00004af0: 7263 653a 207b 2773 7461 7465 273a 2027  rce: {'state': '
+00004b00: 5355 4343 4553 5327 2c20 2772 6573 756c  SUCCESS', 'resul
+00004b10: 7427 3a20 5b44 6174 6146 7261 6d65 5b69  t': [DataFrame[i
+00004b20: 643a 2062 6967 696e 745d 5d2c 2027 6578  d: bigint]], 'ex
+00004b30: 6365 7074 696f 6e27 3a20 4e6f 6e65 2c20  ception': None, 
+00004b40: 2763 6f6d 706c 6574 6564 273a 2054 7275  'completed': Tru
+00004b50: 657d 2029 2028 7374 696c 6c20 7275 6e6e  e} ) (still runn
+00004b60: 696e 673a 2032 290a 3e3e 2020 2066 696e  ing: 2).>>   fin
+00004b70: 6973 6865 643a 204e 6f64 6528 7261 775f  ished: Node(raw_
+00004b80: 6461 7461 5f73 696e 676c 655f 736f 7572  data_single_sour
+00004b90: 6365 5f77 6974 685f 6375 7374 6f6d 5f6e  ce_with_custom_n
+00004ba0: 616d 653a 207b 2773 7461 7465 273a 2027  ame: {'state': '
+00004bb0: 5355 4343 4553 5327 2c20 2772 6573 756c  SUCCESS', 'resul
+00004bc0: 7427 3a20 5b44 6174 6146 7261 6d65 5b69  t': [DataFrame[i
+00004bd0: 643a 2062 6967 696e 745d 5d2c 2027 6578  d: bigint]], 'ex
+00004be0: 6365 7074 696f 6e27 3a20 4e6f 6e65 2c20  ception': None, 
+00004bf0: 2763 6f6d 706c 6574 6564 273a 2054 7275  'completed': Tru
+00004c00: 657d 2029 2028 7374 696c 6c20 7275 6e6e  e} ) (still runn
+00004c10: 696e 673a 2031 290a 3e3e 2020 2073 7461  ing: 1).>>   sta
+00004c20: 7274 696e 673a 204e 6f64 6528 636f 6d62  rting: Node(comb
+00004c30: 696e 655f 6461 7461 3a20 7b27 7374 6174  ine_data: {'stat
+00004c40: 6527 3a20 2752 554e 4e49 4e47 272c 2027  e': 'RUNNING', '
+00004c50: 7265 7375 6c74 273a 204e 6f6e 652c 2027  result': None, '
+00004c60: 6578 6365 7074 696f 6e27 3a20 4e6f 6e65  exception': None
+00004c70: 2c20 2763 6f6d 706c 6574 6564 273a 2046  , 'completed': F
+00004c80: 616c 7365 7d20 290a 3e3e 2020 2066 696e  alse} ).>>   fin
+00004c90: 6973 6865 643a 204e 6f64 6528 7261 775f  ished: Node(raw_
+00004ca0: 6461 7461 5f6d 756c 7469 5f73 6f75 7263  data_multi_sourc
+00004cb0: 653a 207b 2773 7461 7465 273a 2027 5355  e: {'state': 'SU
+00004cc0: 4343 4553 5327 2c20 2772 6573 756c 7427  CCESS', 'result'
+00004cd0: 3a20 5b44 6174 6146 7261 6d65 5b69 643a  : [DataFrame[id:
+00004ce0: 2062 6967 696e 745d 2c20 4461 7461 4672   bigint], DataFr
+00004cf0: 616d 655b 6964 3a20 6269 6769 6e74 5d5d  ame[id: bigint]]
+00004d00: 2c20 2765 7863 6570 7469 6f6e 273a 204e  , 'exception': N
+00004d10: 6f6e 652c 2027 636f 6d70 6c65 7465 6427  one, 'completed'
+00004d20: 3a20 5472 7565 7d20 2920 2873 7469 6c6c  : True} ) (still
+00004d30: 2072 756e 6e69 6e67 3a20 3129 0a3e 3e20   running: 1).>> 
+00004d40: 2020 7374 6172 7469 6e67 3a20 4e6f 6465    starting: Node
+00004d50: 2873 706c 6974 5f64 6174 613a 207b 2773  (split_data: {'s
+00004d60: 7461 7465 273a 2027 5255 4e4e 494e 4727  tate': 'RUNNING'
+00004d70: 2c20 2772 6573 756c 7427 3a20 4e6f 6e65  , 'result': None
+00004d80: 2c20 2765 7863 6570 7469 6f6e 273a 204e  , 'exception': N
+00004d90: 6f6e 652c 2027 636f 6d70 6c65 7465 6427  one, 'completed'
+00004da0: 3a20 4661 6c73 657d 2029 0a3e 3e20 2020  : False} ).>>   
+00004db0: 6669 6e69 7368 6564 3a20 4e6f 6465 2863  finished: Node(c
+00004dc0: 6f6d 6269 6e65 5f64 6174 613a 207b 2773  ombine_data: {'s
+00004dd0: 7461 7465 273a 2027 5355 4343 4553 5327  tate': 'SUCCESS'
+00004de0: 2c20 2772 6573 756c 7427 3a20 5b44 6174  , 'result': [Dat
+00004df0: 6146 7261 6d65 5b69 643a 2062 6967 696e  aFrame[id: bigin
+00004e00: 745d 5d2c 2027 6578 6365 7074 696f 6e27  t]], 'exception'
+00004e10: 3a20 4e6f 6e65 2c20 2763 6f6d 706c 6574  : None, 'complet
+00004e20: 6564 273a 2054 7275 657d 2029 2028 7374  ed': True} ) (st
+00004e30: 696c 6c20 7275 6e6e 696e 673a 2031 290a  ill running: 1).
+00004e40: 3e3e 2020 2066 696e 6973 6865 643a 204e  >>   finished: N
+00004e50: 6f64 6528 7370 6c69 745f 6461 7461 3a20  ode(split_data: 
+00004e60: 7b27 7374 6174 6527 3a20 2753 5543 4345  {'state': 'SUCCE
+00004e70: 5353 272c 2027 7265 7375 6c74 273a 205b  SS', 'result': [
+00004e80: 4461 7461 4672 616d 655b 6964 3a20 6269  DataFrame[id: bi
+00004e90: 6769 6e74 5d2c 2044 6174 6146 7261 6d65  gint], DataFrame
+00004ea0: 5b69 643a 2062 6967 696e 745d 5d2c 2027  [id: bigint]], '
+00004eb0: 6578 6365 7074 696f 6e27 3a20 4e6f 6e65  exception': None
+00004ec0: 2c20 2763 6f6d 706c 6574 6564 273a 2054  , 'completed': T
+00004ed0: 7275 657d 2029 2028 7374 696c 6c20 7275  rue} ) (still ru
+00004ee0: 6e6e 696e 673a 2030 290a 3e3e 2041 6c6c  nning: 0).>> All
+00004ef0: 2074 6173 6b73 2066 696e 6973 6865 642c   tasks finished,
+00004f00: 2073 6875 7474 696e 6720 646f 776e 0a3e   shutting down.>
+00004f10: 3e20 7069 7065 6c69 6e65 2072 6573 756c  > pipeline resul
+00004f20: 7473 3a0a 3e3e 205b 7261 775f 6461 7461  ts:.>> [raw_data
+00004f30: 5f73 696e 676c 655f 736f 7572 6365 2c20  _single_source, 
+00004f40: 7261 775f 6461 7461 5f73 696e 676c 655f  raw_data_single_
+00004f50: 736f 7572 6365 5f77 6974 685f 6375 7374  source_with_cust
+00004f60: 6f6d 5f6e 616d 652c 2072 6177 5f64 6174  om_name, raw_dat
+00004f70: 615f 6d75 6c74 695f 736f 7572 6365 2c20  a_multi_source, 
+00004f80: 636f 6d62 696e 655f 6461 7461 2c20 7370  combine_data, sp
+00004f90: 6c69 745f 6461 7461 5d0a 3e3e 2065 7665  lit_data].>> eve
+00004fa0: 6e20 6e75 6d62 6572 733a 0a3e 3e20 5b52  n numbers:.>> [R
+00004fb0: 6f77 2869 643d 3229 2c20 526f 7728 6964  ow(id=2), Row(id
+00004fc0: 3d34 292c 2052 6f77 2869 643d 3629 2c20  =4), Row(id=6), 
+00004fd0: 526f 7728 6964 3d38 292c 2052 6f77 2869  Row(id=8), Row(i
+00004fe0: 643d 3130 3029 2c20 526f 7728 6964 3d31  d=100), Row(id=1
+00004ff0: 3032 292c 2052 6f77 2869 643d 3130 3429  02), Row(id=104)
+00005000: 2c20 526f 7728 6964 3d31 3036 292c 2052  , Row(id=106), R
+00005010: 6f77 2869 643d 3130 3829 2c20 526f 7728  ow(id=108), Row(
+00005020: 6964 3d31 3030 3029 5d0a 3e3e 206f 6464  id=1000)].>> odd
+00005030: 206e 756d 6265 7273 3a0a 3e3e 205b 526f   numbers:.>> [Ro
+00005040: 7728 6964 3d31 292c 2052 6f77 2869 643d  w(id=1), Row(id=
+00005050: 3329 2c20 526f 7728 6964 3d35 292c 2052  3), Row(id=5), R
+00005060: 6f77 2869 643d 3729 2c20 526f 7728 6964  ow(id=7), Row(id
+00005070: 3d39 292c 2052 6f77 2869 643d 3130 3129  =9), Row(id=101)
+00005080: 2c20 526f 7728 6964 3d31 3033 292c 2052  , Row(id=103), R
+00005090: 6f77 2869 643d 3130 3529 2c20 526f 7728  ow(id=105), Row(
+000050a0: 6964 3d31 3037 292c 2052 6f77 2869 643d  id=107), Row(id=
+000050b0: 3130 3929 5d0a 6060 600a 0a70 6970 656c  109)].```..pipel
+000050c0: 696e 6520 7374 6570 7320 6172 6520 7265  ine steps are re
+000050d0: 7275 6e61 626c 6520 6173 2061 6e79 206f  runable as any o
+000050e0: 7264 696e 6172 7920 6675 6e63 7469 6f6e  rdinary function
+000050f0: 3a0a 6060 6070 7974 686f 6e0a 2320 746f  :.```python.# to
+00005100: 2072 6572 756e 2067 6976 656e 2073 7465   rerun given ste
+00005110: 702c 206a 7573 7420 6578 6563 7574 6520  p, just execute 
+00005120: 6974 2061 7320 6966 2069 7420 7761 7320  it as if it was 
+00005130: 6120 7075 7265 2066 756e 6374 696f 6e0a  a pure function.
+00005140: 2320 7265 7475 726e 2069 7320 616c 6177  # return is alaw
+00005150: 6179 7320 6120 6c69 7374 206f 6620 6461  ays a list of da
+00005160: 7461 6672 616d 7320 7468 6174 2067 6976  taframs that giv
+00005170: 656e 2040 7070 6e2e 7374 6570 2072 6574  en @ppn.step ret
+00005180: 7572 6e73 0a23 206e 6f74 653a 2074 6865  urns.# note: the
+00005190: 2073 7061 726b 2076 6965 7720 2772 6177   spark view 'raw
+000051a0: 5f64 6174 615f 7369 6e67 6c65 5f73 6f75  _data_single_sou
+000051b0: 7263 6527 2077 696c 6c20 6265 2075 7064  rce' will be upd
+000051c0: 6174 6564 2077 6865 6e20 7468 6973 2066  ated when this f
+000051d0: 756e 6374 696f 6e20 6669 6e69 7368 6573  unction finishes
+000051e0: 2028 6173 2070 6572 2064 6566 696e 7469   (as per definti
+000051f0: 6f6e 2069 6e20 4070 706e 2e73 7465 7020  on in @ppn.step 
+00005200: 6162 6f76 6529 0a72 6177 5f64 6174 615f  above).raw_data_
+00005210: 7369 6e67 6c65 5f73 6f75 7263 6528 290a  single_source().
+00005220: 6060 600a                                ```.
```

### Comparing `bdq-0.0.1/pyproject.toml` & `bdq-0.0.2/pyproject.toml`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 [project]
 name = "bdq"
-version = "0.0.1"
+version = "0.0.2"
 authors = [
   { name="Grzegorz Rusin", email="grzegorz.rusin@databricks.com" },
 ]
 description = "Big Data Quality, a set of tools/function that help you every day assert quality of datasets you have processed or ingested"
 readme = "README.md"
 requires-python = ">=3.8"
 classifiers = [
```

